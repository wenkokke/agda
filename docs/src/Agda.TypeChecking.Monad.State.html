<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">-- | Lenses for 'TCState' and more.</span></span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.TypeChecking.Monad.State</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">evaluate</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">rnf</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HMap</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Benchmarking.html"><span class="hs-identifier">Agda.Benchmarking</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Response.html"><span class="hs-identifier">Agda.Interaction.Response</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#InteractionOutputCallback"><span class="hs-identifier">InteractionOutputCallback</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Interaction.Response.html#Response"><span class="hs-identifier">Response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html"><span class="hs-identifier">Agda.Syntax.Scope.Base</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html"><span class="hs-identifier">Agda.Syntax.Concrete.Name</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html"><span class="hs-identifier">Agda.Syntax.Abstract</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefn"><span class="hs-identifier">PatternSynDefn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefns"><span class="hs-identifier">PatternSynDefns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.PatternSynonyms.html"><span class="hs-identifier">Agda.Syntax.Abstract.PatternSynonyms</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html"><span class="hs-identifier">Agda.Syntax.Abstract.Name</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html"><span class="hs-identifier">Agda.Syntax.TopLevelModuleName</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Base</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Debug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier">reportSDoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier">reportSLn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Debug.html#verboseS"><span class="hs-identifier">verboseS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html"><span class="hs-identifier">Agda.TypeChecking.Positivity.Occurrence</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html"><span class="hs-identifier">Agda.TypeChecking.CompiledClause</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.BiMap.html"><span class="hs-identifier">Agda.Utils.BiMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BiMap</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List1</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Monad.html#bracket_"><span class="hs-identifier">bracket_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Tuple.html"><span class="hs-identifier">Agda.Utils.Tuple</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><span class="hs-comment">-- | Resets the non-persistent part of the type checking state.</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#resetState"><span class="hs-identifier hs-type">resetState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span id="resetState"><span class="annot"><span class="annottext">resetState :: TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#resetState"><span class="hs-identifier hs-var hs-var">resetState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621681392158"><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392158"><span class="hs-identifier hs-var">pers</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; PersistentTCState) -&gt; TCMT IO PersistentTCState
forall (m :: * -&gt; *) a. ReadTCState m =&gt; (TCState -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#getsTC"><span class="hs-identifier hs-var">getsTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; PersistentTCState
</span><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><span class="annottext">TCState -&gt; TCM ()
forall (m :: * -&gt; *). MonadTCState m =&gt; TCState -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#putTC"><span class="hs-identifier hs-var">putTC</span></a></span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; TCM ()) -&gt; TCState -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#initState"><span class="hs-identifier hs-var">initState</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392158"><span class="hs-identifier hs-type">pers</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Resets all of the type checking state.</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">--   Keep only 'Benchmark' and backend information.</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#resetAllState"><span class="hs-identifier hs-type">resetAllState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span id="resetAllState"><span class="annot"><span class="annottext">resetAllState :: TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#resetAllState"><span class="hs-identifier hs-var hs-var">resetAllState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621681392164"><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621681392164"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Benchmark
</span><a href="Agda.TypeChecking.Monad.State.html#getBenchmark"><span class="hs-identifier hs-var">getBenchmark</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621681392166"><span class="annot"><span class="annottext">[Backend_boot (TCMT IO)]
</span><a href="#local-6989586621681392166"><span class="hs-identifier hs-var">backends</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState [Backend_boot (TCMT IO)]
-&gt; TCMT IO [Backend_boot (TCMT IO)]
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">([Backend_boot (TCMT IO)] -&gt; f [Backend_boot (TCMT IO)])
-&gt; TCState -&gt; f TCState
Lens' TCState [Backend_boot (TCMT IO)]
</span><a href="Agda.TypeChecking.Monad.Base.html#stBackends"><span class="hs-identifier hs-var">stBackends</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">TCState -&gt; TCM ()
forall (m :: * -&gt; *). MonadTCState m =&gt; TCState -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#putTC"><span class="hs-identifier hs-var">putTC</span></a></span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; TCM ()) -&gt; TCState -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; PersistentTCState) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updatePersistentState"><span class="hs-identifier hs-var">updatePersistentState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681392172"><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392172"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392172"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stBenchmark"><span class="hs-identifier hs-var">stBenchmark</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392164"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#initState"><span class="hs-identifier hs-var">initState</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">([Backend_boot (TCMT IO)] -&gt; f [Backend_boot (TCMT IO)])
-&gt; TCState -&gt; f TCState
Lens' TCState [Backend_boot (TCMT IO)]
</span><a href="Agda.TypeChecking.Monad.Base.html#stBackends"><span class="hs-identifier hs-var">stBackends</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState [Backend_boot (TCMT IO)]
-&gt; [Backend_boot (TCMT IO)] -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-operator hs-var">`setTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">[Backend_boot (TCMT IO)]
</span><a href="#local-6989586621681392166"><span class="hs-identifier hs-var">backends</span></a></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- resetAllState = putTC initState</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Restore 'TCState' after performing subcomputation.</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">--   In contrast to 'Agda.Utils.Monad.localState', the 'Benchmark'</span><span>
</span><span id="line-73"></span><span class="hs-comment">--   info from the subcomputation is saved.</span><span>
</span><span id="line-74"></span><span id="local-6989586621681391701"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#localTCState"><span class="hs-identifier hs-type">localTCState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391701"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391701"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-75"></span><span id="localTCState"><span class="annot"><span class="annottext">localTCState :: forall a. TCM a -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#localTCState"><span class="hs-identifier hs-var hs-var">localTCState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCMT IO TCState -&gt; (TCState -&gt; TCM ()) -&gt; TCMT IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
m a -&gt; (a -&gt; m ()) -&gt; m b -&gt; m b
</span><a href="Agda.Utils.Monad.html#bracket_"><span class="hs-identifier hs-var">bracket_</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO TCState
forall (m :: * -&gt; *). MonadTCState m =&gt; m TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#getTC"><span class="hs-identifier hs-var">getTC</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681392184"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392184"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-76"></span><span>   </span><span id="local-6989586621681392185"><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621681392185"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Benchmark
</span><a href="Agda.TypeChecking.Monad.State.html#getBenchmark"><span class="hs-identifier hs-var">getBenchmark</span></a></span><span>
</span><span id="line-77"></span><span>   </span><span class="annot"><span class="annottext">TCState -&gt; TCM ()
forall (m :: * -&gt; *). MonadTCState m =&gt; TCState -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#putTC"><span class="hs-identifier hs-var">putTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392184"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-78"></span><span>   </span><span class="annot"><span class="annottext">(Benchmark -&gt; Benchmark) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyBenchmark"><span class="hs-identifier hs-var">modifyBenchmark</span></a></span><span> </span><span class="annot"><span class="annottext">((Benchmark -&gt; Benchmark) -&gt; TCM ())
-&gt; (Benchmark -&gt; Benchmark) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Benchmark -&gt; Benchmark -&gt; Benchmark
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621681392185"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Same as 'localTCState' but also returns the state in which we were just</span><span>
</span><span id="line-81"></span><span class="hs-comment">--   before reverting it.</span><span>
</span><span id="line-82"></span><span id="local-6989586621681391708"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#localTCStateSaving"><span class="hs-identifier hs-type">localTCStateSaving</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391708"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681391708"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-83"></span><span id="localTCStateSaving"><span class="annot"><span class="annottext">localTCStateSaving :: forall a. TCM a -&gt; TCM (a, TCState)
</span><a href="Agda.TypeChecking.Monad.State.html#localTCStateSaving"><span class="hs-identifier hs-var hs-var">localTCStateSaving</span></a></span></span><span> </span><span id="local-6989586621681392199"><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392199"><span class="hs-identifier hs-var">compute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621681392200"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392200"><span class="hs-identifier hs-var">oldState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO TCState
forall (m :: * -&gt; *). MonadTCState m =&gt; m TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#getTC"><span class="hs-identifier hs-var">getTC</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621681392201"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392201"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392199"><span class="hs-identifier hs-var">compute</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621681392202"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392202"><span class="hs-identifier hs-var">newState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO TCState
forall (m :: * -&gt; *). MonadTCState m =&gt; m TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#getTC"><span class="hs-identifier hs-var">getTC</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621681392203"><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621681392203"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Benchmark
</span><a href="Agda.TypeChecking.Monad.State.html#getBenchmark"><span class="hs-identifier hs-var">getBenchmark</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">TCState -&gt; TCM ()
forall (m :: * -&gt; *). MonadTCState m =&gt; TCState -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#putTC"><span class="hs-identifier hs-var">putTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392200"><span class="hs-identifier hs-var">oldState</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">(Benchmark -&gt; Benchmark) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyBenchmark"><span class="hs-identifier hs-var">modifyBenchmark</span></a></span><span> </span><span class="annot"><span class="annottext">((Benchmark -&gt; Benchmark) -&gt; TCM ())
-&gt; (Benchmark -&gt; Benchmark) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Benchmark -&gt; Benchmark -&gt; Benchmark
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Benchmark
</span><a href="#local-6989586621681392203"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">(a, TCState) -&gt; TCM (a, TCState)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392201"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392202"><span class="hs-identifier hs-var">newState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><span class="hs-comment">-- | Same as 'localTCState' but keep all warnings.</span></span><span>
</span><span id="line-94"></span><span id="local-6989586621681392204"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#localTCStateSavingWarnings"><span class="hs-identifier hs-type">localTCStateSavingWarnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392204"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392204"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-95"></span><span id="localTCStateSavingWarnings"><span class="annot"><span class="annottext">localTCStateSavingWarnings :: forall a. TCM a -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#localTCStateSavingWarnings"><span class="hs-identifier hs-var hs-var">localTCStateSavingWarnings</span></a></span></span><span> </span><span id="local-6989586621681392210"><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392210"><span class="hs-identifier hs-var">compute</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681392211"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392211"><span class="hs-identifier hs-var">result</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681392212"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392212"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM a -&gt; TCM (a, TCState)
forall a. TCM a -&gt; TCM (a, TCState)
</span><a href="Agda.TypeChecking.Monad.State.html#localTCStateSaving"><span class="hs-identifier hs-var">localTCStateSaving</span></a></span><span> </span><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392210"><span class="hs-identifier hs-var">compute</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">(TCState -&gt; TCState) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(TCState -&gt; TCState) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTC"><span class="hs-identifier hs-var">modifyTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCState -&gt; TCState) -&gt; TCM ()) -&gt; (TCState -&gt; TCState) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lens' TCState [TCWarning] -&gt; LensMap TCState [TCWarning]
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; f [TCWarning]) -&gt; TCState -&gt; f TCState
Lens' TCState [TCWarning]
</span><a href="Agda.TypeChecking.Monad.Base.html#stTCWarnings"><span class="hs-identifier hs-var">stTCWarnings</span></a></span><span> </span><span class="annot"><span class="annottext">LensMap TCState [TCWarning] -&gt; LensMap TCState [TCWarning]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCWarning] -&gt; [TCWarning] -&gt; [TCWarning]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; [TCWarning] -&gt; [TCWarning])
-&gt; [TCWarning] -&gt; [TCWarning] -&gt; [TCWarning]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392212"><span class="hs-identifier hs-var">newState</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; Lens' TCState [TCWarning] -&gt; [TCWarning]
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">([TCWarning] -&gt; f [TCWarning]) -&gt; TCState -&gt; f TCState
Lens' TCState [TCWarning]
</span><a href="Agda.TypeChecking.Monad.Base.html#stTCWarnings"><span class="hs-identifier hs-var">stTCWarnings</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; TCM a
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392211"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">data</span><span> </span><span id="SpeculateResult"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#SpeculateResult"><span class="hs-identifier hs-var">SpeculateResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SpeculateAbort"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#SpeculateAbort"><span class="hs-identifier hs-var">SpeculateAbort</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SpeculateCommit"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#SpeculateCommit"><span class="hs-identifier hs-var">SpeculateCommit</span></a></span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><span class="hs-comment">-- | Allow rolling back the state changes of a TCM computation.</span></span><span>
</span><span id="line-103"></span><span id="local-6989586621681391721"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#speculateTCState"><span class="hs-identifier hs-type">speculateTCState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681391721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#SpeculateResult"><span class="hs-identifier hs-type">SpeculateResult</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391721"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-104"></span><span id="speculateTCState"><span class="annot"><span class="annottext">speculateTCState :: forall a. TCM (a, SpeculateResult) -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#speculateTCState"><span class="hs-identifier hs-var hs-var">speculateTCState</span></a></span></span><span> </span><span id="local-6989586621681392228"><span class="annot"><span class="annottext">TCM (a, SpeculateResult)
</span><a href="#local-6989586621681392228"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621681392229"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392229"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681392230"><span class="annot"><span class="annottext">SpeculateResult
</span><a href="#local-6989586621681392230"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621681392231"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392231"><span class="hs-identifier hs-var">newState</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM (a, SpeculateResult) -&gt; TCM ((a, SpeculateResult), TCState)
forall a. TCM a -&gt; TCM (a, TCState)
</span><a href="Agda.TypeChecking.Monad.State.html#localTCStateSaving"><span class="hs-identifier hs-var">localTCStateSaving</span></a></span><span> </span><span class="annot"><span class="annottext">TCM (a, SpeculateResult)
</span><a href="#local-6989586621681392228"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SpeculateResult
</span><a href="#local-6989586621681392230"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">SpeculateResult
</span><a href="Agda.TypeChecking.Monad.State.html#SpeculateAbort"><span class="hs-identifier hs-var">SpeculateAbort</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; TCM a
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392229"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">SpeculateResult
</span><a href="Agda.TypeChecking.Monad.State.html#SpeculateCommit"><span class="hs-identifier hs-var">SpeculateCommit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392229"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; TCM () -&gt; TCM a
forall a b. a -&gt; TCMT IO b -&gt; TCMT IO a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; TCM ()
forall (m :: * -&gt; *). MonadTCState m =&gt; TCState -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#putTC"><span class="hs-identifier hs-var">putTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392231"><span class="hs-identifier hs-var">newState</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#speculateTCState_"><span class="hs-identifier hs-type">speculateTCState_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#SpeculateResult"><span class="hs-identifier hs-type">SpeculateResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span id="speculateTCState_"><span class="annot"><span class="annottext">speculateTCState_ :: TCM SpeculateResult -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#speculateTCState_"><span class="hs-identifier hs-var hs-var">speculateTCState_</span></a></span></span><span> </span><span id="local-6989586621681392234"><span class="annot"><span class="annottext">TCM SpeculateResult
</span><a href="#local-6989586621681392234"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM ((), SpeculateResult) -&gt; TCM ()
forall a. TCM (a, SpeculateResult) -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#speculateTCState"><span class="hs-identifier hs-var">speculateTCState</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM ((), SpeculateResult) -&gt; TCM ())
-&gt; TCM ((), SpeculateResult) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SpeculateResult -&gt; ((), SpeculateResult))
-&gt; TCM SpeculateResult -&gt; TCM ((), SpeculateResult)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM SpeculateResult
</span><a href="#local-6989586621681392234"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | A fresh TCM instance.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- The computation is run in a fresh state, with the exception that</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- the persistent state is preserved. If the computation changes the</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- state, then these changes are ignored, except for changes to the</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- persistent state. (Changes to the persistent state are also ignored</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- if errors other than type errors or IO exceptions are encountered.)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621681391732"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#freshTCM"><span class="hs-identifier hs-type">freshTCM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCErr"><span class="hs-identifier hs-type">TCErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391732"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-122"></span><span id="freshTCM"><span class="annot"><span class="annottext">freshTCM :: forall a. TCM a -&gt; TCM (Either TCErr a)
</span><a href="Agda.TypeChecking.Monad.State.html#freshTCM"><span class="hs-identifier hs-var hs-var">freshTCM</span></a></span></span><span> </span><span id="local-6989586621681392254"><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392254"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621681392255"><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392255"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState PersistentTCState -&gt; TCMT IO PersistentTCState
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681392259"><span class="annot"><span class="annottext">s :: TCState
</span><a href="#local-6989586621681392259"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState PersistentTCState
-&gt; LensSet TCState PersistentTCState
forall o i. Lens' o i -&gt; LensSet o i
</span><a href="Agda.Utils.Lens.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392255"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#initState"><span class="hs-identifier hs-var">initState</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621681392263"><span class="annot"><span class="annottext">Either TCErr (a, TCState)
</span><a href="#local-6989586621681392263"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either TCErr (a, TCState))
-&gt; TCMT IO (Either TCErr (a, TCState))
forall a. IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either TCErr (a, TCState))
 -&gt; TCMT IO (Either TCErr (a, TCState)))
-&gt; IO (Either TCErr (a, TCState))
-&gt; TCMT IO (Either TCErr (a, TCState))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a, TCState) -&gt; Either TCErr (a, TCState)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">((a, TCState) -&gt; Either TCErr (a, TCState))
-&gt; IO (a, TCState) -&gt; IO (Either TCErr (a, TCState))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCEnv -&gt; TCState -&gt; TCM a -&gt; IO (a, TCState)
forall (m :: * -&gt; *) a.
MonadIO m =&gt;
TCEnv -&gt; TCState -&gt; TCMT m a -&gt; m (a, TCState)
</span><a href="Agda.TypeChecking.Monad.Base.html#runTCM"><span class="hs-identifier hs-var">runTCM</span></a></span><span> </span><span class="annot"><span class="annottext">TCEnv
</span><a href="Agda.TypeChecking.Monad.Base.html#initEnv"><span class="hs-identifier hs-var">initEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392259"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392254"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Either TCErr (a, TCState))
-&gt; (TCErr -&gt; IO (Either TCErr (a, TCState)))
-&gt; IO (Either TCErr (a, TCState))
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either TCErr (a, TCState) -&gt; IO (Either TCErr (a, TCState))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either TCErr (a, TCState) -&gt; IO (Either TCErr (a, TCState)))
-&gt; (TCErr -&gt; Either TCErr (a, TCState))
-&gt; TCErr
-&gt; IO (Either TCErr (a, TCState))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; Either TCErr (a, TCState)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either TCErr (a, TCState)
</span><a href="#local-6989586621681392263"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681392268"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392268"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681392269"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392269"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="annottext">Lens' TCState PersistentTCState -&gt; PersistentTCState -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-identifier hs-var">setTCLens</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; TCM ()) -&gt; PersistentTCState -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392269"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; Lens' TCState PersistentTCState -&gt; PersistentTCState
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">Either TCErr a -&gt; TCM (Either TCErr a)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either TCErr a -&gt; TCM (Either TCErr a))
-&gt; Either TCErr a -&gt; TCM (Either TCErr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either TCErr a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392268"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621681392274"><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681392274"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681392274"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TypeError"><span class="hs-identifier hs-type">TypeError</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tcErrState :: TCErr -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.Base.html#tcErrState"><span class="hs-identifier hs-var">tcErrState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681392277"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392277"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">Lens' TCState PersistentTCState -&gt; PersistentTCState -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-identifier hs-var">setTCLens</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; TCM ()) -&gt; PersistentTCState -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392277"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; Lens' TCState PersistentTCState -&gt; PersistentTCState
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#IOException"><span class="hs-identifier hs-type">IOException</span></a></span><span> </span><span id="local-6989586621681392283"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392283"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IOException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><span class="annottext">Lens' TCState PersistentTCState -&gt; PersistentTCState -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-identifier hs-var">setTCLens</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; TCM ()) -&gt; PersistentTCState -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392283"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; Lens' TCState PersistentTCState -&gt; PersistentTCState
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">TCErr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">Either TCErr a -&gt; TCM (Either TCErr a)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Either TCErr a -&gt; TCM (Either TCErr a))
-&gt; Either TCErr a -&gt; TCM (Either TCErr a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCErr -&gt; Either TCErr a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">TCErr
</span><a href="#local-6989586621681392274"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-140"></span><span class="annot"><span class="hs-comment">-- * Lens for persistent states and its fields</span></span><span>
</span><span id="line-141"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-type">lensPersistentState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PersistentTCState"><span class="hs-identifier hs-type">PersistentTCState</span></a></span><span>
</span><span id="line-144"></span><span id="lensPersistentState"><span class="annot"><span class="annottext">lensPersistentState :: Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var hs-var">lensPersistentState</span></a></span></span><span> </span><span id="local-6989586621681392290"><span class="annot"><span class="annottext">PersistentTCState -&gt; f PersistentTCState
</span><a href="#local-6989586621681392290"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392291"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392291"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><span class="annottext">PersistentTCState -&gt; f PersistentTCState
</span><a href="#local-6989586621681392290"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCState -&gt; PersistentTCState
</span><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392291"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f PersistentTCState -&gt; (PersistentTCState -&gt; TCState) -&gt; f TCState
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681392293"><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392293"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392291"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392293"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updatePersistentState"><span class="hs-identifier hs-type">updatePersistentState</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PersistentTCState"><span class="hs-identifier hs-type">PersistentTCState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PersistentTCState"><span class="hs-identifier hs-type">PersistentTCState</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span id="updatePersistentState"><span class="annot"><span class="annottext">updatePersistentState :: (PersistentTCState -&gt; PersistentTCState) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updatePersistentState"><span class="hs-identifier hs-var hs-var">updatePersistentState</span></a></span></span><span> </span><span id="local-6989586621681392294"><span class="annot"><span class="annottext">PersistentTCState -&gt; PersistentTCState
</span><a href="#local-6989586621681392294"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392295"><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392295"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCState
</span><a href="#local-6989586621681392295"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392294"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392295"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyPersistentState"><span class="hs-identifier hs-type">modifyPersistentState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PersistentTCState"><span class="hs-identifier hs-type">PersistentTCState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PersistentTCState"><span class="hs-identifier hs-type">PersistentTCState</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span id="modifyPersistentState"><span class="annot"><span class="annottext">modifyPersistentState :: (PersistentTCState -&gt; PersistentTCState) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyPersistentState"><span class="hs-identifier hs-var hs-var">modifyPersistentState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; TCState) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(TCState -&gt; TCState) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTC"><span class="hs-identifier hs-var">modifyTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCState -&gt; TCState) -&gt; TCM ())
-&gt; ((PersistentTCState -&gt; PersistentTCState) -&gt; TCState -&gt; TCState)
-&gt; (PersistentTCState -&gt; PersistentTCState)
-&gt; TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; PersistentTCState) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updatePersistentState"><span class="hs-identifier hs-var">updatePersistentState</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- | Lens for 'stAccumStatistics'.</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#lensAccumStatisticsP"><span class="hs-identifier hs-type">lensAccumStatisticsP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PersistentTCState"><span class="hs-identifier hs-type">PersistentTCState</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span>
</span><span id="line-157"></span><span id="lensAccumStatisticsP"><span class="annot"><span class="annottext">lensAccumStatisticsP :: Lens' PersistentTCState Statistics
</span><a href="Agda.TypeChecking.Monad.State.html#lensAccumStatisticsP"><span class="hs-identifier hs-var hs-var">lensAccumStatisticsP</span></a></span></span><span> </span><span id="local-6989586621681392301"><span class="annot"><span class="annottext">Statistics -&gt; f Statistics
</span><a href="#local-6989586621681392301"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392302"><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392302"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Statistics -&gt; f Statistics
</span><a href="#local-6989586621681392301"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PersistentTCState -&gt; Statistics
</span><a href="Agda.TypeChecking.Monad.Base.html#stAccumStatistics"><span class="hs-identifier hs-var">stAccumStatistics</span></a></span><span> </span><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392302"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f Statistics
-&gt; (Statistics -&gt; PersistentTCState) -&gt; f PersistentTCState
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681392303"><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621681392303"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392302"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stAccumStatistics"><span class="hs-identifier hs-var">stAccumStatistics</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392303"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#lensAccumStatistics"><span class="hs-identifier hs-type">lensAccumStatistics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span>
</span><span id="line-161"></span><span id="lensAccumStatistics"><span class="annot"><span class="annottext">lensAccumStatistics :: Lens' TCState Statistics
</span><a href="Agda.TypeChecking.Monad.State.html#lensAccumStatistics"><span class="hs-identifier hs-var hs-var">lensAccumStatistics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; f PersistentTCState) -&gt; TCState -&gt; f TCState
Lens' TCState PersistentTCState
</span><a href="Agda.TypeChecking.Monad.State.html#lensPersistentState"><span class="hs-identifier hs-var">lensPersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">((PersistentTCState -&gt; f PersistentTCState)
 -&gt; TCState -&gt; f TCState)
-&gt; ((Statistics -&gt; f Statistics)
    -&gt; PersistentTCState -&gt; f PersistentTCState)
-&gt; (Statistics -&gt; f Statistics)
-&gt; TCState
-&gt; f TCState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Statistics -&gt; f Statistics)
-&gt; PersistentTCState -&gt; f PersistentTCState
Lens' PersistentTCState Statistics
</span><a href="Agda.TypeChecking.Monad.State.html#lensAccumStatisticsP"><span class="hs-identifier hs-var">lensAccumStatisticsP</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-164"></span><span class="annot"><span class="hs-comment">-- * Scope</span></span><span>
</span><span id="line-165"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-pragma hs-type">getScope</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-168"></span><span class="annot"><span class="hs-comment">-- | Get the current scope.</span></span><span>
</span><span id="line-169"></span><span id="local-6989586621681391767"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-type">getScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391767"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391767"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span></span><span>
</span><span id="line-170"></span><span id="getScope"><span class="annot"><span class="annottext">getScope :: forall (m :: * -&gt; *). ReadTCState m =&gt; m ScopeInfo
</span><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-var hs-var">getScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState ScopeInfo -&gt; m ScopeInfo
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; f ScopeInfo) -&gt; TCState -&gt; f TCState
Lens' TCState ScopeInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#stScope"><span class="hs-identifier hs-var">stScope</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setScope"><span class="hs-pragma hs-type">setScope</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">-- | Set the current scope.</span></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setScope"><span class="hs-identifier hs-type">setScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span id="setScope"><span class="annot"><span class="annottext">setScope :: ScopeInfo -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setScope"><span class="hs-identifier hs-var hs-var">setScope</span></a></span></span><span> </span><span id="local-6989586621681392316"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392316"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; ScopeInfo) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(ScopeInfo -&gt; ScopeInfo) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyScope"><span class="hs-identifier hs-var">modifyScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo -&gt; ScopeInfo
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392316"><span class="hs-identifier hs-var">scope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyScope_"><span class="hs-pragma hs-type">modifyScope_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-178"></span><span class="annot"><span class="hs-comment">-- | Modify the current scope without updating the inverse maps.</span></span><span>
</span><span id="line-179"></span><span id="local-6989586621681392319"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyScope_"><span class="hs-identifier hs-type">modifyScope_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-type">MonadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392319"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681392319"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-180"></span><span id="modifyScope_"><span class="annot"><span class="annottext">modifyScope_ :: forall (m :: * -&gt; *).
MonadTCState m =&gt;
(ScopeInfo -&gt; ScopeInfo) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyScope_"><span class="hs-identifier hs-var hs-var">modifyScope_</span></a></span></span><span> </span><span id="local-6989586621681392322"><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo
</span><a href="#local-6989586621681392322"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; f ScopeInfo) -&gt; TCState -&gt; f TCState
Lens' TCState ScopeInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#stScope"><span class="hs-identifier hs-var">stScope</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState ScopeInfo -&gt; (ScopeInfo -&gt; ScopeInfo) -&gt; m ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTCLens"><span class="hs-operator hs-var">`modifyTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo
</span><a href="#local-6989586621681392322"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyScope"><span class="hs-pragma hs-type">modifyScope</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- | Modify the current scope.</span></span><span>
</span><span id="line-184"></span><span id="local-6989586621681391770"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyScope"><span class="hs-identifier hs-type">modifyScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-type">MonadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391770"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391770"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-185"></span><span id="modifyScope"><span class="annot"><span class="annottext">modifyScope :: forall (m :: * -&gt; *).
MonadTCState m =&gt;
(ScopeInfo -&gt; ScopeInfo) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyScope"><span class="hs-identifier hs-var hs-var">modifyScope</span></a></span></span><span> </span><span id="local-6989586621681392328"><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo
</span><a href="#local-6989586621681392328"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; ScopeInfo) -&gt; m ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(ScopeInfo -&gt; ScopeInfo) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyScope_"><span class="hs-identifier hs-var">modifyScope_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo
</span><a href="Agda.Syntax.Scope.Base.html#recomputeInverseScopeMaps"><span class="hs-identifier hs-var">recomputeInverseScopeMaps</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; ScopeInfo)
-&gt; (ScopeInfo -&gt; ScopeInfo) -&gt; ScopeInfo -&gt; ScopeInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo
</span><a href="#local-6989586621681392328"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#useScope"><span class="hs-pragma hs-type">useScope</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-188"></span><span class="annot"><span class="hs-comment">-- | Get a part of the current scope.</span></span><span>
</span><span id="line-189"></span><span id="local-6989586621681391776"><span id="local-6989586621681391777"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#useScope"><span class="hs-identifier hs-type">useScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391776"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391777"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391776"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391777"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-190"></span><span id="useScope"><span class="annot"><span class="annottext">useScope :: forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' ScopeInfo a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.State.html#useScope"><span class="hs-identifier hs-var hs-var">useScope</span></a></span></span><span> </span><span id="local-6989586621681392333"><span class="annot"><span class="annottext">Lens' ScopeInfo a
</span><a href="#local-6989586621681392333"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState a -&gt; m a
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(Lens' TCState a -&gt; m a) -&gt; Lens' TCState a -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; f ScopeInfo) -&gt; TCState -&gt; f TCState
Lens' TCState ScopeInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#stScope"><span class="hs-identifier hs-var">stScope</span></a></span><span> </span><span class="annot"><span class="annottext">((ScopeInfo -&gt; f ScopeInfo) -&gt; TCState -&gt; f TCState)
-&gt; ((a -&gt; f a) -&gt; ScopeInfo -&gt; f ScopeInfo)
-&gt; (a -&gt; f a)
-&gt; TCState
-&gt; f TCState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f a) -&gt; ScopeInfo -&gt; f ScopeInfo
Lens' ScopeInfo a
</span><a href="#local-6989586621681392333"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#locallyScope"><span class="hs-pragma hs-type">locallyScope</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-193"></span><span class="annot"><span class="hs-comment">-- | Run a computation in a modified scope.</span></span><span>
</span><span id="line-194"></span><span id="local-6989586621681391781"><span id="local-6989586621681391782"><span id="local-6989586621681391783"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#locallyScope"><span class="hs-identifier hs-type">locallyScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681391782"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391783"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391781"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391783"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-195"></span><span id="locallyScope"><span class="annot"><span class="annottext">locallyScope :: forall (m :: * -&gt; *) a b.
ReadTCState m =&gt;
Lens' ScopeInfo a -&gt; (a -&gt; a) -&gt; m b -&gt; m b
</span><a href="Agda.TypeChecking.Monad.State.html#locallyScope"><span class="hs-identifier hs-var hs-var">locallyScope</span></a></span></span><span> </span><span id="local-6989586621681392340"><span class="annot"><span class="annottext">Lens' ScopeInfo a
</span><a href="#local-6989586621681392340"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b
forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b.
ReadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Base.html#locallyTCState"><span class="hs-identifier hs-var">locallyTCState</span></a></span><span> </span><span class="annot"><span class="annottext">(Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b)
-&gt; Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; f ScopeInfo) -&gt; TCState -&gt; f TCState
Lens' TCState ScopeInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#stScope"><span class="hs-identifier hs-var">stScope</span></a></span><span> </span><span class="annot"><span class="annottext">((ScopeInfo -&gt; f ScopeInfo) -&gt; TCState -&gt; f TCState)
-&gt; ((a -&gt; f a) -&gt; ScopeInfo -&gt; f ScopeInfo)
-&gt; (a -&gt; f a)
-&gt; TCState
-&gt; f TCState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; f a) -&gt; ScopeInfo -&gt; f ScopeInfo
Lens' ScopeInfo a
</span><a href="#local-6989586621681392340"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withScope"><span class="hs-pragma hs-type">withScope</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-198"></span><span class="annot"><span class="hs-comment">-- | Run a computation in a local scope.</span></span><span>
</span><span id="line-199"></span><span id="local-6989586621681391791"><span id="local-6989586621681391792"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withScope"><span class="hs-identifier hs-type">withScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391791"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391791"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391791"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681391792"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-200"></span><span id="withScope"><span class="annot"><span class="annottext">withScope :: forall (m :: * -&gt; *) a.
ReadTCState m =&gt;
ScopeInfo -&gt; m a -&gt; m (a, ScopeInfo)
</span><a href="Agda.TypeChecking.Monad.State.html#withScope"><span class="hs-identifier hs-var hs-var">withScope</span></a></span></span><span> </span><span id="local-6989586621681392357"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392357"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681392358"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681392358"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState ScopeInfo
-&gt; (ScopeInfo -&gt; ScopeInfo) -&gt; m (a, ScopeInfo) -&gt; m (a, ScopeInfo)
forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b
forall (m :: * -&gt; *) a b.
ReadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Base.html#locallyTCState"><span class="hs-identifier hs-var">locallyTCState</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; f ScopeInfo) -&gt; TCState -&gt; f TCState
Lens' TCState ScopeInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#stScope"><span class="hs-identifier hs-var">stScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo
</span><a href="Agda.Syntax.Scope.Base.html#recomputeInverseScopeMaps"><span class="hs-identifier hs-var">recomputeInverseScopeMaps</span></a></span><span> </span><span class="annot"><span class="annottext">(ScopeInfo -&gt; ScopeInfo)
-&gt; (ScopeInfo -&gt; ScopeInfo) -&gt; ScopeInfo -&gt; ScopeInfo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; ScopeInfo -&gt; ScopeInfo
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392357"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m (a, ScopeInfo) -&gt; m (a, ScopeInfo))
-&gt; m (a, ScopeInfo) -&gt; m (a, ScopeInfo)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; ScopeInfo -&gt; (a, ScopeInfo))
-&gt; m a -&gt; m (ScopeInfo -&gt; (a, ScopeInfo))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681392358"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m (ScopeInfo -&gt; (a, ScopeInfo)) -&gt; m ScopeInfo -&gt; m (a, ScopeInfo)
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m ScopeInfo
forall (m :: * -&gt; *). ReadTCState m =&gt; m ScopeInfo
</span><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-var">getScope</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withScope_"><span class="hs-pragma hs-type">withScope_</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-203"></span><span class="annot"><span class="hs-comment">-- | Same as 'withScope', but discard the scope from the computation.</span></span><span>
</span><span id="line-204"></span><span id="local-6989586621681391799"><span id="local-6989586621681391800"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withScope_"><span class="hs-identifier hs-type">withScope_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391799"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Scope.Base.html#ScopeInfo"><span class="hs-identifier hs-type">ScopeInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391799"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391800"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391799"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391800"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-205"></span><span id="withScope_"><span class="annot"><span class="annottext">withScope_ :: forall (m :: * -&gt; *) a. ReadTCState m =&gt; ScopeInfo -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.State.html#withScope_"><span class="hs-identifier hs-var hs-var">withScope_</span></a></span></span><span> </span><span id="local-6989586621681392368"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392368"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681392369"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681392369"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, ScopeInfo) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((a, ScopeInfo) -&gt; a) -&gt; m (a, ScopeInfo) -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; m a -&gt; m (a, ScopeInfo)
forall (m :: * -&gt; *) a.
ReadTCState m =&gt;
ScopeInfo -&gt; m a -&gt; m (a, ScopeInfo)
</span><a href="Agda.TypeChecking.Monad.State.html#withScope"><span class="hs-identifier hs-var">withScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392368"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681392369"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><span class="hs-comment">-- | Discard any changes to the scope by a computation.</span></span><span>
</span><span id="line-208"></span><span id="local-6989586621681392371"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#localScope"><span class="hs-identifier hs-type">localScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392371"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392371"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-209"></span><span id="localScope"><span class="annot"><span class="annottext">localScope :: forall a. TCM a -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#localScope"><span class="hs-identifier hs-var hs-var">localScope</span></a></span></span><span> </span><span id="local-6989586621681392378"><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392378"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621681392379"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392379"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO ScopeInfo
forall (m :: * -&gt; *). ReadTCState m =&gt; m ScopeInfo
</span><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-var">getScope</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621681392380"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392380"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392378"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">ScopeInfo -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setScope"><span class="hs-identifier hs-var">setScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392379"><span class="hs-identifier hs-var">scope</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; TCM a
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392380"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><span class="hs-comment">-- | Scope error.</span></span><span>
</span><span id="line-216"></span><span id="local-6989586621681391807"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#notInScopeError"><span class="hs-identifier hs-type">notInScopeError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391807"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-217"></span><span id="notInScopeError"><span class="annot"><span class="annottext">notInScopeError :: forall a. QName -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#notInScopeError"><span class="hs-identifier hs-var hs-var">notInScopeError</span></a></span></span><span> </span><span id="local-6989586621681392386"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392386"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Int -&gt; [Char] -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#printScope"><span class="hs-identifier hs-var">printScope</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unbound&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">TypeError -&gt; TCM a
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM a) -&gt; TypeError -&gt; TCM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#NotInScope"><span class="hs-identifier hs-var">NotInScope</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392386"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#notInScopeWarning"><span class="hs-identifier hs-type">notInScopeWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">C.QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span id="notInScopeWarning"><span class="annot"><span class="annottext">notInScopeWarning :: QName -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#notInScopeWarning"><span class="hs-identifier hs-var hs-var">notInScopeWarning</span></a></span></span><span> </span><span id="local-6989586621681392391"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392391"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Int -&gt; [Char] -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#printScope"><span class="hs-identifier hs-var">printScope</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unbound&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">Warning -&gt; TCM ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; TCM ()) -&gt; Warning -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#NotInScopeW"><span class="hs-identifier hs-var">NotInScopeW</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392391"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><span class="hs-comment">-- | Debug print the scope.</span></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#printScope"><span class="hs-identifier hs-type">printScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span id="printScope"><span class="annot"><span class="annottext">printScope :: [Char] -&gt; Int -&gt; [Char] -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#printScope"><span class="hs-identifier hs-var hs-var">printScope</span></a></span></span><span> </span><span id="local-6989586621681392394"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392394"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621681392395"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681392395"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621681392396"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392396"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *). MonadDebug m =&gt; [Char] -&gt; Int -&gt; m () -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#verboseS"><span class="hs-identifier hs-var">verboseS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;scope.&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392394"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681392395"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621681392397"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392397"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO ScopeInfo
forall (m :: * -&gt; *). ReadTCState m =&gt; m ScopeInfo
</span><a href="Agda.TypeChecking.Monad.State.html#getScope"><span class="hs-identifier hs-var">getScope</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Int -&gt; TCM Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;scope.&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392394"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681392395"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM ()) -&gt; TCM Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; TCM Doc
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; TCM Doc) -&gt; Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
forall a. [Char] -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392396"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScopeInfo -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681392397"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-233"></span><span class="annot"><span class="hs-comment">-- * Signature</span></span><span>
</span><span id="line-234"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="annot"><span class="hs-comment">-- ** Lens for 'stSignature' and 'stImports'</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-pragma hs-type">modifySignature</span></a></span><span>  </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-239"></span><span id="local-6989586621681391822"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-type">modifySignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-type">MonadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391822"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-240"></span><span id="modifySignature"><span class="annot"><span class="annottext">modifySignature :: forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-var hs-var">modifySignature</span></a></span></span><span> </span><span id="local-6989586621681392406"><span class="annot"><span class="annottext">Signature -&gt; Signature
</span><a href="#local-6989586621681392406"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Signature -&gt; f Signature) -&gt; TCState -&gt; f TCState
Lens' TCState Signature
</span><a href="Agda.TypeChecking.Monad.Base.html#stSignature"><span class="hs-identifier hs-var">stSignature</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState Signature -&gt; (Signature -&gt; Signature) -&gt; m ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTCLens"><span class="hs-operator hs-var">`modifyTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; Signature
</span><a href="#local-6989586621681392406"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyImportedSignature"><span class="hs-pragma hs-type">modifyImportedSignature</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-243"></span><span id="local-6989586621681392410"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyImportedSignature"><span class="hs-identifier hs-type">modifyImportedSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-type">MonadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681392410"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-244"></span><span id="modifyImportedSignature"><span class="annot"><span class="annottext">modifyImportedSignature :: forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyImportedSignature"><span class="hs-identifier hs-var hs-var">modifyImportedSignature</span></a></span></span><span> </span><span id="local-6989586621681392413"><span class="annot"><span class="annottext">Signature -&gt; Signature
</span><a href="#local-6989586621681392413"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Signature -&gt; f Signature) -&gt; TCState -&gt; f TCState
Lens' TCState Signature
</span><a href="Agda.TypeChecking.Monad.Base.html#stImports"><span class="hs-identifier hs-var">stImports</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState Signature -&gt; (Signature -&gt; Signature) -&gt; m ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTCLens"><span class="hs-operator hs-var">`modifyTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; Signature
</span><a href="#local-6989586621681392413"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getSignature"><span class="hs-pragma hs-type">getSignature</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-247"></span><span id="local-6989586621681391828"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getSignature"><span class="hs-identifier hs-type">getSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391828"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391828"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span></span><span>
</span><span id="line-248"></span><span id="getSignature"><span class="annot"><span class="annottext">getSignature :: forall (m :: * -&gt; *). ReadTCState m =&gt; m Signature
</span><a href="Agda.TypeChecking.Monad.State.html#getSignature"><span class="hs-identifier hs-var hs-var">getSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState Signature -&gt; m Signature
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(Signature -&gt; f Signature) -&gt; TCState -&gt; f TCState
Lens' TCState Signature
</span><a href="Agda.TypeChecking.Monad.Base.html#stSignature"><span class="hs-identifier hs-var">stSignature</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyGlobalDefinition"><span class="hs-pragma hs-type">modifyGlobalDefinition</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-pragma hs-type">QName</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-pragma hs-type">Definition</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-pragma hs-type">Definition</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Update a possibly imported definition. Warning: changes made to imported</span><span>
</span><span id="line-252"></span><span class="hs-comment">--   definitions (during type checking) will not persist outside the current</span><span>
</span><span id="line-253"></span><span class="hs-comment">--   module. This function is currently used to update the compiled</span><span>
</span><span id="line-254"></span><span class="hs-comment">--   representation of a function during compilation.</span><span>
</span><span id="line-255"></span><span id="local-6989586621681391831"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyGlobalDefinition"><span class="hs-identifier hs-type">modifyGlobalDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-type">MonadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391831"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391831"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-256"></span><span id="modifyGlobalDefinition"><span class="annot"><span class="annottext">modifyGlobalDefinition :: forall (m :: * -&gt; *).
MonadTCState m =&gt;
QName -&gt; (Definition -&gt; Definition) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyGlobalDefinition"><span class="hs-identifier hs-var hs-var">modifyGlobalDefinition</span></a></span></span><span> </span><span id="local-6989586621681392428"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392428"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681392429"><span class="annot"><span class="annottext">Definition -&gt; Definition
</span><a href="#local-6989586621681392429"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="annottext">(Signature -&gt; Signature) -&gt; m ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-var">modifySignature</span></a></span><span>         </span><span class="annot"><span class="annottext">((Signature -&gt; Signature) -&gt; m ())
-&gt; (Signature -&gt; Signature) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392428"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Definition
</span><a href="#local-6989586621681392429"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">(Signature -&gt; Signature) -&gt; m ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyImportedSignature"><span class="hs-identifier hs-var">modifyImportedSignature</span></a></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; Signature) -&gt; m ())
-&gt; (Signature -&gt; Signature) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392428"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Definition
</span><a href="#local-6989586621681392429"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setSignature"><span class="hs-pragma hs-type">setSignature</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-261"></span><span id="local-6989586621681391834"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setSignature"><span class="hs-identifier hs-type">setSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-type">MonadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391834"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-262"></span><span id="setSignature"><span class="annot"><span class="annottext">setSignature :: forall (m :: * -&gt; *). MonadTCState m =&gt; Signature -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#setSignature"><span class="hs-identifier hs-var hs-var">setSignature</span></a></span></span><span> </span><span id="local-6989586621681392434"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392434"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Signature -&gt; Signature) -&gt; m ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-var">modifySignature</span></a></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; Signature) -&gt; m ())
-&gt; (Signature -&gt; Signature) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signature -&gt; Signature -&gt; Signature
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392434"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withSignature"><span class="hs-pragma hs-type">withSignature</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span id="local-6989586621681392436"><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-pragma hs-type">Signature</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392436"><span class="hs-pragma hs-type">a</span></a></span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392436"><span class="hs-pragma hs-type">a</span></a></span></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-265"></span><span class="annot"><span class="hs-comment">-- | Run some computation in a different signature, restore original signature.</span></span><span>
</span><span id="line-266"></span><span id="local-6989586621681391836"><span id="local-6989586621681391837"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withSignature"><span class="hs-identifier hs-type">withSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391836"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-type">MonadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391836"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391836"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391837"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391836"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391837"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-267"></span><span id="withSignature"><span class="annot"><span class="annottext">withSignature :: forall (m :: * -&gt; *) a.
(ReadTCState m, MonadTCState m) =&gt;
Signature -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.State.html#withSignature"><span class="hs-identifier hs-var hs-var">withSignature</span></a></span></span><span> </span><span id="local-6989586621681392448"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392448"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span id="local-6989586621681392449"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681392449"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621681392450"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392450"><span class="hs-identifier hs-var">sig0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Signature
forall (m :: * -&gt; *). ReadTCState m =&gt; m Signature
</span><a href="Agda.TypeChecking.Monad.State.html#getSignature"><span class="hs-identifier hs-var">getSignature</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="annottext">Signature -&gt; m ()
forall (m :: * -&gt; *). MonadTCState m =&gt; Signature -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#setSignature"><span class="hs-identifier hs-var">setSignature</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392448"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621681392451"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392451"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621681392449"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">Signature -&gt; m ()
forall (m :: * -&gt; *). MonadTCState m =&gt; Signature -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#setSignature"><span class="hs-identifier hs-var">setSignature</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392450"><span class="hs-identifier hs-var">sig0</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392451"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="annot"><span class="hs-comment">-- ** Modifiers for rewrite rules</span></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#addRewriteRulesFor"><span class="hs-identifier hs-type">addRewriteRulesFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#RewriteRules"><span class="hs-identifier hs-type">RewriteRules</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-276"></span><span id="addRewriteRulesFor"><span class="annot"><span class="annottext">addRewriteRulesFor :: QName -&gt; RewriteRules -&gt; [QName] -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#addRewriteRulesFor"><span class="hs-identifier hs-var hs-var">addRewriteRulesFor</span></a></span></span><span> </span><span id="local-6989586621681392453"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392453"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392454"><span class="annot"><span class="annottext">RewriteRules
</span><a href="#local-6989586621681392454"><span class="hs-identifier hs-var">rews</span></a></span></span><span> </span><span id="local-6989586621681392455"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681392455"><span class="hs-identifier hs-var">matchables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><span class="annottext">Lens' Signature (HashMap QName RewriteRules)
-&gt; LensMap Signature (HashMap QName RewriteRules)
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap QName RewriteRules -&gt; f (HashMap QName RewriteRules))
-&gt; Signature -&gt; f Signature
Lens' Signature (HashMap QName RewriteRules)
</span><a href="Agda.TypeChecking.Monad.Base.html#sigRewriteRules"><span class="hs-identifier hs-var">sigRewriteRules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RewriteRules -&gt; RewriteRules -&gt; RewriteRules)
-&gt; QName
-&gt; RewriteRules
-&gt; HashMap QName RewriteRules
-&gt; HashMap QName RewriteRules
forall k v.
(Eq k, Hashable k) =&gt;
(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HMap.insertWith</span></span><span> </span><span class="annot"><span class="annottext">RewriteRules -&gt; RewriteRules -&gt; RewriteRules
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392453"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RewriteRules
</span><a href="#local-6989586621681392454"><span class="hs-identifier hs-var">rews</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">(Signature -&gt; Signature)
-&gt; (Signature -&gt; Signature) -&gt; Signature -&gt; Signature
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392453"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Defn -&gt; Defn) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateTheDef"><span class="hs-identifier hs-var">updateTheDef</span></a></span><span> </span><span class="annot"><span class="annottext">Defn -&gt; Defn
</span><a href="#local-6989586621681392461"><span class="hs-identifier hs-var">setNotInjective</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Definition)
-&gt; (Definition -&gt; Definition) -&gt; Definition -&gt; Definition
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Definition
</span><a href="#local-6989586621681392462"><span class="hs-identifier hs-var">setCopatternLHS</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">(Signature -&gt; Signature)
-&gt; (Signature -&gt; Signature) -&gt; Signature -&gt; Signature
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#setMatchableSymbols"><span class="hs-identifier hs-var">setMatchableSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392453"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681392455"><span class="hs-identifier hs-var">matchables</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>      </span><span id="local-6989586621681392461"><span class="annot"><span class="annottext">setNotInjective :: Defn -&gt; Defn
</span><a href="#local-6989586621681392461"><span class="hs-identifier hs-var hs-var">setNotInjective</span></a></span></span><span> </span><span id="local-6989586621681392464"><span class="annot"><span class="annottext">def :: Defn
</span><a href="#local-6989586621681392464"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681392464"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#funInv"><span class="hs-identifier hs-var">funInv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#NotInjective"><span class="hs-identifier hs-type">NotInjective</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="#local-6989586621681392461"><span class="hs-identifier hs-var">setNotInjective</span></a></span><span> </span><span id="local-6989586621681392468"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681392468"><span class="hs-identifier hs-var">def</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681392468"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>      </span><span id="local-6989586621681392462"><span class="annot"><span class="annottext">setCopatternLHS :: Definition -&gt; Definition
</span><a href="#local-6989586621681392462"><span class="hs-identifier hs-var hs-var">setCopatternLHS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefCopatternLHS"><span class="hs-identifier hs-var">updateDefCopatternLHS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(RewriteRule -&gt; Bool) -&gt; RewriteRules -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">RewriteRule -&gt; Bool
</span><a href="#local-6989586621681392472"><span class="hs-identifier hs-var">hasProjectionPattern</span></a></span><span> </span><span class="annot"><span class="annottext">RewriteRules
</span><a href="#local-6989586621681392454"><span class="hs-identifier hs-var">rews</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>      </span><span id="local-6989586621681392472"><span class="annot"><span class="annottext">hasProjectionPattern :: RewriteRule -&gt; Bool
</span><a href="#local-6989586621681392472"><span class="hs-identifier hs-var hs-var">hasProjectionPattern</span></a></span></span><span> </span><span id="local-6989586621681392476"><span class="annot"><span class="annottext">RewriteRule
</span><a href="#local-6989586621681392476"><span class="hs-identifier hs-var">rew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Elim' NLPat -&gt; Bool) -&gt; [Elim' NLPat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (ProjOrigin, QName) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ProjOrigin, QName) -&gt; Bool)
-&gt; (Elim' NLPat -&gt; Maybe (ProjOrigin, QName))
-&gt; Elim' NLPat
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Elim' NLPat -&gt; Maybe (ProjOrigin, QName)
forall e. IsProjElim e =&gt; e -&gt; Maybe (ProjOrigin, QName)
</span><a href="Agda.Syntax.Internal.Elim.html#isProjElim"><span class="hs-identifier hs-var">isProjElim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Elim' NLPat] -&gt; Bool) -&gt; [Elim' NLPat] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RewriteRule -&gt; [Elim' NLPat]
</span><a href="Agda.TypeChecking.Monad.Base.html#rewPats"><span class="hs-identifier hs-var">rewPats</span></a></span><span> </span><span class="annot"><span class="annottext">RewriteRule
</span><a href="#local-6989586621681392476"><span class="hs-identifier hs-var">rew</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setMatchableSymbols"><span class="hs-identifier hs-type">setMatchableSymbols</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-290"></span><span id="setMatchableSymbols"><span class="annot"><span class="annottext">setMatchableSymbols :: QName -&gt; [QName] -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#setMatchableSymbols"><span class="hs-identifier hs-var hs-var">setMatchableSymbols</span></a></span></span><span> </span><span id="local-6989586621681392480"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392480"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392481"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681392481"><span class="hs-identifier hs-var">matchables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="annottext">(QName -&gt; (Signature -&gt; Signature) -&gt; Signature -&gt; Signature)
-&gt; (Signature -&gt; Signature) -&gt; [QName] -&gt; Signature -&gt; Signature
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Signature -&gt; Signature)
-&gt; (Signature -&gt; Signature) -&gt; Signature -&gt; Signature
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; Signature)
 -&gt; (Signature -&gt; Signature) -&gt; Signature -&gt; Signature)
-&gt; (QName -&gt; Signature -&gt; Signature)
-&gt; QName
-&gt; (Signature -&gt; Signature)
-&gt; Signature
-&gt; Signature
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681392483"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392483"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392483"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Definition
</span><a href="#local-6989586621681392484"><span class="hs-identifier hs-var">setMatchable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Signature -&gt; Signature
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681392481"><span class="hs-identifier hs-var">matchables</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>      </span><span id="local-6989586621681392484"><span class="annot"><span class="annottext">setMatchable :: Definition -&gt; Definition
</span><a href="#local-6989586621681392484"><span class="hs-identifier hs-var hs-var">setMatchable</span></a></span></span><span> </span><span id="local-6989586621681392486"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392486"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392486"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defMatchable"><span class="hs-identifier hs-var">defMatchable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.insert</span></span><span> </span><span class="annot"><a href="#local-6989586621681392480"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defMatchable"><span class="hs-identifier hs-var">defMatchable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392486"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><span class="hs-comment">-- ** Modifiers for parts of the signature</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#lookupDefinition"><span class="hs-identifier hs-type">lookupDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span>
</span><span id="line-298"></span><span id="lookupDefinition"><span class="annot"><span class="annottext">lookupDefinition :: QName -&gt; Signature -&gt; Maybe Definition
</span><a href="Agda.TypeChecking.Monad.State.html#lookupDefinition"><span class="hs-identifier hs-var hs-var">lookupDefinition</span></a></span></span><span> </span><span id="local-6989586621681392490"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392490"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681392491"><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392491"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; HashMap QName Definition -&gt; Maybe Definition
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap QName Definition -&gt; Maybe Definition)
-&gt; HashMap QName Definition -&gt; Maybe Definition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621681392491"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
-&gt; Lens' Signature (HashMap QName Definition)
-&gt; HashMap QName Definition
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap QName Definition -&gt; f (HashMap QName Definition))
-&gt; Signature -&gt; f Signature
Lens' Signature (HashMap QName Definition)
</span><a href="Agda.TypeChecking.Monad.Base.html#sigDefinitions"><span class="hs-identifier hs-var">sigDefinitions</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefinitions"><span class="hs-identifier hs-type">updateDefinitions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definitions"><span class="hs-identifier hs-type">Definitions</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-301"></span><span id="updateDefinitions"><span class="annot"><span class="annottext">updateDefinitions :: (HashMap QName Definition -&gt; HashMap QName Definition)
-&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinitions"><span class="hs-identifier hs-var hs-var">updateDefinitions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' Signature (HashMap QName Definition)
-&gt; (HashMap QName Definition -&gt; HashMap QName Definition)
-&gt; Signature
-&gt; Signature
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap QName Definition -&gt; f (HashMap QName Definition))
-&gt; Signature -&gt; f Signature
Lens' Signature (HashMap QName Definition)
</span><a href="Agda.TypeChecking.Monad.Base.html#sigDefinitions"><span class="hs-identifier hs-var">sigDefinitions</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-type">updateDefinition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-304"></span><span id="updateDefinition"><span class="annot"><span class="annottext">updateDefinition :: QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var hs-var">updateDefinition</span></a></span></span><span> </span><span id="local-6989586621681392500"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392500"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681392501"><span class="annot"><span class="annottext">Definition -&gt; Definition
</span><a href="#local-6989586621681392501"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HashMap QName Definition -&gt; HashMap QName Definition)
-&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinitions"><span class="hs-identifier hs-var">updateDefinitions</span></a></span><span> </span><span class="annot"><span class="annottext">((HashMap QName Definition -&gt; HashMap QName Definition)
 -&gt; Signature -&gt; Signature)
-&gt; (HashMap QName Definition -&gt; HashMap QName Definition)
-&gt; Signature
-&gt; Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Definition)
-&gt; QName -&gt; HashMap QName Definition -&gt; HashMap QName Definition
forall k v.
(Eq k, Hashable k) =&gt;
(v -&gt; v) -&gt; k -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HMap.adjust</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Definition
</span><a href="#local-6989586621681392501"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392500"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateTheDef"><span class="hs-identifier hs-type">updateTheDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span id="updateTheDef"><span class="annot"><span class="annottext">updateTheDef :: (Defn -&gt; Defn) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateTheDef"><span class="hs-identifier hs-var hs-var">updateTheDef</span></a></span></span><span> </span><span id="local-6989586621681392503"><span class="annot"><span class="annottext">Defn -&gt; Defn
</span><a href="#local-6989586621681392503"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392504"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392504"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392504"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392503"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392504"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefType"><span class="hs-identifier hs-type">updateDefType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span id="updateDefType"><span class="annot"><span class="annottext">updateDefType :: (Type -&gt; Type) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefType"><span class="hs-identifier hs-var hs-var">updateDefType</span></a></span></span><span> </span><span id="local-6989586621681392507"><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="#local-6989586621681392507"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392508"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392508"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392508"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392507"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392508"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefArgOccurrences"><span class="hs-identifier hs-type">updateDefArgOccurrences</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html#Occurrence"><span class="hs-identifier hs-type">Occurrence</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html#Occurrence"><span class="hs-identifier hs-type">Occurrence</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span id="updateDefArgOccurrences"><span class="annot"><span class="annottext">updateDefArgOccurrences :: ([Occurrence] -&gt; [Occurrence]) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefArgOccurrences"><span class="hs-identifier hs-var hs-var">updateDefArgOccurrences</span></a></span></span><span> </span><span id="local-6989586621681392511"><span class="annot"><span class="annottext">[Occurrence] -&gt; [Occurrence]
</span><a href="#local-6989586621681392511"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392512"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392512"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392512"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defArgOccurrences"><span class="hs-identifier hs-var">defArgOccurrences</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392511"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defArgOccurrences"><span class="hs-identifier hs-var">defArgOccurrences</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392512"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefPolarity"><span class="hs-identifier hs-type">updateDefPolarity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Polarity"><span class="hs-identifier hs-type">Polarity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Polarity"><span class="hs-identifier hs-type">Polarity</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span id="updateDefPolarity"><span class="annot"><span class="annottext">updateDefPolarity :: ([Polarity] -&gt; [Polarity]) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefPolarity"><span class="hs-identifier hs-var hs-var">updateDefPolarity</span></a></span></span><span> </span><span id="local-6989586621681392515"><span class="annot"><span class="annottext">[Polarity] -&gt; [Polarity]
</span><a href="#local-6989586621681392515"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392516"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392516"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392516"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defPolarity"><span class="hs-identifier hs-var">defPolarity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392515"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defPolarity"><span class="hs-identifier hs-var">defPolarity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392516"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefCompiledRep"><span class="hs-identifier hs-type">updateDefCompiledRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CompiledRepresentation"><span class="hs-identifier hs-type">CompiledRepresentation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CompiledRepresentation"><span class="hs-identifier hs-type">CompiledRepresentation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span id="updateDefCompiledRep"><span class="annot"><span class="annottext">updateDefCompiledRep :: (CompiledRepresentation -&gt; CompiledRepresentation)
-&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefCompiledRep"><span class="hs-identifier hs-var hs-var">updateDefCompiledRep</span></a></span></span><span> </span><span id="local-6989586621681392519"><span class="annot"><span class="annottext">CompiledRepresentation -&gt; CompiledRepresentation
</span><a href="#local-6989586621681392519"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392520"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392520"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392520"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defCompiledRep"><span class="hs-identifier hs-var">defCompiledRep</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392519"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defCompiledRep"><span class="hs-identifier hs-var">defCompiledRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392520"><span class="hs-identifier hs-type">def</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#addCompilerPragma"><span class="hs-identifier hs-type">addCompilerPragma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#BackendName"><span class="hs-identifier hs-type">BackendName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CompilerPragma"><span class="hs-identifier hs-type">CompilerPragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span>
</span><span id="line-322"></span><span id="addCompilerPragma"><span class="annot"><span class="annottext">addCompilerPragma :: [Char] -&gt; CompilerPragma -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#addCompilerPragma"><span class="hs-identifier hs-var hs-var">addCompilerPragma</span></a></span></span><span> </span><span id="local-6989586621681392524"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392524"><span class="hs-identifier hs-var">backend</span></a></span></span><span> </span><span id="local-6989586621681392525"><span class="annot"><span class="annottext">CompilerPragma
</span><a href="#local-6989586621681392525"><span class="hs-identifier hs-var">pragma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CompiledRepresentation -&gt; CompiledRepresentation)
-&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefCompiledRep"><span class="hs-identifier hs-var">updateDefCompiledRep</span></a></span><span> </span><span class="annot"><span class="annottext">((CompiledRepresentation -&gt; CompiledRepresentation)
 -&gt; Definition -&gt; Definition)
-&gt; (CompiledRepresentation -&gt; CompiledRepresentation)
-&gt; Definition
-&gt; Definition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([CompilerPragma] -&gt; [CompilerPragma] -&gt; [CompilerPragma])
-&gt; [Char]
-&gt; [CompilerPragma]
-&gt; CompiledRepresentation
-&gt; CompiledRepresentation
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="annot"><span class="annottext">[CompilerPragma] -&gt; [CompilerPragma] -&gt; [CompilerPragma]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392524"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CompilerPragma
</span><a href="#local-6989586621681392525"><span class="hs-identifier hs-var">pragma</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateFunClauses"><span class="hs-identifier hs-type">updateFunClauses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span id="updateFunClauses"><span class="annot"><span class="annottext">updateFunClauses :: ([Clause] -&gt; [Clause]) -&gt; Defn -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.State.html#updateFunClauses"><span class="hs-identifier hs-var hs-var">updateFunClauses</span></a></span></span><span> </span><span id="local-6989586621681392528"><span class="annot"><span class="annottext">[Clause] -&gt; [Clause]
</span><a href="#local-6989586621681392528"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392529"><span class="annot"><span class="annottext">def :: Defn
</span><a href="#local-6989586621681392529"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funClauses :: Defn -&gt; [Clause]
</span><a href="Agda.TypeChecking.Monad.Base.html#funClauses"><span class="hs-identifier hs-var">funClauses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681392531"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621681392531"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681392529"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#funClauses"><span class="hs-identifier hs-var">funClauses</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392528"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392531"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-326"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateFunClauses"><span class="hs-identifier hs-var">updateFunClauses</span></a></span><span> </span><span id="local-6989586621681392532"><span class="annot"><span class="annottext">[Clause] -&gt; [Clause]
</span><a href="#local-6989586621681392532"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateCovering"><span class="hs-identifier hs-type">updateCovering</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span id="updateCovering"><span class="annot"><span class="annottext">updateCovering :: ([Clause] -&gt; [Clause]) -&gt; Defn -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.State.html#updateCovering"><span class="hs-identifier hs-var hs-var">updateCovering</span></a></span></span><span> </span><span id="local-6989586621681392535"><span class="annot"><span class="annottext">[Clause] -&gt; [Clause]
</span><a href="#local-6989586621681392535"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392536"><span class="annot"><span class="annottext">def :: Defn
</span><a href="#local-6989586621681392536"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funCovering :: Defn -&gt; [Clause]
</span><a href="Agda.TypeChecking.Monad.Base.html#funCovering"><span class="hs-identifier hs-var">funCovering</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681392538"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621681392538"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681392536"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#funCovering"><span class="hs-identifier hs-var">funCovering</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392535"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392538"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-330"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateCovering"><span class="hs-identifier hs-var">updateCovering</span></a></span><span> </span><span id="local-6989586621681392539"><span class="annot"><span class="annottext">[Clause] -&gt; [Clause]
</span><a href="#local-6989586621681392539"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateCompiledClauses"><span class="hs-identifier hs-type">updateCompiledClauses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html#CompiledClauses"><span class="hs-identifier hs-type">CompiledClauses</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html#CompiledClauses"><span class="hs-identifier hs-type">CompiledClauses</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span id="updateCompiledClauses"><span class="annot"><span class="annottext">updateCompiledClauses :: (Maybe CompiledClauses -&gt; Maybe CompiledClauses) -&gt; Defn -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.State.html#updateCompiledClauses"><span class="hs-identifier hs-var hs-var">updateCompiledClauses</span></a></span></span><span> </span><span id="local-6989586621681392541"><span class="annot"><span class="annottext">Maybe CompiledClauses -&gt; Maybe CompiledClauses
</span><a href="#local-6989586621681392541"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392542"><span class="annot"><span class="annottext">def :: Defn
</span><a href="#local-6989586621681392542"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funCompiled :: Defn -&gt; Maybe CompiledClauses
</span><a href="Agda.TypeChecking.Monad.Base.html#funCompiled"><span class="hs-identifier hs-var">funCompiled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681392544"><span class="annot"><span class="annottext">Maybe CompiledClauses
</span><a href="#local-6989586621681392544"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681392542"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#funCompiled"><span class="hs-identifier hs-var">funCompiled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392541"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392544"><span class="hs-identifier hs-type">cc</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateCompiledClauses"><span class="hs-identifier hs-var">updateCompiledClauses</span></a></span><span> </span><span id="local-6989586621681392545"><span class="annot"><span class="annottext">Maybe CompiledClauses -&gt; Maybe CompiledClauses
</span><a href="#local-6989586621681392545"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Defn
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefCopatternLHS"><span class="hs-identifier hs-type">updateDefCopatternLHS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span>
</span><span id="line-337"></span><span id="updateDefCopatternLHS"><span class="annot"><span class="annottext">updateDefCopatternLHS :: (Bool -&gt; Bool) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefCopatternLHS"><span class="hs-identifier hs-var hs-var">updateDefCopatternLHS</span></a></span></span><span> </span><span id="local-6989586621681392546"><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="#local-6989586621681392546"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392547"><span class="annot"><span class="annottext">def :: Definition
</span><a href="#local-6989586621681392547"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">defCopatternLHS :: Definition -&gt; Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#defCopatternLHS"><span class="hs-identifier hs-var">defCopatternLHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681392550"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681392550"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392547"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defCopatternLHS"><span class="hs-identifier hs-var">defCopatternLHS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392546"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392550"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateDefBlocked"><span class="hs-identifier hs-type">updateDefBlocked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#Blocked_"><span class="hs-identifier hs-type">Blocked_</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Blocked_"><span class="hs-identifier hs-type">Blocked_</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span>
</span><span id="line-340"></span><span id="updateDefBlocked"><span class="annot"><span class="annottext">updateDefBlocked :: (Blocked_ -&gt; Blocked_) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefBlocked"><span class="hs-identifier hs-var hs-var">updateDefBlocked</span></a></span></span><span> </span><span id="local-6989586621681392552"><span class="annot"><span class="annottext">Blocked_ -&gt; Blocked_
</span><a href="#local-6989586621681392552"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681392553"><span class="annot"><span class="annottext">def :: Definition
</span><a href="#local-6989586621681392553"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">defBlocked :: Definition -&gt; Blocked_
</span><a href="Agda.TypeChecking.Monad.Base.html#defBlocked"><span class="hs-identifier hs-var">defBlocked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681392555"><span class="annot"><span class="annottext">Blocked_
</span><a href="#local-6989586621681392555"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681392553"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defBlocked"><span class="hs-identifier hs-var">defBlocked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392552"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392555"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-343"></span><span class="annot"><span class="hs-comment">-- * Top level module</span></span><span>
</span><span id="line-344"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span class="hs-comment">-- | Tries to convert a raw top-level module name to a top-level</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- module name.</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#topLevelModuleName"><span class="hs-identifier hs-type">topLevelModuleName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#RawTopLevelModuleName"><span class="hs-identifier hs-type">RawTopLevelModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span>
</span><span id="line-350"></span><span id="topLevelModuleName"><span class="annot"><span class="annottext">topLevelModuleName :: RawTopLevelModuleName -&gt; TCM TopLevelModuleName
</span><a href="Agda.TypeChecking.Monad.State.html#topLevelModuleName"><span class="hs-identifier hs-var hs-var">topLevelModuleName</span></a></span></span><span> </span><span id="local-6989586621681392557"><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621681392558"><span class="annot"><span class="annottext">Maybe ModuleNameHash
</span><a href="#local-6989586621681392558"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
-&gt; BiMap RawTopLevelModuleName ModuleNameHash
-&gt; Maybe ModuleNameHash
forall k v. Ord k =&gt; k -&gt; BiMap k v -&gt; Maybe v
</span><a href="Agda.Utils.BiMap.html#lookup"><span class="hs-identifier hs-var">BiMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">(BiMap RawTopLevelModuleName ModuleNameHash
 -&gt; Maybe ModuleNameHash)
-&gt; TCMT IO (BiMap RawTopLevelModuleName ModuleNameHash)
-&gt; TCMT IO (Maybe ModuleNameHash)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' TCState (BiMap RawTopLevelModuleName ModuleNameHash)
-&gt; TCMT IO (BiMap RawTopLevelModuleName ModuleNameHash)
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(BiMap RawTopLevelModuleName ModuleNameHash
 -&gt; f (BiMap RawTopLevelModuleName ModuleNameHash))
-&gt; TCState -&gt; f TCState
Lens' TCState (BiMap RawTopLevelModuleName ModuleNameHash)
</span><a href="Agda.TypeChecking.Monad.Base.html#stTopLevelModuleNames"><span class="hs-identifier hs-var">stTopLevelModuleNames</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleNameHash
</span><a href="#local-6989586621681392558"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-353"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681392563"><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392563"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; TCM TopLevelModuleName
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawTopLevelModuleName -&gt; ModuleNameHash -&gt; TopLevelModuleName
</span><a href="Agda.Syntax.TopLevelModuleName.html#unsafeTopLevelModuleName"><span class="hs-identifier hs-var">unsafeTopLevelModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392563"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><span class="annottext">Maybe ModuleNameHash
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681392565"><span class="annot"><span class="annottext">hash :: ModuleNameHash
</span><a href="#local-6989586621681392565"><span class="hs-identifier hs-var hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName -&gt; ModuleNameHash
</span><a href="Agda.Syntax.TopLevelModuleName.html#hashRawTopLevelModuleName"><span class="hs-identifier hs-var">hashRawTopLevelModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392565"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash -&gt; ModuleNameHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="Agda.Syntax.TopLevelModuleName.Boot.html#noModuleNameHash"><span class="hs-identifier hs-var">noModuleNameHash</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; TCM ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM ()) -&gt; TypeError -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericError"><span class="hs-identifier hs-var">GenericError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TypeError) -&gt; [Char] -&gt; TypeError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;The module name &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; has a reserved &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;hash (you may want to consider renaming the module with &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;this name)&quot;</span></span><span>
</span><span id="line-360"></span><span>      </span><span id="local-6989586621681392570"><span class="annot"><span class="annottext">Maybe RawTopLevelModuleName
</span><a href="#local-6989586621681392570"><span class="hs-identifier hs-var">raw'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tag ModuleNameHash
-&gt; BiMap RawTopLevelModuleName ModuleNameHash
-&gt; Maybe RawTopLevelModuleName
forall v k. Ord (Tag v) =&gt; Tag v -&gt; BiMap k v -&gt; Maybe k
</span><a href="Agda.Utils.BiMap.html#invLookup"><span class="hs-identifier hs-var">BiMap.invLookup</span></a></span><span> </span><span class="annot"><span class="annottext">Tag ModuleNameHash
ModuleNameHash
</span><a href="#local-6989586621681392565"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">(BiMap RawTopLevelModuleName ModuleNameHash
 -&gt; Maybe RawTopLevelModuleName)
-&gt; TCMT IO (BiMap RawTopLevelModuleName ModuleNameHash)
-&gt; TCMT IO (Maybe RawTopLevelModuleName)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' TCState (BiMap RawTopLevelModuleName ModuleNameHash)
-&gt; TCMT IO (BiMap RawTopLevelModuleName ModuleNameHash)
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(BiMap RawTopLevelModuleName ModuleNameHash
 -&gt; f (BiMap RawTopLevelModuleName ModuleNameHash))
-&gt; TCState -&gt; f TCState
Lens' TCState (BiMap RawTopLevelModuleName ModuleNameHash)
</span><a href="Agda.TypeChecking.Monad.Base.html#stTopLevelModuleNames"><span class="hs-identifier hs-var">stTopLevelModuleNames</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe RawTopLevelModuleName
</span><a href="#local-6989586621681392570"><span class="hs-identifier hs-var">raw'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681392574"><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392574"><span class="hs-identifier hs-var">raw'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; TCM TopLevelModuleName
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM TopLevelModuleName)
-&gt; TypeError -&gt; TCM TopLevelModuleName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericError"><span class="hs-identifier hs-var">GenericError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TypeError) -&gt; [Char] -&gt; TypeError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-363"></span><span>          </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Module name hash collision for &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-364"></span><span>          </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392574"><span class="hs-identifier hs-var">raw'</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; (you may want to consider &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-365"></span><span>          </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;renaming one of these modules)&quot;</span></span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><span class="annottext">Maybe RawTopLevelModuleName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>          </span><span class="annot"><span class="annottext">(BiMap RawTopLevelModuleName ModuleNameHash
 -&gt; f (BiMap RawTopLevelModuleName ModuleNameHash))
-&gt; TCState -&gt; f TCState
Lens' TCState (BiMap RawTopLevelModuleName ModuleNameHash)
</span><a href="Agda.TypeChecking.Monad.Base.html#stTopLevelModuleNames"><span class="hs-identifier hs-var">stTopLevelModuleNames</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState (BiMap RawTopLevelModuleName ModuleNameHash)
-&gt; (BiMap RawTopLevelModuleName ModuleNameHash
    -&gt; BiMap RawTopLevelModuleName ModuleNameHash)
-&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTCLens%27"><span class="hs-operator hs-var">`modifyTCLens'`</span></a></span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><span class="annottext">RawTopLevelModuleName
-&gt; ModuleNameHash
-&gt; BiMap RawTopLevelModuleName ModuleNameHash
-&gt; BiMap RawTopLevelModuleName ModuleNameHash
forall k v.
(Ord k, HasTag v, Ord (Tag v)) =&gt;
k -&gt; v -&gt; BiMap k v -&gt; BiMap k v
</span><a href="Agda.Utils.BiMap.html#insert"><span class="hs-identifier hs-var">BiMap.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KillRangeT RawTopLevelModuleName
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392565"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-369"></span><span>          </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; TCM TopLevelModuleName
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RawTopLevelModuleName -&gt; ModuleNameHash -&gt; TopLevelModuleName
</span><a href="Agda.Syntax.TopLevelModuleName.html#unsafeTopLevelModuleName"><span class="hs-identifier hs-var">unsafeTopLevelModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">RawTopLevelModuleName
</span><a href="#local-6989586621681392557"><span class="hs-identifier hs-var">raw</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392565"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Set the top-level module. This affects the global module id of freshly</span><span>
</span><span id="line-372"></span><span class="hs-comment">--   generated names.</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setTopLevelModule"><span class="hs-identifier hs-type">setTopLevelModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span id="setTopLevelModule"><span class="annot"><span class="annottext">setTopLevelModule :: TopLevelModuleName -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setTopLevelModule"><span class="hs-identifier hs-var hs-var">setTopLevelModule</span></a></span></span><span> </span><span id="local-6989586621681392581"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392581"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-376"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681392582"><span class="annot"><span class="annottext">hash :: ModuleNameHash
</span><a href="#local-6989586621681392582"><span class="hs-identifier hs-var hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; ModuleNameHash
forall range. TopLevelModuleName' range -&gt; ModuleNameHash
</span><a href="Agda.Syntax.TopLevelModuleName.Boot.html#moduleNameId"><span class="hs-identifier hs-var">moduleNameId</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392581"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span class="annot"><span class="annottext">(NameId -&gt; f NameId) -&gt; TCState -&gt; f TCState
Lens' TCState NameId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshNameId"><span class="hs-identifier hs-var">stFreshNameId</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState NameId -&gt; NameId -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens%27"><span class="hs-operator hs-var">`setTCLens'`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; ModuleNameHash -&gt; NameId
</span><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-var">NameId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392582"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="annottext">(OpaqueId -&gt; f OpaqueId) -&gt; TCState -&gt; f TCState
Lens' TCState OpaqueId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshOpaqueId"><span class="hs-identifier hs-var">stFreshOpaqueId</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState OpaqueId -&gt; OpaqueId -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens%27"><span class="hs-operator hs-var">`setTCLens'`</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; ModuleNameHash -&gt; OpaqueId
</span><a href="Agda.Syntax.Common.html#OpaqueId"><span class="hs-identifier hs-var">OpaqueId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392582"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><span class="annottext">(MetaId -&gt; f MetaId) -&gt; TCState -&gt; f TCState
Lens' TCState MetaId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshMetaId"><span class="hs-identifier hs-var">stFreshMetaId</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState MetaId -&gt; MetaId -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens%27"><span class="hs-operator hs-var">`setTCLens'`</span></a></span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">metaId :: Word64
</span><a href="Agda.Syntax.Common.html#metaId"><span class="hs-identifier hs-var">metaId</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-381"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">metaModule :: ModuleNameHash
</span><a href="Agda.Syntax.Common.html#metaModule"><span class="hs-identifier hs-var">metaModule</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392582"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-382"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="annot"><span class="hs-comment">-- | The name of the current top-level module, if any.</span></span><span>
</span><span id="line-385"></span><span class="hs-pragma">{-# SPECIALIZE</span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#currentTopLevelModule"><span class="hs-pragma hs-type">currentTopLevelModule</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-pragma hs-type">TopLevelModuleName</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-387"></span><span class="hs-pragma">{-# SPECIALIZE</span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#currentTopLevelModule"><span class="hs-pragma hs-type">currentTopLevelModule</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReduceM"><span class="hs-pragma hs-type">ReduceM</span></a></span><span> </span><span class="hs-pragma">(</span><span class="annot"><span class="hs-pragma hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-pragma hs-type">TopLevelModuleName</span></a></span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-389"></span><span id="local-6989586621681391906"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#currentTopLevelModule"><span class="hs-identifier hs-type">currentTopLevelModule</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-type">MonadTCEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391906"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391906"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391906"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-391"></span><span id="currentTopLevelModule"><span class="annot"><span class="annottext">currentTopLevelModule :: forall (m :: * -&gt; *).
(MonadTCEnv m, ReadTCState m) =&gt;
m (Maybe TopLevelModuleName)
</span><a href="Agda.TypeChecking.Monad.State.html#currentTopLevelModule"><span class="hs-identifier hs-var hs-var">currentTopLevelModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621681392610"><span class="annot"><span class="annottext">Maybe (ModuleName, TopLevelModuleName)
</span><a href="#local-6989586621681392610"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState (Maybe (ModuleName, TopLevelModuleName))
-&gt; m (Maybe (ModuleName, TopLevelModuleName))
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (ModuleName, TopLevelModuleName)
 -&gt; f (Maybe (ModuleName, TopLevelModuleName)))
-&gt; TCState -&gt; f TCState
Lens' TCState (Maybe (ModuleName, TopLevelModuleName))
</span><a href="Agda.TypeChecking.Monad.Base.html#stCurrentModule"><span class="hs-identifier hs-var">stCurrentModule</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (ModuleName, TopLevelModuleName)
</span><a href="#local-6989586621681392610"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681392614"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392614"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TopLevelModuleName -&gt; m (Maybe TopLevelModuleName)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; Maybe TopLevelModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392614"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="annot"><span class="annottext">Maybe (ModuleName, TopLevelModuleName)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>      </span><span id="local-6989586621681392615"><span class="annot"><span class="annottext">[TopLevelModuleName]
</span><a href="#local-6989586621681392615"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; [TopLevelModuleName]) -&gt; m [TopLevelModuleName]
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; (TCEnv -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#asksTC"><span class="hs-identifier hs-var">asksTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCEnv -&gt; [TopLevelModuleName]
</span><a href="Agda.TypeChecking.Monad.Base.html#envImportPath"><span class="hs-identifier hs-var">envImportPath</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><span class="annottext">Maybe TopLevelModuleName -&gt; m (Maybe TopLevelModuleName)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe TopLevelModuleName -&gt; m (Maybe TopLevelModuleName))
-&gt; Maybe TopLevelModuleName -&gt; m (Maybe TopLevelModuleName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TopLevelModuleName]
</span><a href="#local-6989586621681392615"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-398"></span><span>        </span><span id="local-6989586621681392618"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392618"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[TopLevelModuleName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; Maybe TopLevelModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392618"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-399"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TopLevelModuleName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Use a different top-level module for a computation. Used when generating</span><span>
</span><span id="line-402"></span><span class="hs-comment">--   names for imported modules.</span><span>
</span><span id="line-403"></span><span id="local-6989586621681391913"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#withTopLevelModule"><span class="hs-identifier hs-type">withTopLevelModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.html#TopLevelModuleName"><span class="hs-identifier hs-type">TopLevelModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391913"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391913"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-404"></span><span id="withTopLevelModule"><span class="annot"><span class="annottext">withTopLevelModule :: forall a. TopLevelModuleName -&gt; TCM a -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#withTopLevelModule"><span class="hs-identifier hs-var hs-var">withTopLevelModule</span></a></span></span><span> </span><span id="local-6989586621681392635"><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392635"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681392636"><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392636"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621681392637"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681392637"><span class="hs-identifier hs-var">nextN</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState NameId -&gt; TCMT IO NameId
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(NameId -&gt; f NameId) -&gt; TCState -&gt; f TCState
Lens' TCState NameId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshNameId"><span class="hs-identifier hs-var">stFreshNameId</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span id="local-6989586621681392640"><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681392640"><span class="hs-identifier hs-var">nextM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState MetaId -&gt; TCMT IO MetaId
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; f MetaId) -&gt; TCState -&gt; f TCState
Lens' TCState MetaId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshMetaId"><span class="hs-identifier hs-var">stFreshMetaId</span></a></span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621681392643"><span class="annot"><span class="annottext">OpaqueId
</span><a href="#local-6989586621681392643"><span class="hs-identifier hs-var">nextO</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState OpaqueId -&gt; TCMT IO OpaqueId
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(OpaqueId -&gt; f OpaqueId) -&gt; TCState -&gt; f TCState
Lens' TCState OpaqueId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshOpaqueId"><span class="hs-identifier hs-var">stFreshOpaqueId</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><span class="annottext">TopLevelModuleName -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setTopLevelModule"><span class="hs-identifier hs-var">setTopLevelModule</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelModuleName
</span><a href="#local-6989586621681392635"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621681392646"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392646"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM a
</span><a href="#local-6989586621681392636"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><span class="annottext">(MetaId -&gt; f MetaId) -&gt; TCState -&gt; f TCState
Lens' TCState MetaId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshMetaId"><span class="hs-identifier hs-var">stFreshMetaId</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState MetaId -&gt; MetaId -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-operator hs-var">`setTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">MetaId
</span><a href="#local-6989586621681392640"><span class="hs-identifier hs-var">nextM</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><span class="annottext">(NameId -&gt; f NameId) -&gt; TCState -&gt; f TCState
Lens' TCState NameId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshNameId"><span class="hs-identifier hs-var">stFreshNameId</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState NameId -&gt; NameId -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-operator hs-var">`setTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681392637"><span class="hs-identifier hs-var">nextN</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="annot"><span class="annottext">(OpaqueId -&gt; f OpaqueId) -&gt; TCState -&gt; f TCState
Lens' TCState OpaqueId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshOpaqueId"><span class="hs-identifier hs-var">stFreshOpaqueId</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState OpaqueId -&gt; OpaqueId -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; a -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#setTCLens"><span class="hs-operator hs-var">`setTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">OpaqueId
</span><a href="#local-6989586621681392643"><span class="hs-identifier hs-var">nextO</span></a></span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; TCM a
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681392646"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-pragma">{-# SPECIALIZE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#currentModuleNameHash"><span class="hs-pragma hs-type">currentModuleNameHash</span></a></span><span> </span><span class="hs-pragma">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-pragma hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.Boot.html#ModuleNameHash"><span class="hs-pragma hs-type">ModuleNameHash</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-416"></span><span id="local-6989586621681391921"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#currentModuleNameHash"><span class="hs-identifier hs-type">currentModuleNameHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391921"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391921"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.TopLevelModuleName.Boot.html#ModuleNameHash"><span class="hs-identifier hs-type">ModuleNameHash</span></a></span></span><span>
</span><span id="line-417"></span><span id="currentModuleNameHash"><span class="annot"><span class="annottext">currentModuleNameHash :: forall (m :: * -&gt; *). ReadTCState m =&gt; m ModuleNameHash
</span><a href="Agda.TypeChecking.Monad.State.html#currentModuleNameHash"><span class="hs-identifier hs-var hs-var">currentModuleNameHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-418"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681392659"><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392659"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState NameId -&gt; m NameId
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(NameId -&gt; f NameId) -&gt; TCState -&gt; f TCState
Lens' TCState NameId
</span><a href="Agda.TypeChecking.Monad.Base.html#stFreshNameId"><span class="hs-identifier hs-var">stFreshNameId</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><span class="annottext">ModuleNameHash -&gt; m ModuleNameHash
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="#local-6989586621681392659"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">-- * Foreign code</span></span><span>
</span><span id="line-423"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#addForeignCode"><span class="hs-identifier hs-type">addForeignCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#BackendName"><span class="hs-identifier hs-type">BackendName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span id="addForeignCode"><span class="annot"><span class="annottext">addForeignCode :: [Char] -&gt; [Char] -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#addForeignCode"><span class="hs-identifier hs-var hs-var">addForeignCode</span></a></span></span><span> </span><span id="local-6989586621681392663"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392663"><span class="hs-identifier hs-var">backend</span></a></span></span><span> </span><span id="local-6989586621681392664"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392664"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-427"></span><span>  </span><span id="local-6989586621681392665"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681392665"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TCEnv -&gt; Range) -&gt; TCMT IO Range
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; (TCEnv -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#asksTC"><span class="hs-identifier hs-var">asksTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCEnv -&gt; Range
</span><a href="Agda.TypeChecking.Monad.Base.html#envRange"><span class="hs-identifier hs-var">envRange</span></a></span><span>  </span><span class="hs-comment">-- can't use TypeChecking.Monad.Trace.getCurrentRange without cycle</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><span class="annottext">Lens' TCState (Maybe ForeignCodeStack)
-&gt; (Maybe ForeignCodeStack -&gt; Maybe ForeignCodeStack) -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTCLens"><span class="hs-identifier hs-var">modifyTCLens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Map [Char] ForeignCodeStack -&gt; f (Map [Char] ForeignCodeStack))
-&gt; TCState -&gt; f TCState
Lens' TCState (Map [Char] ForeignCodeStack)
</span><a href="Agda.TypeChecking.Monad.Base.html#stForeignCode"><span class="hs-identifier hs-var">stForeignCode</span></a></span><span> </span><span class="annot"><span class="annottext">((Map [Char] ForeignCodeStack -&gt; f (Map [Char] ForeignCodeStack))
 -&gt; TCState -&gt; f TCState)
-&gt; ((Maybe ForeignCodeStack -&gt; f (Maybe ForeignCodeStack))
    -&gt; Map [Char] ForeignCodeStack -&gt; f (Map [Char] ForeignCodeStack))
-&gt; (Maybe ForeignCodeStack -&gt; f (Maybe ForeignCodeStack))
-&gt; TCState
-&gt; f TCState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Lens' (Map [Char] ForeignCodeStack) (Maybe ForeignCodeStack)
forall k v. Ord k =&gt; k -&gt; Lens' (Map k v) (Maybe v)
</span><a href="Agda.Utils.Lens.html#key"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392663"><span class="hs-identifier hs-var">backend</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe ForeignCodeStack -&gt; Maybe ForeignCodeStack) -&gt; TCM ())
-&gt; (Maybe ForeignCodeStack -&gt; Maybe ForeignCodeStack) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><span class="annottext">ForeignCodeStack -&gt; Maybe ForeignCodeStack
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ForeignCodeStack -&gt; Maybe ForeignCodeStack)
-&gt; (Maybe ForeignCodeStack -&gt; ForeignCodeStack)
-&gt; Maybe ForeignCodeStack
-&gt; Maybe ForeignCodeStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ForeignCode] -&gt; ForeignCodeStack
</span><a href="Agda.TypeChecking.Monad.Base.html#ForeignCodeStack"><span class="hs-identifier hs-var">ForeignCodeStack</span></a></span><span> </span><span class="annot"><span class="annottext">([ForeignCode] -&gt; ForeignCodeStack)
-&gt; (Maybe ForeignCodeStack -&gt; [ForeignCode])
-&gt; Maybe ForeignCodeStack
-&gt; ForeignCodeStack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; [Char] -&gt; ForeignCode
</span><a href="Agda.TypeChecking.Monad.Base.html#ForeignCode"><span class="hs-identifier hs-var">ForeignCode</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681392665"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621681392664"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignCode -&gt; [ForeignCode] -&gt; [ForeignCode]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ForeignCode] -&gt; [ForeignCode])
-&gt; (Maybe ForeignCodeStack -&gt; [ForeignCode])
-&gt; Maybe ForeignCodeStack
-&gt; [ForeignCode]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ForeignCode]
-&gt; (ForeignCodeStack -&gt; [ForeignCode])
-&gt; Maybe ForeignCodeStack
-&gt; [ForeignCode]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ForeignCodeStack -&gt; [ForeignCode]
</span><a href="Agda.TypeChecking.Monad.Base.html#getForeignCodeStack"><span class="hs-identifier hs-var">getForeignCodeStack</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-432"></span><span class="annot"><span class="hs-comment">-- * Interaction output callback</span></span><span>
</span><span id="line-433"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span id="local-6989586621681391931"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getInteractionOutputCallback"><span class="hs-identifier hs-type">getInteractionOutputCallback</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391931"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391931"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#InteractionOutputCallback"><span class="hs-identifier hs-type">InteractionOutputCallback</span></a></span></span><span>
</span><span id="line-436"></span><span id="getInteractionOutputCallback"><span class="annot"><span class="annottext">getInteractionOutputCallback :: forall (m :: * -&gt; *). ReadTCState m =&gt; m InteractionOutputCallback
</span><a href="Agda.TypeChecking.Monad.State.html#getInteractionOutputCallback"><span class="hs-identifier hs-var hs-var">getInteractionOutputCallback</span></a></span></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; InteractionOutputCallback)
-&gt; m InteractionOutputCallback
forall (m :: * -&gt; *) a. ReadTCState m =&gt; (TCState -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#getsTC"><span class="hs-identifier hs-var">getsTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCState -&gt; InteractionOutputCallback)
 -&gt; m InteractionOutputCallback)
-&gt; (TCState -&gt; InteractionOutputCallback)
-&gt; m InteractionOutputCallback
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PersistentTCState -&gt; InteractionOutputCallback
</span><a href="Agda.TypeChecking.Monad.Base.html#stInteractionOutputCallback"><span class="hs-identifier hs-var">stInteractionOutputCallback</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; InteractionOutputCallback)
-&gt; (TCState -&gt; PersistentTCState)
-&gt; TCState
-&gt; InteractionOutputCallback
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; PersistentTCState
</span><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#appInteractionOutputCallback"><span class="hs-identifier hs-type">appInteractionOutputCallback</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Interaction.Response.html#Response"><span class="hs-identifier hs-type">Response</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span id="appInteractionOutputCallback"><span class="annot"><span class="annottext">appInteractionOutputCallback :: InteractionOutputCallback
</span><a href="Agda.TypeChecking.Monad.State.html#appInteractionOutputCallback"><span class="hs-identifier hs-var hs-var">appInteractionOutputCallback</span></a></span></span><span> </span><span id="local-6989586621681392682"><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621681392682"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCMT IO InteractionOutputCallback
forall (m :: * -&gt; *). ReadTCState m =&gt; m InteractionOutputCallback
</span><a href="Agda.TypeChecking.Monad.State.html#getInteractionOutputCallback"><span class="hs-identifier hs-var">getInteractionOutputCallback</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO InteractionOutputCallback
-&gt; (InteractionOutputCallback -&gt; TCM ()) -&gt; TCM ()
forall a b. TCMT IO a -&gt; (a -&gt; TCMT IO b) -&gt; TCMT IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681392683"><span class="annot"><span class="annottext">InteractionOutputCallback
</span><a href="#local-6989586621681392683"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InteractionOutputCallback
</span><a href="#local-6989586621681392683"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">Response
</span><a href="#local-6989586621681392682"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setInteractionOutputCallback"><span class="hs-identifier hs-type">setInteractionOutputCallback</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#InteractionOutputCallback"><span class="hs-identifier hs-type">InteractionOutputCallback</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span id="setInteractionOutputCallback"><span class="annot"><span class="annottext">setInteractionOutputCallback :: InteractionOutputCallback -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setInteractionOutputCallback"><span class="hs-identifier hs-var hs-var">setInteractionOutputCallback</span></a></span></span><span> </span><span id="local-6989586621681392685"><span class="annot"><span class="annottext">InteractionOutputCallback
</span><a href="#local-6989586621681392685"><span class="hs-identifier hs-var">cb</span></a></span></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; PersistentTCState) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyPersistentState"><span class="hs-identifier hs-var">modifyPersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">((PersistentTCState -&gt; PersistentTCState) -&gt; TCM ())
-&gt; (PersistentTCState -&gt; PersistentTCState) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681392686"><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392686"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392686"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stInteractionOutputCallback"><span class="hs-identifier hs-var">stInteractionOutputCallback</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392685"><span class="hs-identifier hs-type">cb</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-448"></span><span class="annot"><span class="hs-comment">-- * Pattern synonyms</span></span><span>
</span><span id="line-449"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span id="local-6989586621681391937"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getPatternSyns"><span class="hs-identifier hs-type">getPatternSyns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681391937"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681391937"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefns"><span class="hs-identifier hs-type">PatternSynDefns</span></a></span></span><span>
</span><span id="line-452"></span><span id="getPatternSyns"><span class="annot"><span class="annottext">getPatternSyns :: forall (m :: * -&gt; *). ReadTCState m =&gt; m PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.State.html#getPatternSyns"><span class="hs-identifier hs-var hs-var">getPatternSyns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState PatternSynDefns -&gt; m PatternSynDefns
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(PatternSynDefns -&gt; f PatternSynDefns) -&gt; TCState -&gt; f TCState
Lens' TCState PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.Base.html#stPatternSyns"><span class="hs-identifier hs-var">stPatternSyns</span></a></span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#setPatternSyns"><span class="hs-identifier hs-type">setPatternSyns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefns"><span class="hs-identifier hs-type">PatternSynDefns</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span id="setPatternSyns"><span class="annot"><span class="annottext">setPatternSyns :: PatternSynDefns -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setPatternSyns"><span class="hs-identifier hs-var hs-var">setPatternSyns</span></a></span></span><span> </span><span id="local-6989586621681392694"><span class="annot"><span class="annottext">PatternSynDefns
</span><a href="#local-6989586621681392694"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PatternSynDefns -&gt; PatternSynDefns) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyPatternSyns"><span class="hs-identifier hs-var">modifyPatternSyns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternSynDefns -&gt; PatternSynDefns -&gt; PatternSynDefns
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PatternSynDefns
</span><a href="#local-6989586621681392694"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><span class="hs-comment">-- | Lens for 'stPatternSyns'.</span></span><span>
</span><span id="line-458"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyPatternSyns"><span class="hs-identifier hs-type">modifyPatternSyns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefns"><span class="hs-identifier hs-type">PatternSynDefns</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefns"><span class="hs-identifier hs-type">PatternSynDefns</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span id="modifyPatternSyns"><span class="annot"><span class="annottext">modifyPatternSyns :: (PatternSynDefns -&gt; PatternSynDefns) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyPatternSyns"><span class="hs-identifier hs-var hs-var">modifyPatternSyns</span></a></span></span><span> </span><span id="local-6989586621681392696"><span class="annot"><span class="annottext">PatternSynDefns -&gt; PatternSynDefns
</span><a href="#local-6989586621681392696"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PatternSynDefns -&gt; f PatternSynDefns) -&gt; TCState -&gt; f TCState
Lens' TCState PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.Base.html#stPatternSyns"><span class="hs-identifier hs-var">stPatternSyns</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TCState PatternSynDefns
-&gt; (PatternSynDefns -&gt; PatternSynDefns) -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadTCState m =&gt;
Lens' TCState a -&gt; (a -&gt; a) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTCLens"><span class="hs-operator hs-var">`modifyTCLens`</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSynDefns -&gt; PatternSynDefns
</span><a href="#local-6989586621681392696"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span id="local-6989586621681392699"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getPatternSynImports"><span class="hs-identifier hs-type">getPatternSynImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681392699"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefns"><span class="hs-identifier hs-type">PatternSynDefns</span></a></span></span><span>
</span><span id="line-462"></span><span id="getPatternSynImports"><span class="annot"><span class="annottext">getPatternSynImports :: forall (m :: * -&gt; *). ReadTCState m =&gt; m PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.State.html#getPatternSynImports"><span class="hs-identifier hs-var hs-var">getPatternSynImports</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState PatternSynDefns -&gt; m PatternSynDefns
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useR"><span class="hs-identifier hs-var">useR</span></a></span><span> </span><span class="annot"><span class="annottext">(PatternSynDefns -&gt; f PatternSynDefns) -&gt; TCState -&gt; f TCState
Lens' TCState PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.Base.html#stPatternSynImports"><span class="hs-identifier hs-var">stPatternSynImports</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="annot"><span class="hs-comment">-- | Get both local and imported pattern synonyms</span></span><span>
</span><span id="line-465"></span><span id="local-6989586621681392706"><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getAllPatternSyns"><span class="hs-identifier hs-type">getAllPatternSyns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-type">ReadTCState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392706"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681392706"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefns"><span class="hs-identifier hs-type">PatternSynDefns</span></a></span></span><span>
</span><span id="line-466"></span><span id="getAllPatternSyns"><span class="annot"><span class="annottext">getAllPatternSyns :: forall (m :: * -&gt; *). ReadTCState m =&gt; m PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.State.html#getAllPatternSyns"><span class="hs-identifier hs-var hs-var">getAllPatternSyns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatternSynDefns -&gt; PatternSynDefns -&gt; PatternSynDefns
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="annot"><span class="annottext">(PatternSynDefns -&gt; PatternSynDefns -&gt; PatternSynDefns)
-&gt; m PatternSynDefns -&gt; m (PatternSynDefns -&gt; PatternSynDefns)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PatternSynDefns
forall (m :: * -&gt; *). ReadTCState m =&gt; m PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.State.html#getPatternSyns"><span class="hs-identifier hs-var">getPatternSyns</span></a></span><span> </span><span class="annot"><span class="annottext">m (PatternSynDefns -&gt; PatternSynDefns)
-&gt; m PatternSynDefns -&gt; m PatternSynDefns
forall a b. m (a -&gt; b) -&gt; m a -&gt; m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">m PatternSynDefns
forall (m :: * -&gt; *). ReadTCState m =&gt; m PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.State.html#getPatternSynImports"><span class="hs-identifier hs-var">getPatternSynImports</span></a></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#lookupPatternSyn"><span class="hs-identifier hs-type">lookupPatternSyn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#AmbiguousQName"><span class="hs-identifier hs-type">AmbiguousQName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefn"><span class="hs-identifier hs-type">PatternSynDefn</span></a></span><span>
</span><span id="line-469"></span><span id="lookupPatternSyn"><span class="annot"><span class="annottext">lookupPatternSyn :: AmbiguousQName -&gt; TCM PatternSynDefn
</span><a href="Agda.TypeChecking.Monad.State.html#lookupPatternSyn"><span class="hs-identifier hs-var hs-var">lookupPatternSyn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#AmbQ"><span class="hs-identifier hs-type">AmbQ</span></a></span><span> </span><span id="local-6989586621681392720"><span class="annot"><span class="annottext">List1 QName
</span><a href="#local-6989586621681392720"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621681392721"><span class="annot"><span class="annottext">NonEmpty PatternSynDefn
</span><a href="#local-6989586621681392721"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; TCM PatternSynDefn)
-&gt; List1 QName -&gt; TCMT IO (NonEmpty PatternSynDefn)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM PatternSynDefn
</span><a href="Agda.TypeChecking.Monad.State.html#lookupSinglePatternSyn"><span class="hs-identifier hs-var">lookupSinglePatternSyn</span></a></span><span> </span><span class="annot"><span class="annottext">List1 QName
</span><a href="#local-6989586621681392720"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NonEmpty PatternSynDefn -&gt; Maybe PatternSynDefn
</span><a href="Agda.Syntax.Abstract.PatternSynonyms.html#mergePatternSynDefs"><span class="hs-identifier hs-var">mergePatternSynDefs</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty PatternSynDefn
</span><a href="#local-6989586621681392721"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681392725"><span class="annot"><span class="annottext">PatternSynDefn
</span><a href="#local-6989586621681392725"><span class="hs-identifier hs-var">def</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PatternSynDefn -&gt; TCM PatternSynDefn
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PatternSynDefn
</span><a href="#local-6989586621681392725"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><span class="annottext">Maybe PatternSynDefn
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; TCM PatternSynDefn
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM PatternSynDefn)
-&gt; TypeError -&gt; TCM PatternSynDefn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 (QName, PatternSynDefn) -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#CannotResolveAmbiguousPatternSynonym"><span class="hs-identifier hs-var">CannotResolveAmbiguousPatternSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">(List1 (QName, PatternSynDefn) -&gt; TypeError)
-&gt; List1 (QName, PatternSynDefn) -&gt; TypeError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">List1 QName
-&gt; NonEmpty PatternSynDefn -&gt; List1 (QName, PatternSynDefn)
forall a b. NonEmpty a -&gt; NonEmpty b -&gt; NonEmpty (a, b)
</span><span class="hs-identifier hs-var">List1.zip</span></span><span> </span><span class="annot"><span class="annottext">List1 QName
</span><a href="#local-6989586621681392720"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty PatternSynDefn
</span><a href="#local-6989586621681392721"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#lookupSinglePatternSyn"><span class="hs-identifier hs-type">lookupSinglePatternSyn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#PatternSynDefn"><span class="hs-identifier hs-type">PatternSynDefn</span></a></span><span>
</span><span id="line-476"></span><span id="lookupSinglePatternSyn"><span class="annot"><span class="annottext">lookupSinglePatternSyn :: QName -&gt; TCM PatternSynDefn
</span><a href="Agda.TypeChecking.Monad.State.html#lookupSinglePatternSyn"><span class="hs-identifier hs-var hs-var">lookupSinglePatternSyn</span></a></span></span><span> </span><span id="local-6989586621681392728"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392728"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621681392729"><span class="annot"><span class="annottext">PatternSynDefns
</span><a href="#local-6989586621681392729"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO PatternSynDefns
forall (m :: * -&gt; *). ReadTCState m =&gt; m PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.State.html#getPatternSyns"><span class="hs-identifier hs-var">getPatternSyns</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">QName -&gt; PatternSynDefns -&gt; Maybe PatternSynDefn
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392728"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSynDefns
</span><a href="#local-6989586621681392729"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-479"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681392731"><span class="annot"><span class="annottext">PatternSynDefn
</span><a href="#local-6989586621681392731"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PatternSynDefn -&gt; TCM PatternSynDefn
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PatternSynDefn
</span><a href="#local-6989586621681392731"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-480"></span><span>        </span><span class="annot"><span class="annottext">Maybe PatternSynDefn
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-481"></span><span>            </span><span id="local-6989586621681392732"><span class="annot"><span class="annottext">PatternSynDefns
</span><a href="#local-6989586621681392732"><span class="hs-identifier hs-var">si</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO PatternSynDefns
forall (m :: * -&gt; *). ReadTCState m =&gt; m PatternSynDefns
</span><a href="Agda.TypeChecking.Monad.State.html#getPatternSynImports"><span class="hs-identifier hs-var">getPatternSynImports</span></a></span><span>
</span><span id="line-482"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">QName -&gt; PatternSynDefns -&gt; Maybe PatternSynDefn
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392728"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">PatternSynDefns
</span><a href="#local-6989586621681392732"><span class="hs-identifier hs-var">si</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-483"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681392733"><span class="annot"><span class="annottext">PatternSynDefn
</span><a href="#local-6989586621681392733"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PatternSynDefn -&gt; TCM PatternSynDefn
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">PatternSynDefn
</span><a href="#local-6989586621681392733"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-484"></span><span>                </span><span class="annot"><span class="annottext">Maybe PatternSynDefn
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM PatternSynDefn
forall a. QName -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.State.html#notInScopeError"><span class="hs-identifier hs-var">notInScopeError</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; TCM PatternSynDefn) -&gt; QName -&gt; TCM PatternSynDefn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#qnameToConcrete"><span class="hs-identifier hs-var">qnameToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392728"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-487"></span><span class="annot"><span class="hs-comment">-- * Benchmark</span></span><span>
</span><span id="line-488"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="annot"><span class="hs-comment">-- | Lens getter for 'Benchmark' from 'TCState'.</span></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#theBenchmark"><span class="hs-identifier hs-type">theBenchmark</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Benchmarking.html#Benchmark"><span class="hs-identifier hs-type">Benchmark</span></a></span><span>
</span><span id="line-492"></span><span id="theBenchmark"><span class="annot"><span class="annottext">theBenchmark :: TCState -&gt; Benchmark
</span><a href="Agda.TypeChecking.Monad.State.html#theBenchmark"><span class="hs-identifier hs-var hs-var">theBenchmark</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PersistentTCState -&gt; Benchmark
</span><a href="Agda.TypeChecking.Monad.Base.html#stBenchmark"><span class="hs-identifier hs-var">stBenchmark</span></a></span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; Benchmark)
-&gt; (TCState -&gt; PersistentTCState) -&gt; TCState -&gt; Benchmark
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; PersistentTCState
</span><a href="Agda.TypeChecking.Monad.Base.html#stPersistentState"><span class="hs-identifier hs-var">stPersistentState</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateBenchmark"><span class="hs-pragma hs-type">updateBenchmark</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-495"></span><span class="annot"><span class="hs-comment">-- | Lens map for 'Benchmark'.</span></span><span>
</span><span id="line-496"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateBenchmark"><span class="hs-identifier hs-type">updateBenchmark</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Benchmarking.html#Benchmark"><span class="hs-identifier hs-type">Benchmark</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Benchmarking.html#Benchmark"><span class="hs-identifier hs-type">Benchmark</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span>
</span><span id="line-497"></span><span id="updateBenchmark"><span class="annot"><span class="annottext">updateBenchmark :: (Benchmark -&gt; Benchmark) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updateBenchmark"><span class="hs-identifier hs-var hs-var">updateBenchmark</span></a></span></span><span> </span><span id="local-6989586621681392737"><span class="annot"><span class="annottext">Benchmark -&gt; Benchmark
</span><a href="#local-6989586621681392737"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PersistentTCState -&gt; PersistentTCState) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updatePersistentState"><span class="hs-identifier hs-var">updatePersistentState</span></a></span><span> </span><span class="annot"><span class="annottext">((PersistentTCState -&gt; PersistentTCState) -&gt; TCState -&gt; TCState)
-&gt; (PersistentTCState -&gt; PersistentTCState) -&gt; TCState -&gt; TCState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681392738"><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392738"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PersistentTCState
</span><a href="#local-6989586621681392738"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stBenchmark"><span class="hs-identifier hs-var">stBenchmark</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681392737"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#stBenchmark"><span class="hs-identifier hs-var">stBenchmark</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681392738"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="annot"><span class="hs-comment">-- | Lens getter for 'Benchmark' from 'TCM'.</span></span><span>
</span><span id="line-500"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getBenchmark"><span class="hs-identifier hs-type">getBenchmark</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Benchmarking.html#Benchmark"><span class="hs-identifier hs-type">Benchmark</span></a></span><span>
</span><span id="line-501"></span><span id="getBenchmark"><span class="annot"><span class="annottext">getBenchmark :: TCM Benchmark
</span><a href="Agda.TypeChecking.Monad.State.html#getBenchmark"><span class="hs-identifier hs-var hs-var">getBenchmark</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; Benchmark) -&gt; TCM Benchmark
forall (m :: * -&gt; *) a. ReadTCState m =&gt; (TCState -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#getsTC"><span class="hs-identifier hs-var">getsTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCState -&gt; Benchmark) -&gt; TCM Benchmark)
-&gt; (TCState -&gt; Benchmark) -&gt; TCM Benchmark
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; Benchmark
</span><a href="Agda.TypeChecking.Monad.State.html#theBenchmark"><span class="hs-identifier hs-var">theBenchmark</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyBenchmark"><span class="hs-pragma hs-type">modifyBenchmark</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-504"></span><span class="annot"><span class="hs-comment">-- | Lens modify for 'Benchmark'.</span></span><span>
</span><span id="line-505"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyBenchmark"><span class="hs-identifier hs-type">modifyBenchmark</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Benchmarking.html#Benchmark"><span class="hs-identifier hs-type">Benchmark</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Benchmarking.html#Benchmark"><span class="hs-identifier hs-type">Benchmark</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span id="modifyBenchmark"><span class="annot"><span class="annottext">modifyBenchmark :: (Benchmark -&gt; Benchmark) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyBenchmark"><span class="hs-identifier hs-var hs-var">modifyBenchmark</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; TCState) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(TCState -&gt; TCState) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTC%27"><span class="hs-identifier hs-var">modifyTC'</span></a></span><span> </span><span class="annot"><span class="annottext">((TCState -&gt; TCState) -&gt; TCM ())
-&gt; ((Benchmark -&gt; Benchmark) -&gt; TCState -&gt; TCState)
-&gt; (Benchmark -&gt; Benchmark)
-&gt; TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Benchmark -&gt; Benchmark) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updateBenchmark"><span class="hs-identifier hs-var">updateBenchmark</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-509"></span><span class="annot"><span class="hs-comment">-- * Instance definitions</span></span><span>
</span><span id="line-510"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="annot"><span class="hs-comment">-- | Lens for 'stInstanceDefs'.</span></span><span>
</span><span id="line-513"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#updateInstanceDefs"><span class="hs-identifier hs-type">updateInstanceDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TempInstanceTable"><span class="hs-identifier hs-type">TempInstanceTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TempInstanceTable"><span class="hs-identifier hs-type">TempInstanceTable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCState"><span class="hs-identifier hs-type">TCState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span id="updateInstanceDefs"><span class="annot"><span class="annottext">updateInstanceDefs :: (TempInstanceTable -&gt; TempInstanceTable) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updateInstanceDefs"><span class="hs-identifier hs-var hs-var">updateInstanceDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' TCState TempInstanceTable
-&gt; (TempInstanceTable -&gt; TempInstanceTable) -&gt; TCState -&gt; TCState
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">(TempInstanceTable -&gt; f TempInstanceTable) -&gt; TCState -&gt; f TCState
Lens' TCState TempInstanceTable
</span><a href="Agda.TypeChecking.Monad.Base.html#stInstanceDefs"><span class="hs-identifier hs-var">stInstanceDefs</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#modifyInstanceDefs"><span class="hs-identifier hs-type">modifyInstanceDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TempInstanceTable"><span class="hs-identifier hs-type">TempInstanceTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TempInstanceTable"><span class="hs-identifier hs-type">TempInstanceTable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span id="modifyInstanceDefs"><span class="annot"><span class="annottext">modifyInstanceDefs :: (TempInstanceTable -&gt; TempInstanceTable) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyInstanceDefs"><span class="hs-identifier hs-var hs-var">modifyInstanceDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; TCState) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(TCState -&gt; TCState) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Base.html#modifyTC"><span class="hs-identifier hs-var">modifyTC</span></a></span><span> </span><span class="annot"><span class="annottext">((TCState -&gt; TCState) -&gt; TCM ())
-&gt; ((TempInstanceTable -&gt; TempInstanceTable) -&gt; TCState -&gt; TCState)
-&gt; (TempInstanceTable -&gt; TempInstanceTable)
-&gt; TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TempInstanceTable -&gt; TempInstanceTable) -&gt; TCState -&gt; TCState
</span><a href="Agda.TypeChecking.Monad.State.html#updateInstanceDefs"><span class="hs-identifier hs-var">updateInstanceDefs</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getAllInstanceDefs"><span class="hs-identifier hs-type">getAllInstanceDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TempInstanceTable"><span class="hs-identifier hs-type">TempInstanceTable</span></a></span><span>
</span><span id="line-520"></span><span id="getAllInstanceDefs"><span class="annot"><span class="annottext">getAllInstanceDefs :: TCM TempInstanceTable
</span><a href="Agda.TypeChecking.Monad.State.html#getAllInstanceDefs"><span class="hs-identifier hs-var hs-var">getAllInstanceDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681392747"><span class="annot"><span class="annottext">InstanceTable
</span><a href="#local-6989586621681392747"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681392748"><span class="annot"><span class="annottext">Set QName
</span><a href="#local-6989586621681392748"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState TempInstanceTable -&gt; TCM TempInstanceTable
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="annot"><span class="annottext">(TempInstanceTable -&gt; f TempInstanceTable) -&gt; TCState -&gt; f TCState
Lens' TCState TempInstanceTable
</span><a href="Agda.TypeChecking.Monad.Base.html#stInstanceDefs"><span class="hs-identifier hs-var">stInstanceDefs</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span id="local-6989586621681392751"><span class="annot"><span class="annottext">InstanceTable
</span><a href="#local-6989586621681392751"><span class="hs-identifier hs-var">itable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' TCState InstanceTable -&gt; TCMT IO InstanceTable
forall (m :: * -&gt; *) a. ReadTCState m =&gt; Lens' TCState a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#useTC"><span class="hs-identifier hs-var">useTC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Signature -&gt; f Signature) -&gt; TCState -&gt; f TCState
Lens' TCState Signature
</span><a href="Agda.TypeChecking.Monad.Base.html#stImports"><span class="hs-identifier hs-var">stImports</span></a></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; f Signature) -&gt; TCState -&gt; f TCState)
-&gt; ((InstanceTable -&gt; f InstanceTable) -&gt; Signature -&gt; f Signature)
-&gt; (InstanceTable -&gt; f InstanceTable)
-&gt; TCState
-&gt; f TCState
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(InstanceTable -&gt; f InstanceTable) -&gt; Signature -&gt; f Signature
Lens' Signature InstanceTable
</span><a href="Agda.TypeChecking.Monad.Base.html#sigInstances"><span class="hs-identifier hs-var">sigInstances</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681392756"><span class="annot"><span class="annottext">table' :: InstanceTable
</span><a href="#local-6989586621681392756"><span class="hs-identifier hs-var hs-var">table'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InstanceTable
</span><a href="#local-6989586621681392747"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">InstanceTable -&gt; InstanceTable -&gt; InstanceTable
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">InstanceTable
</span><a href="#local-6989586621681392751"><span class="hs-identifier hs-var">itable</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TCM ()
forall a. IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; TCM ()) -&gt; IO () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
</span><span class="hs-identifier hs-var">evaluate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstanceTable -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">InstanceTable
</span><a href="#local-6989586621681392756"><span class="hs-identifier hs-var">table'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><span class="annottext">TempInstanceTable -&gt; TCM TempInstanceTable
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InstanceTable
</span><a href="#local-6989586621681392756"><span class="hs-identifier hs-var">table'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set QName
</span><a href="#local-6989586621681392748"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#getAnonInstanceDefs"><span class="hs-identifier hs-type">getAnonInstanceDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span id="getAnonInstanceDefs"><span class="annot"><span class="annottext">getAnonInstanceDefs :: TCM (Set QName)
</span><a href="Agda.TypeChecking.Monad.State.html#getAnonInstanceDefs"><span class="hs-identifier hs-var hs-var">getAnonInstanceDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TempInstanceTable -&gt; Set QName
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(TempInstanceTable -&gt; Set QName)
-&gt; TCM TempInstanceTable -&gt; TCM (Set QName)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM TempInstanceTable
</span><a href="Agda.TypeChecking.Monad.State.html#getAllInstanceDefs"><span class="hs-identifier hs-var">getAllInstanceDefs</span></a></span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="annot"><span class="hs-comment">-- | Remove an instance from the set of unresolved instances.</span></span><span>
</span><span id="line-531"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#clearUnknownInstance"><span class="hs-identifier hs-type">clearUnknownInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span id="clearUnknownInstance"><span class="annot"><span class="annottext">clearUnknownInstance :: QName -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#clearUnknownInstance"><span class="hs-identifier hs-var hs-var">clearUnknownInstance</span></a></span></span><span> </span><span id="local-6989586621681392760"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392760"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TempInstanceTable -&gt; TempInstanceTable) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyInstanceDefs"><span class="hs-identifier hs-var">modifyInstanceDefs</span></a></span><span> </span><span class="annot"><span class="annottext">((TempInstanceTable -&gt; TempInstanceTable) -&gt; TCM ())
-&gt; (TempInstanceTable -&gt; TempInstanceTable) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Set QName -&gt; Set QName) -&gt; TempInstanceTable -&gt; TempInstanceTable
forall b d a. (b -&gt; d) -&gt; (a, b) -&gt; (a, d)
</span><a href="Agda.Utils.Tuple.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="annot"><span class="annottext">((Set QName -&gt; Set QName)
 -&gt; TempInstanceTable -&gt; TempInstanceTable)
-&gt; (Set QName -&gt; Set QName)
-&gt; TempInstanceTable
-&gt; TempInstanceTable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Set QName -&gt; Set QName
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.delete</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392760"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="annot"><span class="hs-comment">-- | Add an instance whose type is still unresolved.</span></span><span>
</span><span id="line-535"></span><span class="annot"><a href="Agda.TypeChecking.Monad.State.html#addUnknownInstance"><span class="hs-identifier hs-type">addUnknownInstance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span id="addUnknownInstance"><span class="annot"><span class="annottext">addUnknownInstance :: QName -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#addUnknownInstance"><span class="hs-identifier hs-var hs-var">addUnknownInstance</span></a></span></span><span> </span><span id="local-6989586621681392764"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392764"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-537"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Int -&gt; [Char] -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Int -&gt; [Char] -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.decl.instance&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCM ()) -&gt; [Char] -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-538"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;adding definition &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Char]
forall a. Pretty a =&gt; a -&gt; [Char]
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392764"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-539"></span><span>    </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; to the instance table (the type is not yet known)&quot;</span></span><span>
</span><span id="line-540"></span><span>  </span><span class="annot"><span class="annottext">(TempInstanceTable -&gt; TempInstanceTable) -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifyInstanceDefs"><span class="hs-identifier hs-var">modifyInstanceDefs</span></a></span><span> </span><span class="annot"><span class="annottext">((TempInstanceTable -&gt; TempInstanceTable) -&gt; TCM ())
-&gt; (TempInstanceTable -&gt; TempInstanceTable) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Set QName -&gt; Set QName) -&gt; TempInstanceTable -&gt; TempInstanceTable
forall b d a. (b -&gt; d) -&gt; (a, b) -&gt; (a, d)
</span><a href="Agda.Utils.Tuple.html#mapSnd"><span class="hs-identifier hs-var">mapSnd</span></a></span><span> </span><span class="annot"><span class="annottext">((Set QName -&gt; Set QName)
 -&gt; TempInstanceTable -&gt; TempInstanceTable)
-&gt; (Set QName -&gt; Set QName)
-&gt; TempInstanceTable
-&gt; TempInstanceTable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Set QName -&gt; Set QName
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681392764"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-541"></span></pre></body></html>