<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{-| Names in the concrete syntax are just strings (or lists of strings for
    qualified names).
-}</span></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.Syntax.Concrete.Name</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Char8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ByteString</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fold</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List.html#last1"><span class="hs-identifier">last1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier">List1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html"><span class="hs-identifier">Agda.Utils.List1</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List1</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Singleton.html"><span class="hs-identifier">Agda.Utils.Singleton</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Suffix.html"><span class="hs-identifier">Agda.Utils.Suffix</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="annot"><span class="hs-comment">{-| A name is a non-empty list of alternating 'Id's and 'Hole's. A normal name
    is represented by a singleton list, and operators are represented by a list
    with 'Hole's where the arguments should go. For instance: @[Hole,Id &quot;+&quot;,Hole]@
    is infix addition.

    Equality and ordering on @Name@s are defined to ignore range so same names
    in different locations are equal.
-}</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="Name"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Name"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ A (mixfix) identifier.</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="nameRange"><span class="annot"><span class="annottext">Name -&gt; Range
</span><a href="Agda.Syntax.Concrete.Name.html#nameRange"><span class="hs-identifier hs-var hs-var">nameRange</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="nameInScope"><span class="annot"><span class="annottext">Name -&gt; NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#nameInScope"><span class="hs-identifier hs-var hs-var">nameInScope</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-type">NameInScope</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="nameNameParts"><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameNameParts"><span class="hs-identifier hs-var hs-var">nameNameParts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">NameParts</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoName"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-var">NoName</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ @_@.</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="nameRange"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameRange"><span class="hs-identifier hs-var">nameRange</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="nameId"><span class="annot"><span class="annottext">Name -&gt; NameId
</span><a href="Agda.Syntax.Concrete.Name.html#nameId"><span class="hs-identifier hs-var hs-var">nameId</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">type</span><span> </span><span id="NameParts"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-var">NameParts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-type">NamePart</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | An open mixfix identifier is either prefix, infix, or suffix.</span><span>
</span><span id="line-49"></span><span class="hs-comment">--   That is to say: at least one of its extremities is a @Hole@</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isOpenMixfix"><span class="hs-identifier hs-type">isOpenMixfix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-52"></span><span id="isOpenMixfix"><span class="annot"><span class="annottext">isOpenMixfix :: Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isOpenMixfix"><span class="hs-identifier hs-var hs-var">isOpenMixfix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681271972"><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681271972"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621681271973"><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681271973"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681271974"><span class="annot"><span class="annottext">[NamePart]
</span><a href="#local-6989586621681271974"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681271972"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NamePart -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; NamePart
forall a. a -&gt; [a] -&gt; a
</span><a href="Agda.Utils.List.html#last1"><span class="hs-identifier hs-var">last1</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681271973"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">[NamePart]
</span><a href="#local-6989586621681271974"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NamePart -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Underscore"><span class="hs-identifier hs-type">Underscore</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621681271985"><span class="annot"><span class="annottext">underscore :: Name
</span><a href="#local-6989586621681271985"><span class="hs-identifier hs-var hs-var hs-var hs-var">underscore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameId -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-var">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">NameId
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621681271991"><span class="annot"><span class="annottext">isUnderscore :: Name -&gt; Bool
</span><a href="#local-6989586621681271991"><span class="hs-identifier hs-var hs-var hs-var hs-var">isUnderscore</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">nameNameParts :: Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameNameParts"><span class="hs-identifier hs-var">nameNameParts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681271993"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681271993"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. Underscore a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681271993"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Mixfix identifiers are composed of words and holes,</span><span>
</span><span id="line-63"></span><span class="hs-comment">--   e.g. @_+_@ or @if_then_else_@ or @[_/_]@.</span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="NamePart"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-var">NamePart</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Hole"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ @_@ part.</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Id"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Identifier part.</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621681271996"><span id="local-6989586621681271998"><span class="annot"><span class="annottext">(forall x. NamePart -&gt; Rep NamePart x)
-&gt; (forall x. Rep NamePart x -&gt; NamePart) -&gt; Generic NamePart
forall x. Rep NamePart x -&gt; NamePart
forall x. NamePart -&gt; Rep NamePart x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. NamePart -&gt; Rep NamePart x
from :: forall x. NamePart -&gt; Rep NamePart x
$cto :: forall x. Rep NamePart x -&gt; NamePart
to :: forall x. Rep NamePart x -&gt; NamePart
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Define equality on @Name@ to ignore range so same names in different</span><span>
</span><span id="line-70"></span><span class="hs-comment">--   locations are equal.</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">--   Is there a reason not to do this? -Jeff</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">--   No. But there are tons of reasons to do it. For instance, when using</span><span>
</span><span id="line-75"></span><span class="hs-comment">--   names as keys in maps you really don't want to have to get the range</span><span>
</span><span id="line-76"></span><span class="hs-comment">--   right to be able to do a lookup. -Ulf</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272003"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272010"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272010"><span class="hs-identifier hs-var">xs</span></a></span></span><span>    </span><span id="local-6989586621681272011"><span class="annot"><span class="annottext">== :: Name -&gt; Name -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272012"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272012"><span class="hs-identifier hs-var">ys</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272010"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; NameParts -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272012"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272013"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272013"><span class="hs-identifier hs-var">i</span></a></span></span><span>     </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272014"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272014"><span class="hs-identifier hs-var">j</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272013"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NameId -&gt; NameId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272014"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span>              </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272019"><span id="local-6989586621681272023"><span id="local-6989586621681272026"><span id="local-6989586621681272029"><span id="local-6989586621681272032"><span id="local-6989586621681272035"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621681272044"><span class="annot"><span class="annottext">compare :: Name -&gt; Name -&gt; Ordering
</span><a href="#local-6989586621681272044"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272046"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272046"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272047"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272047"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; NameParts -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272046"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272047"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272048"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272048"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272049"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272049"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameId -&gt; NameId -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272049"><span class="hs-identifier hs-var">j</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272052"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-type">NamePart</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>  </span><span id="local-6989586621681272055"><span class="annot"><span class="annottext">== :: NamePart -&gt; NamePart -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272056"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272056"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272057"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272057"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272056"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272057"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span>     </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272062"><span id="local-6989586621681272065"><span id="local-6989586621681272068"><span id="local-6989586621681272071"><span id="local-6989586621681272074"><span id="local-6989586621681272077"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-type">NamePart</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621681272083"><span class="annot"><span class="annottext">compare :: NamePart -&gt; NamePart -&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>    </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272084"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272084"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272085"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272085"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272084"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272085"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | @QName@ is a list of namespaces and the name of the constant.</span><span>
</span><span id="line-101"></span><span class="hs-comment">--   For the moment assumes namespaces are just @Name@s and not</span><span>
</span><span id="line-102"></span><span class="hs-comment">--     explicitly applied modules.</span><span>
</span><span id="line-103"></span><span class="hs-comment">--   Also assumes namespaces are generative by just using derived</span><span>
</span><span id="line-104"></span><span class="hs-comment">--     equality. We will have to define an equality instance to</span><span>
</span><span id="line-105"></span><span class="hs-comment">--     non-generative namespaces (as well as having some sort of</span><span>
</span><span id="line-106"></span><span class="hs-comment">--     lookup table for namespace names).</span><span>
</span><span id="line-107"></span><span class="hs-keyword">data</span><span> </span><span id="QName"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Qual"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-var">Qual</span></a></span></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ @A.rest@.</span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QName"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ @x@.</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681272089"><span id="local-6989586621681272095"><span class="annot"><span class="annottext">QName -&gt; QName -&gt; Bool
(QName -&gt; QName -&gt; Bool) -&gt; (QName -&gt; QName -&gt; Bool) -&gt; Eq QName
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: QName -&gt; QName -&gt; Bool
== :: QName -&gt; QName -&gt; Bool
$c/= :: QName -&gt; QName -&gt; Bool
/= :: QName -&gt; QName -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681272100"><span id="local-6989586621681272106"><span id="local-6989586621681272111"><span id="local-6989586621681272114"><span id="local-6989586621681272117"><span id="local-6989586621681272120"><span id="local-6989586621681272123"><span class="annot"><span class="annottext">Eq QName
Eq QName =&gt;
(QName -&gt; QName -&gt; Ordering)
-&gt; (QName -&gt; QName -&gt; Bool)
-&gt; (QName -&gt; QName -&gt; Bool)
-&gt; (QName -&gt; QName -&gt; Bool)
-&gt; (QName -&gt; QName -&gt; Bool)
-&gt; (QName -&gt; QName -&gt; QName)
-&gt; (QName -&gt; QName -&gt; QName)
-&gt; Ord QName
QName -&gt; QName -&gt; Bool
QName -&gt; QName -&gt; Ordering
QName -&gt; QName -&gt; QName
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: QName -&gt; QName -&gt; Ordering
compare :: QName -&gt; QName -&gt; Ordering
$c&lt; :: QName -&gt; QName -&gt; Bool
&lt; :: QName -&gt; QName -&gt; Bool
$c&lt;= :: QName -&gt; QName -&gt; Bool
&lt;= :: QName -&gt; QName -&gt; Bool
$c&gt; :: QName -&gt; QName -&gt; Bool
&gt; :: QName -&gt; QName -&gt; Bool
$c&gt;= :: QName -&gt; QName -&gt; Bool
&gt;= :: QName -&gt; QName -&gt; Bool
$cmax :: QName -&gt; QName -&gt; QName
max :: QName -&gt; QName -&gt; QName
$cmin :: QName -&gt; QName -&gt; QName
min :: QName -&gt; QName -&gt; QName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Underscore"><span class="hs-identifier hs-type">Underscore</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621681272131"><span class="annot"><span class="annottext">underscore :: QName
</span><a href="Agda.Syntax.Common.html#underscore"><span class="hs-identifier hs-var hs-var hs-var hs-var">underscore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
forall a. Underscore a =&gt; a
</span><a href="Agda.Syntax.Common.html#underscore"><span class="hs-identifier hs-var">underscore</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span id="local-6989586621681272133"><span class="annot"><span class="annottext">isUnderscore :: QName -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var hs-var hs-var hs-var">isUnderscore</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272134"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272134"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall a. Underscore a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272134"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-118"></span><span class="annot"><span class="hs-comment">-- * Constructing simple 'Name's.</span></span><span>
</span><span id="line-119"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><span class="hs-comment">-- | Create an ordinary 'InScope' name.</span></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#simpleName"><span class="hs-identifier hs-type">simpleName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-123"></span><span id="simpleName"><span class="annot"><span class="annottext">simpleName :: String -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#simpleName"><span class="hs-identifier hs-var hs-var">simpleName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameInScope -&gt; NameParts -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; Name) -&gt; (String -&gt; NameParts) -&gt; String -&gt; Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NameParts
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(NamePart -&gt; NameParts)
-&gt; (String -&gt; NamePart) -&gt; String -&gt; NameParts
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><span class="hs-comment">-- | Create a binary operator name in scope.</span></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#simpleBinaryOperator"><span class="hs-identifier hs-type">simpleBinaryOperator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-127"></span><span id="simpleBinaryOperator"><span class="annot"><span class="annottext">simpleBinaryOperator :: String -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#simpleBinaryOperator"><span class="hs-identifier hs-var hs-var">simpleBinaryOperator</span></a></span></span><span> </span><span id="local-6989586621681272140"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272140"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameInScope -&gt; NameParts -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; Name) -&gt; NameParts -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; NameParts
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272140"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; [NamePart]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; [NamePart]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><span class="hs-comment">-- | Create an ordinary 'InScope' name containing a single 'Hole'.</span></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#simpleHole"><span class="hs-identifier hs-type">simpleHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-131"></span><span id="simpleHole"><span class="annot"><span class="annottext">simpleHole :: Name
</span><a href="Agda.Syntax.Concrete.Name.html#simpleHole"><span class="hs-identifier hs-var hs-var">simpleHole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameInScope -&gt; NameParts -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; Name) -&gt; NameParts -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NameParts
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-134"></span><span class="annot"><span class="hs-comment">-- * Operations on 'Name' and 'NamePart'</span></span><span>
</span><span id="line-135"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">-- | Don't use on 'NoName{}'.</span></span><span>
</span><span id="line-138"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#lensNameParts"><span class="hs-identifier hs-type">lensNameParts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">NameParts</span></a></span><span>
</span><span id="line-139"></span><span id="lensNameParts"><span class="annot"><span class="annottext">lensNameParts :: Lens' Name NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#lensNameParts"><span class="hs-identifier hs-var hs-var">lensNameParts</span></a></span></span><span> </span><span id="local-6989586621681272147"><span class="annot"><span class="annottext">NameParts -&gt; f NameParts
</span><a href="#local-6989586621681272147"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621681272148"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621681272148"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; f NameParts
</span><a href="#local-6989586621681272147"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameNameParts"><span class="hs-identifier hs-var">nameNameParts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272148"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f NameParts -&gt; (NameParts -&gt; Name) -&gt; f Name
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681272150"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272150"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272148"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameNameParts"><span class="hs-identifier hs-var">nameNameParts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681272150"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-type">nameToRawName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span>
</span><span id="line-144"></span><span id="nameToRawName"><span class="annot"><span class="annottext">nameToRawName :: Name -&gt; String
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var hs-var">nameToRawName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-type">nameParts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">NameParts</span></a></span><span>
</span><span id="line-147"></span><span id="nameParts"><span class="annot"><span class="annottext">nameParts :: Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var hs-var">nameParts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272154"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272154"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272154"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NameParts
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(NamePart -&gt; NameParts) -&gt; NamePart -&gt; NameParts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="hs-comment">-- To not return an empty list</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameStringParts"><span class="hs-identifier hs-type">nameStringParts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-151"></span><span id="nameStringParts"><span class="annot"><span class="annottext">nameStringParts :: Name -&gt; [String]
</span><a href="Agda.Syntax.Concrete.Name.html#nameStringParts"><span class="hs-identifier hs-var hs-var">nameStringParts</span></a></span></span><span> </span><span id="local-6989586621681272156"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272156"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272157"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272157"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272157"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; [Item NameParts]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">List1.toList</span></span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; [Item NameParts]) -&gt; NameParts -&gt; [Item NameParts]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272156"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Parse a string to parts of a concrete name.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">--   Note: @stringNameParts &quot;_&quot; == [Id &quot;_&quot;] == nameParts NoName{}@</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#stringNameParts"><span class="hs-identifier hs-type">stringNameParts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">NameParts</span></a></span><span>
</span><span id="line-158"></span><span id="stringNameParts"><span class="annot"><span class="annottext">stringNameParts :: String -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#stringNameParts"><span class="hs-identifier hs-var hs-var">stringNameParts</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NameParts
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(NamePart -&gt; NameParts) -&gt; NamePart -&gt; NameParts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span>  </span><span class="hs-comment">-- NoName</span><span>
</span><span id="line-159"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#stringNameParts"><span class="hs-identifier hs-var">stringNameParts</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NameParts
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(NamePart -&gt; NameParts) -&gt; NamePart -&gt; NameParts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span>  </span><span class="hs-comment">-- NoName</span><span>
</span><span id="line-160"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#stringNameParts"><span class="hs-identifier hs-var">stringNameParts</span></a></span><span> </span><span id="local-6989586621681272159"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272159"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; [NamePart] -&gt; NameParts
forall a. List1 a -&gt; [a] -&gt; List1 a
</span><a href="Agda.Utils.List1.html#fromListSafe"><span class="hs-identifier hs-var">List1.fromListSafe</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">([NamePart] -&gt; NameParts) -&gt; [NamePart] -&gt; NameParts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [NamePart]
</span><a href="#local-6989586621681272161"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272159"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621681272161"><span class="annot"><span class="annottext">loop :: String -&gt; [NamePart]
</span><a href="#local-6989586621681272161"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>                              </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="#local-6989586621681272161"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681272167"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272167"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; [NamePart]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [NamePart]
</span><a href="#local-6989586621681272161"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272167"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="#local-6989586621681272161"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span id="local-6989586621681272168"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272168"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681272169"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272169"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681272170"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272170"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272168"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Agda.Syntax.Common.html#stringToRawName"><span class="hs-identifier hs-var">stringToRawName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272169"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; [NamePart]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [NamePart]
</span><a href="#local-6989586621681272161"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272170"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="annot"><span class="hs-comment">-- | Number of holes in a 'Name' (i.e., arity of a mixfix-operator).</span></span><span>
</span><span id="line-167"></span><span class="hs-keyword">class</span><span> </span><span id="NumHoles"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NumHoles"><span class="hs-identifier hs-var">NumHoles</span></a></span></span><span> </span><span id="local-6989586621681271832"><span class="annot"><a href="#local-6989586621681271832"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="numHoles"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-type">numHoles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681271832"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NumHoles"><span class="hs-identifier hs-type">NumHoles</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">NameParts</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621681272180"><span class="annot"><span class="annottext">numHoles :: NameParts -&gt; Int
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var hs-var hs-var hs-var">numHoles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NamePart] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([NamePart] -&gt; Int)
-&gt; (NameParts -&gt; [NamePart]) -&gt; NameParts -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NamePart -&gt; Bool) -&gt; NameParts -&gt; [NamePart]
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">List1.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart -&gt; NamePart -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NumHoles"><span class="hs-identifier hs-type">NumHoles</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621681272186"><span class="annot"><span class="annottext">numHoles :: Name -&gt; Int
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var hs-var hs-var hs-var">numHoles</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var">numHoles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nameNameParts :: Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameNameParts"><span class="hs-identifier hs-var">nameNameParts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681272187"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272187"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; Int
forall a. NumHoles a =&gt; a -&gt; Int
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var">numHoles</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272187"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NumHoles"><span class="hs-identifier hs-type">NumHoles</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621681272192"><span class="annot"><span class="annottext">numHoles :: QName -&gt; Int
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var hs-var hs-var hs-var">numHoles</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272193"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272193"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Int
forall a. NumHoles a =&gt; a -&gt; Int
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var">numHoles</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272193"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var">numHoles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272194"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272194"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Int
forall a. NumHoles a =&gt; a -&gt; Int
</span><a href="Agda.Syntax.Concrete.Name.html#numHoles"><span class="hs-identifier hs-var">numHoles</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272194"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Is the name an operator?</span><span>
</span><span id="line-182"></span><span class="hs-comment">--   Needs at least 2 'NamePart's.</span><span>
</span><span id="line-183"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isOperator"><span class="hs-identifier hs-type">isOperator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-184"></span><span id="isOperator"><span class="annot"><span class="annottext">isOperator :: Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isOperator"><span class="hs-identifier hs-var hs-var">isOperator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[NamePart]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-type">isHole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-type">NamePart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-189"></span><span id="isHole"><span class="annot"><span class="annottext">isHole :: NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var hs-var">isHole</span></a></span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isPrefix"><span class="hs-identifier hs-type">isPrefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isPostfix"><span class="hs-identifier hs-type">isPostfix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isInfix"><span class="hs-identifier hs-type">isInfix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isNonfix"><span class="hs-identifier hs-type">isNonfix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-193"></span><span id="isPrefix"><span class="annot"><span class="annottext">isPrefix :: Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isPrefix"><span class="hs-identifier hs-var hs-var">isPrefix</span></a></span></span><span>  </span><span id="local-6989586621681272201"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272201"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272204"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>      </span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.last</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272204"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681272204"><span class="annot"><span class="annottext">xs :: NameParts
</span><a href="#local-6989586621681272204"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272201"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-194"></span><span id="isPostfix"><span class="annot"><span class="annottext">isPostfix :: Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isPostfix"><span class="hs-identifier hs-var hs-var">isPostfix</span></a></span></span><span> </span><span id="local-6989586621681272207"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272207"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>      </span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272208"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.last</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272208"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681272208"><span class="annot"><span class="annottext">xs :: NameParts
</span><a href="#local-6989586621681272208"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272207"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-195"></span><span id="isInfix"><span class="annot"><span class="annottext">isInfix :: Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isInfix"><span class="hs-identifier hs-var hs-var">isInfix</span></a></span></span><span>   </span><span id="local-6989586621681272209"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272209"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>      </span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272210"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>      </span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.last</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272210"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681272210"><span class="annot"><span class="annottext">xs :: NameParts
</span><a href="#local-6989586621681272210"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272209"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-196"></span><span id="isNonfix"><span class="annot"><span class="annottext">isNonfix :: Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNonfix"><span class="hs-identifier hs-var hs-var">isNonfix</span></a></span></span><span>  </span><span id="local-6989586621681272211"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272211"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.head</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272212"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isHole"><span class="hs-identifier hs-var">isHole</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NameParts -&gt; NamePart
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">List1.last</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272212"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681272212"><span class="annot"><span class="annottext">xs :: NameParts
</span><a href="#local-6989586621681272212"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#nameParts"><span class="hs-identifier hs-var">nameParts</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272211"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-200"></span><span class="annot"><span class="hs-comment">-- * Keeping track of which names are (not) in scope</span></span><span>
</span><span id="line-201"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">data</span><span> </span><span id="NameInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-var">NameInScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NotInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NotInScope"><span class="hs-identifier hs-var">NotInScope</span></a></span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681272215"><span id="local-6989586621681272217"><span class="annot"><span class="annottext">NameInScope -&gt; NameInScope -&gt; Bool
(NameInScope -&gt; NameInScope -&gt; Bool)
-&gt; (NameInScope -&gt; NameInScope -&gt; Bool) -&gt; Eq NameInScope
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: NameInScope -&gt; NameInScope -&gt; Bool
== :: NameInScope -&gt; NameInScope -&gt; Bool
$c/= :: NameInScope -&gt; NameInScope -&gt; Bool
/= :: NameInScope -&gt; NameInScope -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681272221"><span id="local-6989586621681272223"><span id="local-6989586621681272227"><span class="annot"><span class="annottext">Int -&gt; NameInScope -&gt; String -&gt; String
[NameInScope] -&gt; String -&gt; String
NameInScope -&gt; String
(Int -&gt; NameInScope -&gt; String -&gt; String)
-&gt; (NameInScope -&gt; String)
-&gt; ([NameInScope] -&gt; String -&gt; String)
-&gt; Show NameInScope
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
$cshowsPrec :: Int -&gt; NameInScope -&gt; String -&gt; String
showsPrec :: Int -&gt; NameInScope -&gt; String -&gt; String
$cshow :: NameInScope -&gt; String
show :: NameInScope -&gt; String
$cshowList :: [NameInScope] -&gt; String -&gt; String
showList :: [NameInScope] -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">class</span><span> </span><span id="LensInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#LensInScope"><span class="hs-identifier hs-var">LensInScope</span></a></span></span><span> </span><span id="local-6989586621681271838"><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="lensInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-type">lensInScope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-type">NameInScope</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>  </span><span id="isInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isInScope"><span class="hs-identifier hs-type">isInScope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-type">NameInScope</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621681272233"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isInScope"><span class="hs-identifier hs-var hs-var">isInScope</span></a></span><span> </span><span id="local-6989586621681272234"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681272234"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681272234"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Lens' a NameInScope -&gt; NameInScope
forall o i. o -&gt; Lens' o i -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; f NameInScope) -&gt; a -&gt; f a
forall a. LensInScope a =&gt; Lens' a NameInScope
Lens' a NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-var">lensInScope</span></a></span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>  </span><span id="mapInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#mapInScope"><span class="hs-identifier hs-type">mapInScope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-type">NameInScope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-type">NameInScope</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621681272240"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#mapInScope"><span class="hs-identifier hs-var hs-var">mapInScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' a NameInScope -&gt; (NameInScope -&gt; NameInScope) -&gt; a -&gt; a
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; f NameInScope) -&gt; a -&gt; f a
forall a. LensInScope a =&gt; Lens' a NameInScope
Lens' a NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-var">lensInScope</span></a></span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>  </span><span id="setInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#setInScope"><span class="hs-identifier hs-type">setInScope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621681272246"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#setInScope"><span class="hs-identifier hs-var hs-var">setInScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; NameInScope) -&gt; a -&gt; a
forall a. LensInScope a =&gt; (NameInScope -&gt; NameInScope) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Concrete.Name.html#mapInScope"><span class="hs-identifier hs-var">mapInScope</span></a></span><span> </span><span class="annot"><span class="annottext">((NameInScope -&gt; NameInScope) -&gt; a -&gt; a)
-&gt; (NameInScope -&gt; NameInScope) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameInScope -&gt; NameInScope -&gt; NameInScope
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span>  </span><span id="setNotInScope"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#setNotInScope"><span class="hs-identifier hs-type">setNotInScope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681271838"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621681272250"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#setNotInScope"><span class="hs-identifier hs-var hs-var">setNotInScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; NameInScope) -&gt; a -&gt; a
forall a. LensInScope a =&gt; (NameInScope -&gt; NameInScope) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Concrete.Name.html#mapInScope"><span class="hs-identifier hs-var">mapInScope</span></a></span><span> </span><span class="annot"><span class="annottext">((NameInScope -&gt; NameInScope) -&gt; a -&gt; a)
-&gt; (NameInScope -&gt; NameInScope) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameInScope -&gt; NameInScope -&gt; NameInScope
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#NotInScope"><span class="hs-identifier hs-var">NotInScope</span></a></span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272254"><span id="local-6989586621681272258"><span id="local-6989586621681272261"><span id="local-6989586621681272264"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#LensInScope"><span class="hs-identifier hs-type">LensInScope</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-type">NameInScope</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621681272268"><span class="annot"><span class="annottext">lensInScope :: Lens' NameInScope NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-var hs-var hs-var hs-var">lensInScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; f NameInScope) -&gt; NameInScope -&gt; f NameInScope
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272272"><span id="local-6989586621681272275"><span id="local-6989586621681272278"><span id="local-6989586621681272281"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#LensInScope"><span class="hs-identifier hs-type">LensInScope</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621681272286"><span class="annot"><span class="annottext">lensInScope :: Lens' Name NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-var hs-var hs-var hs-var">lensInScope</span></a></span></span><span> </span><span id="local-6989586621681272287"><span class="annot"><span class="annottext">NameInScope -&gt; f NameInScope
</span><a href="#local-6989586621681272287"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621681272288"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621681272288"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nameInScope :: Name -&gt; NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#nameInScope"><span class="hs-identifier hs-var">nameInScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681272289"><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272289"><span class="hs-identifier hs-var">nis</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621681272290"><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272290"><span class="hs-identifier hs-var">nis'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272288"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameInScope"><span class="hs-identifier hs-var">nameInScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681272290"><span class="hs-identifier hs-type">nis'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; Name) -&gt; f NameInScope -&gt; f Name
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NameInScope -&gt; f NameInScope
</span><a href="#local-6989586621681272287"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272289"><span class="hs-identifier hs-var">nis</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621681272292"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621681272292"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272292"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; f NameInScope -&gt; f Name
forall a b. a -&gt; f b -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">NameInScope -&gt; f NameInScope
</span><a href="#local-6989586621681272287"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272296"><span id="local-6989586621681272300"><span id="local-6989586621681272303"><span id="local-6989586621681272306"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#LensInScope"><span class="hs-identifier hs-type">LensInScope</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621681272315"><span class="annot"><span class="annottext">lensInScope :: Lens' QName NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-var hs-var hs-var hs-var">lensInScope</span></a></span></span><span> </span><span id="local-6989586621681272316"><span class="annot"><span class="annottext">NameInScope -&gt; f NameInScope
</span><a href="#local-6989586621681272316"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272317"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272317"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681272318"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272318"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-operator hs-var">`Qual`</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272318"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; f Name -&gt; f QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; f NameInScope) -&gt; Name -&gt; f Name
forall a. LensInScope a =&gt; Lens' a NameInScope
Lens' Name NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-var">lensInScope</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope -&gt; f NameInScope
</span><a href="#local-6989586621681272316"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272317"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272319"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272319"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; f Name -&gt; f QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NameInScope -&gt; f NameInScope) -&gt; Name -&gt; f Name
forall a. LensInScope a =&gt; Lens' a NameInScope
Lens' Name NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#lensInScope"><span class="hs-identifier hs-var">lensInScope</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope -&gt; f NameInScope
</span><a href="#local-6989586621681272316"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272319"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-235"></span><span class="annot"><span class="hs-comment">-- * Generating fresh names</span></span><span>
</span><span id="line-236"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">-- | Method by which to generate fresh unshadowed names.</span></span><span>
</span><span id="line-239"></span><span class="hs-keyword">data</span><span> </span><span id="FreshNameMode"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#FreshNameMode"><span class="hs-identifier hs-var">FreshNameMode</span></a></span></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="UnicodeSubscript"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#UnicodeSubscript"><span class="hs-identifier hs-var">UnicodeSubscript</span></a></span></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Append an integer Unicode subscript: x, x&#8321;, x&#8322;, &#8230;</span></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AsciiCounter"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#AsciiCounter"><span class="hs-identifier hs-var">AsciiCounter</span></a></span></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Append an integer ASCII counter: x, x1, x2, &#8230;</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">-- Note that @Agda.Utils.Suffix@ supports an additional style, @Prime@, but</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-comment">-- we currently only encounter it when extending an existing name of that</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-comment">-- format, (x', x'', &#8230;), not for an initially-generated permutation. There's</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-comment">-- no reason we couldn't, except that we currently choose between</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-comment">-- subscript/counter styles based on the --no-unicode mode rather than any</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-comment">-- finer-grained option.</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">--   | PrimeTickCount</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-comment">--   ^ Append an ASCII prime/apostrophe: x, x', x'', &#8230;</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nextRawName"><span class="hs-identifier hs-type">nextRawName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#FreshNameMode"><span class="hs-identifier hs-type">FreshNameMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span>
</span><span id="line-255"></span><span id="nextRawName"><span class="annot"><span class="annottext">nextRawName :: FreshNameMode -&gt; String -&gt; String
</span><a href="Agda.Syntax.Concrete.Name.html#nextRawName"><span class="hs-identifier hs-var hs-var">nextRawName</span></a></span></span><span> </span><span id="local-6989586621681272323"><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621681272323"><span class="hs-identifier hs-var">freshNameMode</span></a></span></span><span> </span><span id="local-6989586621681272324"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272324"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Suffix -&gt; String
</span><a href="Agda.Utils.Suffix.html#addSuffix"><span class="hs-identifier hs-var">addSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272326"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Suffix -&gt; (Suffix -&gt; Suffix) -&gt; Maybe Suffix -&gt; Suffix
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Suffix
</span><a href="#local-6989586621681272328"><span class="hs-identifier hs-var">initialSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Suffix -&gt; Suffix
</span><a href="Agda.Utils.Suffix.html#nextSuffix"><span class="hs-identifier hs-var">nextSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Suffix
</span><a href="#local-6989586621681272330"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681272326"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272326"><span class="hs-identifier hs-var">root</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681272330"><span class="annot"><span class="annottext">Maybe Suffix
</span><a href="#local-6989586621681272330"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, Maybe Suffix)
</span><a href="Agda.Utils.Suffix.html#suffixView"><span class="hs-identifier hs-var">suffixView</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272324"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621681272328"><span class="annot"><span class="annottext">initialSuffix :: Suffix
</span><a href="#local-6989586621681272328"><span class="hs-identifier hs-var hs-var">initialSuffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621681272323"><span class="hs-identifier hs-var">freshNameMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="Agda.Syntax.Concrete.Name.html#UnicodeSubscript"><span class="hs-identifier hs-var">UnicodeSubscript</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Suffix
</span><a href="Agda.Utils.Suffix.html#Subscript"><span class="hs-identifier hs-var">Subscript</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="Agda.Syntax.Concrete.Name.html#AsciiCounter"><span class="hs-identifier hs-var">AsciiCounter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Suffix
</span><a href="Agda.Utils.Suffix.html#Index"><span class="hs-identifier hs-var">Index</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Get the next version of the concrete name. For instance,</span><span>
</span><span id="line-263"></span><span class="hs-comment">--   @nextName &quot;x&quot; = &quot;x&#8321;&quot;@.  The name must not be a 'NoName'.</span><span>
</span><span id="line-264"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nextName"><span class="hs-identifier hs-type">nextName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#FreshNameMode"><span class="hs-identifier hs-type">FreshNameMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-265"></span><span id="nextName"><span class="annot"><span class="annottext">nextName :: FreshNameMode -&gt; Name -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#nextName"><span class="hs-identifier hs-var hs-var">nextName</span></a></span></span><span> </span><span id="local-6989586621681272335"><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621681272335"><span class="hs-identifier hs-var">freshNameMode</span></a></span></span><span> </span><span id="local-6989586621681272336"><span class="annot"><span class="annottext">x :: Name
</span><a href="#local-6989586621681272336"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
forall a. LensInScope a =&gt; a -&gt; a
</span><a href="Agda.Syntax.Concrete.Name.html#setNotInScope"><span class="hs-identifier hs-var">setNotInScope</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Name) -&gt; Name -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lens' Name String -&gt; LensMap Name String
forall o i. Lens' o i -&gt; LensMap o i
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NameParts -&gt; f NameParts) -&gt; Name -&gt; f Name
Lens' Name NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#lensNameParts"><span class="hs-identifier hs-var">lensNameParts</span></a></span><span> </span><span class="annot"><span class="annottext">((NameParts -&gt; f NameParts) -&gt; Name -&gt; f Name)
-&gt; ((String -&gt; f String) -&gt; NameParts -&gt; f NameParts)
-&gt; (String -&gt; f String)
-&gt; Name
-&gt; f Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; f String) -&gt; NameParts -&gt; f NameParts
Lens' NameParts String
</span><a href="Agda.Syntax.Concrete.Name.html#lastIdPart"><span class="hs-identifier hs-var">lastIdPart</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreshNameMode -&gt; String -&gt; String
</span><a href="Agda.Syntax.Concrete.Name.html#nextRawName"><span class="hs-identifier hs-var">nextRawName</span></a></span><span> </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621681272335"><span class="hs-identifier hs-var">freshNameMode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272336"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-266"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nextName"><span class="hs-identifier hs-var">nextName</span></a></span><span>             </span><span class="annot"><span class="annottext">FreshNameMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><span class="hs-comment">-- | Zoom on the last non-hole in a name.</span></span><span>
</span><span id="line-269"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#lastIdPart"><span class="hs-identifier hs-type">lastIdPart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameParts"><span class="hs-identifier hs-type">NameParts</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span>
</span><span id="line-270"></span><span id="lastIdPart"><span class="annot"><span class="annottext">lastIdPart :: Lens' NameParts String
</span><a href="Agda.Syntax.Concrete.Name.html#lastIdPart"><span class="hs-identifier hs-var hs-var">lastIdPart</span></a></span></span><span> </span><span id="local-6989586621681272347"><span class="annot"><span class="annottext">String -&gt; f String
</span><a href="#local-6989586621681272347"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; f NameParts
</span><a href="#local-6989586621681272348"><span class="hs-identifier hs-var">loop</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621681272348"><span class="annot"><span class="annottext">loop :: NameParts -&gt; f NameParts
</span><a href="#local-6989586621681272348"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272349"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272349"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; f String
</span><a href="#local-6989586621681272347"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272349"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">f String -&gt; (String -&gt; NameParts) -&gt; f NameParts
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681272350"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272350"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272350"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; NameParts
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272351"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272351"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; f String
</span><a href="#local-6989586621681272347"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272351"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">f String -&gt; (String -&gt; NameParts) -&gt; f NameParts
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681272352"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272352"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-var">Id</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272352"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; NameParts
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>    </span><span id="local-6989586621681272353"><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681272353"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621681272354"><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681272354"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681272355"><span class="annot"><span class="annottext">[NamePart]
</span><a href="#local-6989586621681272355"><span class="hs-identifier hs-var">ps</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681272353"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; NameParts -&gt; NameParts
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">&lt;|</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; NameParts) -&gt; f NameParts -&gt; f NameParts
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; f NameParts
</span><a href="#local-6989586621681272348"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart
</span><a href="#local-6989586621681272354"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; [NamePart] -&gt; NameParts
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[NamePart]
</span><a href="#local-6989586621681272355"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f NameParts
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Get the first version of the concrete name that does not satisfy</span><span>
</span><span id="line-279"></span><span class="hs-comment">--   the given predicate.</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#firstNonTakenName"><span class="hs-identifier hs-type">firstNonTakenName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#FreshNameMode"><span class="hs-identifier hs-type">FreshNameMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-281"></span><span id="firstNonTakenName"><span class="annot"><span class="annottext">firstNonTakenName :: FreshNameMode -&gt; (Name -&gt; Bool) -&gt; Name -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#firstNonTakenName"><span class="hs-identifier hs-var hs-var">firstNonTakenName</span></a></span></span><span> </span><span id="local-6989586621681272357"><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621681272357"><span class="hs-identifier hs-var">freshNameMode</span></a></span></span><span> </span><span id="local-6989586621681272358"><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621681272358"><span class="hs-identifier hs-var">taken</span></a></span></span><span> </span><span id="local-6989586621681272359"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272359"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621681272358"><span class="hs-identifier hs-var">taken</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272359"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FreshNameMode -&gt; (Name -&gt; Bool) -&gt; Name -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#firstNonTakenName"><span class="hs-identifier hs-var">firstNonTakenName</span></a></span><span> </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621681272357"><span class="hs-identifier hs-var">freshNameMode</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="#local-6989586621681272358"><span class="hs-identifier hs-var">taken</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FreshNameMode -&gt; Name -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#nextName"><span class="hs-identifier hs-var">nextName</span></a></span><span> </span><span class="annot"><span class="annottext">FreshNameMode
</span><a href="#local-6989586621681272357"><span class="hs-identifier hs-var">freshNameMode</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272359"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272359"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | Lens for accessing and modifying the suffix of a name.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--   The suffix of a @NoName@ is always @Nothing@, and should not be</span><span>
</span><span id="line-288"></span><span class="hs-comment">--   changed.</span><span>
</span><span id="line-289"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameSuffix"><span class="hs-identifier hs-type">nameSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Suffix.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span id="nameSuffix"><span class="annot"><span class="annottext">nameSuffix :: Lens' Name (Maybe Suffix)
</span><a href="Agda.Syntax.Concrete.Name.html#nameSuffix"><span class="hs-identifier hs-var hs-var">nameSuffix</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681272368"><span id="local-6989586621681272369"><span class="annot"><span class="annottext">Maybe Suffix -&gt; f (Maybe Suffix)
</span><a href="#local-6989586621681272369"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Suffix.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681272368"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Suffix.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">)</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621681272370"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621681272370"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Suffix -&gt; f (Maybe Suffix)
</span><a href="#local-6989586621681272369"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Suffix
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">f (Maybe Suffix) -&gt; (Maybe Suffix -&gt; Name) -&gt; f Name
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><span class="annottext">Maybe Suffix
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272370"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621681272371"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621681272371"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(NameParts -&gt; f NameParts) -&gt; Name -&gt; f Name
Lens' Name NameParts
</span><a href="Agda.Syntax.Concrete.Name.html#lensNameParts"><span class="hs-identifier hs-var">lensNameParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; f String) -&gt; NameParts -&gt; f NameParts
Lens' NameParts String
</span><a href="Agda.Syntax.Concrete.Name.html#lastIdPart"><span class="hs-identifier hs-var">lastIdPart</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; f String
</span><a href="#local-6989586621681272372"><span class="hs-identifier hs-var">idSuf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272371"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621681272372"><span class="annot"><span class="annottext">idSuf :: String -&gt; f String
</span><a href="#local-6989586621681272372"><span class="hs-identifier hs-var hs-var">idSuf</span></a></span></span><span> </span><span id="local-6989586621681272373"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272373"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681272374"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272374"><span class="hs-identifier hs-var">root</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681272375"><span class="annot"><span class="annottext">Maybe Suffix
</span><a href="#local-6989586621681272375"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, Maybe Suffix)
</span><a href="Agda.Utils.Suffix.html#suffixView"><span class="hs-identifier hs-var">suffixView</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272373"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Suffix -&gt; String) -&gt; Maybe Suffix -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272374"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Suffix -&gt; String
</span><a href="Agda.Utils.Suffix.html#addSuffix"><span class="hs-identifier hs-var">addSuffix</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272374"><span class="hs-identifier hs-var">root</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Suffix -&gt; String) -&gt; f (Maybe Suffix) -&gt; f String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Suffix -&gt; f (Maybe Suffix)
</span><a href="#local-6989586621681272369"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Suffix
</span><a href="#local-6989586621681272375"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><span class="hs-comment">-- | Split a name into a base name plus a suffix.</span></span><span>
</span><span id="line-303"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameSuffixView"><span class="hs-identifier hs-type">nameSuffixView</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Suffix.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span id="nameSuffixView"><span class="annot"><span class="annottext">nameSuffixView :: Name -&gt; (Maybe Suffix, Name)
</span><a href="Agda.Syntax.Concrete.Name.html#nameSuffixView"><span class="hs-identifier hs-var hs-var">nameSuffixView</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe Suffix -&gt; (Maybe Suffix, Maybe Suffix))
-&gt; Name -&gt; (Maybe Suffix, Name)
Lens' Name (Maybe Suffix)
</span><a href="Agda.Syntax.Concrete.Name.html#nameSuffix"><span class="hs-identifier hs-var">nameSuffix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Suffix
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | Replaces the suffix of a name. Unless the suffix is @Nothing@,</span><span>
</span><span id="line-307"></span><span class="hs-comment">--   the name should not be @NoName@.</span><span>
</span><span id="line-308"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#setNameSuffix"><span class="hs-identifier hs-type">setNameSuffix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Suffix.html#Suffix"><span class="hs-identifier hs-type">Suffix</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-309"></span><span id="setNameSuffix"><span class="annot"><span class="annottext">setNameSuffix :: Maybe Suffix -&gt; Name -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#setNameSuffix"><span class="hs-identifier hs-var hs-var">setNameSuffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' Name (Maybe Suffix) -&gt; Maybe Suffix -&gt; Name -&gt; Name
forall o i. Lens' o i -&gt; LensSet o i
</span><a href="Agda.Utils.Lens.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Suffix -&gt; f (Maybe Suffix)) -&gt; Name -&gt; f Name
Lens' Name (Maybe Suffix)
</span><a href="Agda.Syntax.Concrete.Name.html#nameSuffix"><span class="hs-identifier hs-var">nameSuffix</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Get a raw version of the name with all suffixes removed. For</span><span>
</span><span id="line-312"></span><span class="hs-comment">--   instance, @nameRoot &quot;x&#8321;&#8322;&#8323;&quot; = &quot;x&quot;@.</span><span>
</span><span id="line-313"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#nameRoot"><span class="hs-identifier hs-type">nameRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#RawName"><span class="hs-identifier hs-type">RawName</span></a></span><span>
</span><span id="line-314"></span><span id="nameRoot"><span class="annot"><span class="annottext">nameRoot :: Name -&gt; String
</span><a href="Agda.Syntax.Concrete.Name.html#nameRoot"><span class="hs-identifier hs-var hs-var">nameRoot</span></a></span></span><span> </span><span id="local-6989586621681272382"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272382"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="Agda.Syntax.Concrete.Name.html#nameToRawName"><span class="hs-identifier hs-var">nameToRawName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; String) -&gt; Name -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Suffix, Name) -&gt; Name
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Maybe Suffix, Name) -&gt; Name) -&gt; (Maybe Suffix, Name) -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; (Maybe Suffix, Name)
</span><a href="Agda.Syntax.Concrete.Name.html#nameSuffixView"><span class="hs-identifier hs-var">nameSuffixView</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272382"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#sameRoot"><span class="hs-identifier hs-type">sameRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-317"></span><span id="sameRoot"><span class="annot"><span class="annottext">sameRoot :: Name -&gt; Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#sameRoot"><span class="hs-identifier hs-var hs-var">sameRoot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; Bool)
-&gt; (Name -&gt; String) -&gt; Name -&gt; Name -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><a href="Agda.Syntax.Concrete.Name.html#nameRoot"><span class="hs-identifier hs-var">nameRoot</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-320"></span><span class="annot"><span class="hs-comment">-- * Operations on qualified names</span></span><span>
</span><span id="line-321"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="annot"><span class="hs-comment">-- | Lens for the unqualified part of a QName</span></span><span>
</span><span id="line-324"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#lensQNameName"><span class="hs-identifier hs-type">lensQNameName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-325"></span><span id="lensQNameName"><span class="annot"><span class="annottext">lensQNameName :: Lens' QName Name
</span><a href="Agda.Syntax.Concrete.Name.html#lensQNameName"><span class="hs-identifier hs-var hs-var">lensQNameName</span></a></span></span><span> </span><span id="local-6989586621681272390"><span class="annot"><span class="annottext">Name -&gt; f Name
</span><a href="#local-6989586621681272390"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272391"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272391"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; f Name -&gt; f QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; f Name
</span><a href="#local-6989586621681272390"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272391"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#lensQNameName"><span class="hs-identifier hs-var">lensQNameName</span></a></span><span> </span><span id="local-6989586621681272392"><span class="annot"><span class="annottext">Name -&gt; f Name
</span><a href="#local-6989586621681272392"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272393"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272393"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681272394"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272394"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-var">Qual</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272393"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; QName) -&gt; f QName -&gt; f QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; f Name) -&gt; QName -&gt; f QName
Lens' QName Name
</span><a href="Agda.Syntax.Concrete.Name.html#lensQNameName"><span class="hs-identifier hs-var">lensQNameName</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; f Name
</span><a href="#local-6989586621681272392"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272394"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><span class="hs-comment">-- | @qualify A.B x == A.B.x@</span></span><span>
</span><span id="line-329"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#qualify"><span class="hs-identifier hs-type">qualify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-330"></span><span id="qualify"><span class="annot"><span class="annottext">qualify :: QName -&gt; Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#qualify"><span class="hs-identifier hs-var hs-var">qualify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272396"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272396"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681272397"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272397"><span class="hs-identifier hs-var">x</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-var">Qual</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272396"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272397"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#qualify"><span class="hs-identifier hs-var">qualify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272398"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272398"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681272399"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272399"><span class="hs-identifier hs-var">m'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681272400"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272400"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-var">Qual</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272398"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; QName) -&gt; QName -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#qualify"><span class="hs-identifier hs-var">qualify</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272399"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272400"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | @unqualify A.B.x == x@</span><span>
</span><span id="line-334"></span><span class="hs-comment">--</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- The range is preserved.</span><span>
</span><span id="line-336"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-type">unqualify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-337"></span><span id="unqualify"><span class="annot"><span class="annottext">unqualify :: QName -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#unqualify"><span class="hs-identifier hs-var hs-var">unqualify</span></a></span></span><span> </span><span id="local-6989586621681272402"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272402"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="#local-6989586621681272403"><span class="hs-identifier hs-var">unqualify'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272402"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; Name
forall t u. (SetRange t, HasRange u) =&gt; t -&gt; u -&gt; t
</span><a href="Agda.Syntax.Position.html#withRangeOf"><span class="hs-operator hs-var">`withRangeOf`</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272402"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621681272403"><span class="annot"><span class="annottext">unqualify' :: QName -&gt; Name
</span><a href="#local-6989586621681272403"><span class="hs-identifier hs-var hs-var">unqualify'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272405"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272405"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272405"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><a href="#local-6989586621681272403"><span class="hs-identifier hs-var">unqualify'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272406"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272406"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="#local-6989586621681272403"><span class="hs-identifier hs-var">unqualify'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272406"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><span class="hs-comment">-- | @qnameParts A.B.x = [A, B, x]@</span></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#qnameParts"><span class="hs-identifier hs-type">qnameParts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.List1.html#List1"><span class="hs-identifier hs-type">List1</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-344"></span><span id="qnameParts"><span class="annot"><span class="annottext">qnameParts :: QName -&gt; List1 Name
</span><a href="Agda.Syntax.Concrete.Name.html#qnameParts"><span class="hs-identifier hs-var hs-var">qnameParts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272408"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272408"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681272409"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272409"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272408"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; List1 Name -&gt; List1 Name
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; List1 Name
</span><a href="Agda.Syntax.Concrete.Name.html#qnameParts"><span class="hs-identifier hs-var">qnameParts</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272409"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#qnameParts"><span class="hs-identifier hs-var">qnameParts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272410"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272410"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; List1 Name
forall el coll. Singleton el coll =&gt; el -&gt; coll
</span><a href="Agda.Utils.Singleton.html#singleton"><span class="hs-identifier hs-var">singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272410"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="annot"><span class="hs-comment">-- | Is the name (un)qualified?</span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isQualified"><span class="hs-identifier hs-type">isQualified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-350"></span><span id="isQualified"><span class="annot"><span class="annottext">isQualified :: QName -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isQualified"><span class="hs-identifier hs-var hs-var">isQualified</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-351"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isQualified"><span class="hs-identifier hs-var">isQualified</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isUnqualified"><span class="hs-identifier hs-type">isUnqualified</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-354"></span><span id="isUnqualified"><span class="annot"><span class="annottext">isUnqualified :: QName -&gt; Maybe Name
</span><a href="Agda.Syntax.Concrete.Name.html#isUnqualified"><span class="hs-identifier hs-var hs-var">isUnqualified</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-355"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isUnqualified"><span class="hs-identifier hs-var">isUnqualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272413"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272413"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272413"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-358"></span><span class="annot"><span class="hs-comment">-- * No name stuff</span></span><span>
</span><span id="line-359"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><span class="hs-comment">-- | @noName_ = 'noName' 'noRange'@</span></span><span>
</span><span id="line-362"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#noName_"><span class="hs-identifier hs-type">noName_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-363"></span><span id="noName_"><span class="annot"><span class="annottext">noName_ :: Name
</span><a href="Agda.Syntax.Concrete.Name.html#noName_"><span class="hs-identifier hs-var hs-var">noName_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#noName"><span class="hs-identifier hs-var">noName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#noName"><span class="hs-identifier hs-type">noName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-366"></span><span id="noName"><span class="annot"><span class="annottext">noName :: Range -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#noName"><span class="hs-identifier hs-var hs-var">noName</span></a></span></span><span> </span><span id="local-6989586621681272416"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272416"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameId -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-var">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272416"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; ModuleNameHash -&gt; NameId
</span><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-var">NameId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ModuleNameHash
</span><a href="Agda.Syntax.TopLevelModuleName.Boot.html#noModuleNameHash"><span class="hs-identifier hs-var">noModuleNameHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="annot"><span class="hs-comment">-- | Check whether a name is the empty name &quot;_&quot;.</span></span><span>
</span><span id="line-369"></span><span class="hs-keyword">class</span><span> </span><span id="IsNoName"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-var">IsNoName</span></a></span></span><span> </span><span id="local-6989586621681271881"><span class="annot"><a href="#local-6989586621681271881"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>  </span><span id="isNoName"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-type">isNoName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681271881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="isNoName"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-type">isNoName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681271878"><span id="local-6989586621681271879"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621681271878"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681271879"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621681271878"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681271879"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621681271881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681271881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621681272421"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var hs-var">isNoName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; Bool) -&gt; t b -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">Fold.all</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621681272434"><span class="annot"><span class="annottext">isNoName :: String -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var hs-var hs-var hs-var">isNoName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. Underscore a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621681272439"><span class="annot"><span class="annottext">isNoName :: ByteString -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var hs-var hs-var hs-var">isNoName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Bool
forall a. Underscore a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621681272443"><span class="annot"><span class="annottext">isNoName :: Name -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var hs-var hs-var hs-var">isNoName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272444"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272444"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272444"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621681272448"><span class="annot"><span class="annottext">isNoName :: QName -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var hs-var hs-var hs-var">isNoName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272449"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272449"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall a. IsNoName a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272449"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#isNoName"><span class="hs-identifier hs-var">isNoName</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>        </span><span class="hs-comment">-- M.A._ does not qualify as empty name</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681271889"><span id="local-6989586621681272452"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681271889"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Ranged"><span class="hs-identifier hs-type">Ranged</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681271889"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-393"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681271892"><span id="local-6989586621681272461"><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681271892"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#IsNoName"><span class="hs-identifier hs-type">IsNoName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#WithOrigin"><span class="hs-identifier hs-type">WithOrigin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681271892"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-396"></span><span class="annot"><span class="hs-comment">-- * Showing names</span></span><span>
</span><span id="line-397"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span id="local-6989586621681272469"><span id="local-6989586621681272484"><span id="local-6989586621681272488"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span></span><span>
</span><span id="line-400"></span><span id="local-6989586621681272495"><span id="local-6989586621681272501"><span id="local-6989586621681272504"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-type">NamePart</span></a></span></span></span></span><span>
</span><span id="line-401"></span><span id="local-6989586621681272508"><span id="local-6989586621681272516"><span id="local-6989586621681272519"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span></span></span></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-404"></span><span class="annot"><span class="hs-comment">-- * Printing names</span></span><span>
</span><span id="line-405"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272523"><span id="local-6989586621681272526"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621681272537"><span class="annot"><span class="annottext">pretty :: Name -&gt; Doc
</span><a href="#local-6989586621681272537"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272539"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272539"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Doc -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#hcat"><span class="hs-identifier hs-var">hcat</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty Doc -&gt; Doc) -&gt; NonEmpty Doc -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(NamePart -&gt; Doc) -&gt; NameParts -&gt; NonEmpty Doc
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">NamePart -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272539"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NameId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;_&quot;</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272543"><span id="local-6989586621681272546"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-type">NamePart</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621681272549"><span class="annot"><span class="annottext">pretty :: NamePart -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;_&quot;</span></span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272550"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272550"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
forall a. String -&gt; Doc a
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc) -&gt; String -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Agda.Syntax.Common.html#rawNameToString"><span class="hs-identifier hs-var">rawNameToString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272550"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681272555"><span id="local-6989586621681272559"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621681272570"><span class="annot"><span class="annottext">pretty :: QName -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272571"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272571"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681272572"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272572"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall a. Underscore a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isUnderscore"><span class="hs-identifier hs-var">isUnderscore</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272571"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272572"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- don't print anonymous modules</span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272571"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272572"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272573"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272573"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272573"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">-- * Range instances</span></span><span>
</span><span id="line-423"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621681272577"><span class="annot"><span class="annottext">getRange :: Name -&gt; Range
</span><a href="#local-6989586621681272577"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621681272579"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272579"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272580"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272580"><span class="hs-identifier hs-var">_ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272579"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span id="local-6989586621681272581"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272581"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">NameId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272581"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#HasRange"><span class="hs-identifier hs-type">HasRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621681272586"><span class="annot"><span class="annottext">getRange :: QName -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>  </span><span id="local-6989586621681272587"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272587"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272587"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272588"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272588"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681272589"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272589"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; Range
forall u t. (HasRange u, HasRange t) =&gt; u -&gt; t -&gt; Range
</span><a href="Agda.Syntax.Position.html#fuseRange"><span class="hs-identifier hs-var">fuseRange</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272588"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272589"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#SetRange"><span class="hs-identifier hs-type">SetRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-434"></span><span>  </span><span id="local-6989586621681272595"><span class="annot"><span class="annottext">setRange :: Range -&gt; Name -&gt; Name
</span><a href="#local-6989586621681272595"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRange</span></a></span></span><span> </span><span id="local-6989586621681272597"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272597"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272598"><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272598"><span class="hs-identifier hs-var">nis</span></a></span></span><span> </span><span id="local-6989586621681272599"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272599"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameInScope -&gt; NameParts -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272597"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272598"><span class="hs-identifier hs-var">nis</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272599"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-435"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var">setRange</span></a></span><span> </span><span id="local-6989586621681272600"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272600"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272601"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272601"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameId -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-var">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272600"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272601"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#SetRange"><span class="hs-identifier hs-type">SetRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>  </span><span id="local-6989586621681272609"><span class="annot"><span class="annottext">setRange :: Range -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRange</span></a></span></span><span> </span><span id="local-6989586621681272610"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272610"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272611"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272611"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; Name
forall a. SetRange a =&gt; Range -&gt; a -&gt; a
</span><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var">setRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272610"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272611"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var">setRange</span></a></span><span> </span><span id="local-6989586621681272612"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272612"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272613"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272613"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681272614"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272614"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-var">Qual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Name -&gt; Name
forall a. SetRange a =&gt; Range -&gt; a -&gt; a
</span><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var">setRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272612"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272613"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; QName
forall a. SetRange a =&gt; Range -&gt; a -&gt; a
</span><a href="Agda.Syntax.Position.html#setRange"><span class="hs-identifier hs-var">setRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272612"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272614"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#KillRange"><span class="hs-identifier hs-type">KillRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621681272622"><span class="annot"><span class="annottext">killRange :: QName -&gt; QName
</span><a href="#local-6989586621681272622"><span class="hs-identifier hs-var hs-var hs-var hs-var">killRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272624"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272624"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-var">QName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272624"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272625"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272625"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621681272626"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272626"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272625"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName -&gt; QName
</span><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-operator hs-var">`Qual`</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; QName
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272626"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html#KillRange"><span class="hs-identifier hs-type">KillRange</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-446"></span><span>  </span><span id="local-6989586621681272631"><span class="annot"><span class="annottext">killRange :: Name -&gt; Name
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var hs-var hs-var hs-var">killRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span id="local-6989586621681272632"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272632"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681272633"><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272633"><span class="hs-identifier hs-var">nis</span></a></span></span><span> </span><span id="local-6989586621681272634"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272634"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameInScope -&gt; NameParts -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-var">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KillRangeT Range
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272632"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272633"><span class="hs-identifier hs-var">nis</span></a></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272634"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span id="local-6989586621681272635"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272635"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681272636"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272636"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; NameId -&gt; Name
</span><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-var">NoName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KillRangeT Range
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621681272635"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272636"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-450"></span><span class="annot"><span class="hs-comment">-- * NFData instances</span></span><span>
</span><span id="line-451"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NameInScope"><span class="hs-identifier hs-type">NameInScope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>  </span><span id="local-6989586621681272640"><span class="annot"><span class="annottext">rnf :: NameInScope -&gt; ()
</span><a href="#local-6989586621681272640"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#InScope"><span class="hs-identifier hs-var">InScope</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="Agda.Syntax.Concrete.Name.html#NotInScope"><span class="hs-identifier hs-var">NotInScope</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><span class="hs-comment">-- | Ranges are not forced.</span></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>  </span><span id="local-6989586621681272651"><span class="annot"><span class="annottext">rnf :: Name -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272652"><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272652"><span class="hs-identifier hs-var">nis</span></a></span></span><span> </span><span id="local-6989586621681272653"><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272653"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameInScope -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NameInScope
</span><a href="#local-6989586621681272652"><span class="hs-identifier hs-var">nis</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">NameParts -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NameParts
</span><a href="#local-6989586621681272653"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NoName"><span class="hs-identifier hs-type">NoName</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681272654"><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272654"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NameId -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">NameId
</span><a href="#local-6989586621681272654"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#NamePart"><span class="hs-identifier hs-type">NamePart</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>  </span><span id="local-6989586621681272660"><span class="annot"><span class="annottext">rnf :: NamePart -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="annot"><span class="annottext">NamePart
</span><a href="Agda.Syntax.Concrete.Name.html#Hole"><span class="hs-identifier hs-var">Hole</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Id"><span class="hs-identifier hs-type">Id</span></a></span><span> </span><span id="local-6989586621681272661"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272661"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621681272661"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-468"></span><span>  </span><span id="local-6989586621681272667"><span class="annot"><span class="annottext">rnf :: QName -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#Qual"><span class="hs-identifier hs-type">Qual</span></a></span><span> </span><span id="local-6989586621681272668"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272668"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621681272669"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272669"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272668"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681272669"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Concrete.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span id="local-6989586621681272670"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272670"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><span class="hs-identifier hs-var">rnf</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621681272670"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-470"></span></pre></body></html>