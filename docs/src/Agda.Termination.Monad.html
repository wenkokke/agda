<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-comment">-- | The monad for the termination checker.</span><span>
</span><span id="line-3"></span><span class="hs-comment">--</span><span>
</span><span id="line-4"></span><span class="hs-comment">--   The termination monad @TerM@ is an extension of</span><span>
</span><span id="line-5"></span><span class="hs-comment">--   the type checking monad 'TCM' by an environment</span><span>
</span><span id="line-6"></span><span class="hs-comment">--   with information needed by the termination checker.</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.Termination.Monad</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">forM</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DList</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DL</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Base.html#optTerminationDepth"><span class="hs-identifier">optTerminationDepth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Pattern.html"><span class="hs-identifier">Agda.Syntax.Internal.Pattern</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html"><span class="hs-identifier">Agda.Syntax.Literal</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Termination.CutOff.html"><span class="hs-identifier">Agda.Termination.CutOff</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Termination.Order.html"><span class="hs-identifier">Agda.Termination.Order</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Order.html#Order"><span class="hs-identifier">Order</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Agda.Termination.Order.html#le"><span class="hs-identifier">le</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Agda.Termination.Order.html#unknown"><span class="hs-identifier">unknown</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Termination.RecCheck.html"><span class="hs-identifier">Agda.Termination.RecCheck</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.RecCheck.html#MutualNames"><span class="hs-identifier">MutualNames</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.RecCheck.html#anyDefs"><span class="hs-identifier">anyDefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Benchmark.html"><span class="hs-identifier">Agda.TypeChecking.Monad.Benchmark</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Records.html"><span class="hs-identifier">Agda.TypeChecking.Records</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Benchmark.html"><span class="hs-identifier">Agda.Utils.Benchmark</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.List.html#hasElem"><span class="hs-identifier">hasElem</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monoid.html"><span class="hs-identifier">Agda.Utils.Monoid</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier">Pretty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier">prettyShow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html"><span class="hs-identifier">Agda.Utils.VarSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier">VarSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html"><span class="hs-identifier">Agda.Utils.VarSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">VarSet</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="annot"><span class="hs-comment">-- | The target of the function we are checking.</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="Target"><span class="annot"><a href="Agda.Termination.Monad.html#Target"><span class="hs-identifier hs-var">Target</span></a></span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="TargetDef"><span class="annot"><a href="Agda.Termination.Monad.html#TargetDef"><span class="hs-identifier hs-var">TargetDef</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ The target of recursion is a @record@, @data@, or unreducible @Def@.</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TargetRecord"><span class="annot"><a href="Agda.Termination.Monad.html#TargetRecord"><span class="hs-identifier hs-var">TargetRecord</span></a></span></span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ We are termination-checking a record.</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TargetOther"><span class="annot"><a href="Agda.Termination.Monad.html#TargetOther"><span class="hs-identifier hs-var">TargetOther</span></a></span></span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ None of the above two or unknown.</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681515551"><span id="local-6989586621681515555"><span class="annot"><span class="annottext">Target -&gt; Target -&gt; Bool
(Target -&gt; Target -&gt; Bool)
-&gt; (Target -&gt; Target -&gt; Bool) -&gt; Eq Target
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Target -&gt; Target -&gt; Bool
== :: Target -&gt; Target -&gt; Bool
$c/= :: Target -&gt; Target -&gt; Bool
/= :: Target -&gt; Target -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515560"><span id="local-6989586621681515566"><span id="local-6989586621681515570"><span class="annot"><span class="annottext">Int -&gt; Target -&gt; ShowS
[Target] -&gt; ShowS
Target -&gt; String
(Int -&gt; Target -&gt; ShowS)
-&gt; (Target -&gt; String) -&gt; ([Target] -&gt; ShowS) -&gt; Show Target
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Target -&gt; ShowS
showsPrec :: Int -&gt; Target -&gt; ShowS
$cshow :: Target -&gt; String
show :: Target -&gt; String
$cshowList :: [Target] -&gt; ShowS
showList :: [Target] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="annot"><span class="hs-comment">-- | The current guardedness level.</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">type</span><span> </span><span id="Guarded"><span class="annot"><a href="Agda.Termination.Monad.html#Guarded"><span class="hs-identifier hs-var">Guarded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Termination.Order.html#Order"><span class="hs-identifier hs-type">Order</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><span class="hs-comment">-- | The termination environment.</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">data</span><span> </span><span id="TerEnv"><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-var">TerEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TerEnv"><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-var">TerEnv</span></a></span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">-- First part: options, configuration.</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="terUseDotPatterns"><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terUseDotPatterns"><span class="hs-identifier hs-var hs-var">terUseDotPatterns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Are we mining dot patterns to find evindence of structal descent?</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terSizeSuc"><span class="annot"><span class="annottext">TerEnv -&gt; Maybe QName
</span><a href="Agda.Termination.Monad.html#terSizeSuc"><span class="hs-identifier hs-var hs-var">terSizeSuc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The name of size successor, if any.</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terSharp"><span class="annot"><span class="annottext">TerEnv -&gt; Maybe QName
</span><a href="Agda.Termination.Monad.html#terSharp"><span class="hs-identifier hs-var hs-var">terSharp</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The name of the delay constructor (sharp), if any.</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terCutOff"><span class="annot"><span class="annottext">TerEnv -&gt; CutOff
</span><a href="Agda.Termination.Monad.html#terCutOff"><span class="hs-identifier hs-var hs-var">terCutOff</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.CutOff.html#CutOff"><span class="hs-identifier hs-type">CutOff</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Depth at which to cut off the structural order.</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-comment">-- Second part: accumulated info during descent into decls./term.</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terCurrent"><span class="annot"><span class="annottext">TerEnv -&gt; QName
</span><a href="Agda.Termination.Monad.html#terCurrent"><span class="hs-identifier hs-var hs-var">terCurrent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The name of the function we are currently checking.</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terMutual"><span class="annot"><span class="annottext">TerEnv -&gt; MutualNames
</span><a href="Agda.Termination.Monad.html#terMutual"><span class="hs-identifier hs-var hs-var">terMutual</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.RecCheck.html#MutualNames"><span class="hs-identifier hs-type">MutualNames</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">-- ^ The names of the functions in the mutual block we are checking.</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">--   This includes the internally generated functions</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">--   (with, extendedlambda, coinduction).</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terUserNames"><span class="annot"><span class="annottext">TerEnv -&gt; MutualNames
</span><a href="Agda.Termination.Monad.html#terUserNames"><span class="hs-identifier hs-var hs-var">terUserNames</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- ^ The list of name actually appearing in the file (abstract syntax).</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">--   Excludes the internally generated functions.</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terHaveInlinedWith"><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terHaveInlinedWith"><span class="hs-identifier hs-var hs-var">terHaveInlinedWith</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- ^ Does the actual clause result from with-inlining?</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">--   (If yes, it may be ill-typed.)</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terTarget"><span class="annot"><span class="annottext">TerEnv -&gt; Target
</span><a href="Agda.Termination.Monad.html#terTarget"><span class="hs-identifier hs-var hs-var">terTarget</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#Target"><span class="hs-identifier hs-type">Target</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- ^ Target type of the function we are currently termination checking.</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">--   Only the constructors of 'Target' are considered guarding.</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terMaskArgs"><span class="annot"><span class="annottext">TerEnv -&gt; [Bool]
</span><a href="Agda.Termination.Monad.html#terMaskArgs"><span class="hs-identifier hs-var hs-var">terMaskArgs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">-- ^ Only consider the 'notMasked' 'False' arguments for establishing termination.</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">--   See issue #1023.</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terMaskResult"><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terMaskResult"><span class="hs-identifier hs-var hs-var">terMaskResult</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Only consider guardedness if 'False' (not masked).</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_terSizeDepth"><span class="annot"><span class="annottext">TerEnv -&gt; Int
</span><a href="Agda.Termination.Monad.html#_terSizeDepth"><span class="hs-identifier hs-var hs-var">_terSizeDepth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>  </span><span class="hs-comment">-- lazy by intention!</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- ^ How many @SIZELT@ relations do we have in the context</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">--   (= clause telescope).  Used to approximate termination</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">--   for metas in call args.</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terPatterns"><span class="annot"><span class="annottext">TerEnv -&gt; MaskedDeBruijnPatterns
</span><a href="Agda.Termination.Monad.html#terPatterns"><span class="hs-identifier hs-var hs-var">terPatterns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#MaskedDeBruijnPatterns"><span class="hs-identifier hs-type">MaskedDeBruijnPatterns</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ The patterns of the clause we are checking.</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terPatternsRaise"><span class="annot"><span class="annottext">TerEnv -&gt; Int
</span><a href="Agda.Termination.Monad.html#terPatternsRaise"><span class="hs-identifier hs-var hs-var">terPatternsRaise</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">-- ^ Number of additional binders we have gone under</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">--   (and consequently need to raise the patterns to compare to terms).</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-comment">--   Updated during call graph extraction, hence strict.</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terGuarded"><span class="annot"><span class="annottext">TerEnv -&gt; Guarded
</span><a href="Agda.Termination.Monad.html#terGuarded"><span class="hs-identifier hs-var hs-var">terGuarded</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Agda.Termination.Monad.html#Guarded"><span class="hs-identifier hs-type">Guarded</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">-- ^ The current guardedness status.  Changes as we go deeper into the term.</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">--   Updated during call graph extraction, hence strict.</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terUseSizeLt"><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terUseSizeLt"><span class="hs-identifier hs-var hs-var">terUseSizeLt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- ^ When extracting usable size variables during construction of the call</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-comment">--   matrix, can we take the variable for use with SIZELT constraints from the context?</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-comment">--   Yes, if we are under an inductive constructor.</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-comment">--   No, if we are under a record constructor.</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-comment">--   (See issue #1015).</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="terUsableVars"><span class="annot"><span class="annottext">TerEnv -&gt; VarSet
</span><a href="Agda.Termination.Monad.html#terUsableVars"><span class="hs-identifier hs-var hs-var">terUsableVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ Pattern variables that can be compared to argument variables using SIZELT.</span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | An empty termination environment.</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">--   Values are set to a safe default meaning that with these</span><span>
</span><span id="line-139"></span><span class="hs-comment">--   initial values the termination checker will not miss</span><span>
</span><span id="line-140"></span><span class="hs-comment">--   termination errors it would have seen with better settings</span><span>
</span><span id="line-141"></span><span class="hs-comment">--   of these values.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">--   Values that do not have a safe default are set to</span><span>
</span><span id="line-144"></span><span class="hs-comment">--   @__IMPOSSIBLE__@.</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><a href="Agda.Termination.Monad.html#defaultTerEnv"><span class="hs-identifier hs-type">defaultTerEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span>
</span><span id="line-147"></span><span id="defaultTerEnv"><span class="annot"><span class="annottext">defaultTerEnv :: TerEnv
</span><a href="Agda.Termination.Monad.html#defaultTerEnv"><span class="hs-identifier hs-var hs-var">defaultTerEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">terUseDotPatterns :: Bool
</span><a href="Agda.Termination.Monad.html#terUseDotPatterns"><span class="hs-identifier hs-var">terUseDotPatterns</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- must be False initially!</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terSizeSuc :: Maybe QName
</span><a href="Agda.Termination.Monad.html#terSizeSuc"><span class="hs-identifier hs-var">terSizeSuc</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terSharp :: Maybe QName
</span><a href="Agda.Termination.Monad.html#terSharp"><span class="hs-identifier hs-var">terSharp</span></a></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terCutOff :: CutOff
</span><a href="Agda.Termination.Monad.html#terCutOff"><span class="hs-identifier hs-var">terCutOff</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CutOff
</span><a href="Agda.Termination.CutOff.html#defaultCutOff"><span class="hs-identifier hs-var">defaultCutOff</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terUserNames :: MutualNames
</span><a href="Agda.Termination.Monad.html#terUserNames"><span class="hs-identifier hs-var">terUserNames</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MutualNames
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- needs to be set!</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terMutual :: MutualNames
</span><a href="Agda.Termination.Monad.html#terMutual"><span class="hs-identifier hs-var">terMutual</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MutualNames
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- needs to be set!</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terCurrent :: QName
</span><a href="Agda.Termination.Monad.html#terCurrent"><span class="hs-identifier hs-var">terCurrent</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- needs to be set!</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terHaveInlinedWith :: Bool
</span><a href="Agda.Termination.Monad.html#terHaveInlinedWith"><span class="hs-identifier hs-var">terHaveInlinedWith</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terTarget :: Target
</span><a href="Agda.Termination.Monad.html#terTarget"><span class="hs-identifier hs-var">terTarget</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Target
</span><a href="Agda.Termination.Monad.html#TargetOther"><span class="hs-identifier hs-var">TargetOther</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terMaskArgs :: [Bool]
</span><a href="Agda.Termination.Monad.html#terMaskArgs"><span class="hs-identifier hs-var">terMaskArgs</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>   </span><span class="hs-comment">-- use all arguments (mask none)</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terMaskResult :: Bool
</span><a href="Agda.Termination.Monad.html#terMaskResult"><span class="hs-identifier hs-var">terMaskResult</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>          </span><span class="hs-comment">-- use result (do not mask)</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_terSizeDepth :: Int
</span><a href="Agda.Termination.Monad.html#_terSizeDepth"><span class="hs-identifier hs-var">_terSizeDepth</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- needs to be set!</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terPatterns :: MaskedDeBruijnPatterns
</span><a href="Agda.Termination.Monad.html#terPatterns"><span class="hs-identifier hs-var">terPatterns</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="hs-comment">-- needs to be set!</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terPatternsRaise :: Int
</span><a href="Agda.Termination.Monad.html#terPatternsRaise"><span class="hs-identifier hs-var">terPatternsRaise</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terGuarded :: Guarded
</span><a href="Agda.Termination.Monad.html#terGuarded"><span class="hs-identifier hs-var">terGuarded</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Guarded
</span><a href="Agda.Termination.Order.html#le"><span class="hs-identifier hs-var">le</span></a></span><span> </span><span class="hs-comment">-- not initially guarded</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terUseSizeLt :: Bool
</span><a href="Agda.Termination.Monad.html#terUseSizeLt"><span class="hs-identifier hs-var">terUseSizeLt</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-comment">-- initially, not under data constructor</span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">terUsableVars :: VarSet
</span><a href="Agda.Termination.Monad.html#terUsableVars"><span class="hs-identifier hs-var">terUsableVars</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarSet
</span><span class="hs-identifier hs-var">VarSet.empty</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><span class="hs-comment">-- | Termination monad service class.</span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621681514995"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621681514995"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadTer"><span class="annot"><a href="Agda.Termination.Monad.html#MonadTer"><span class="hs-identifier hs-var">MonadTer</span></a></span></span><span> </span><span id="local-6989586621681514995"><span class="annot"><a href="#local-6989586621681514995"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>  </span><span id="terAsk"><span class="annot"><a href="Agda.Termination.Monad.html#terAsk"><span class="hs-identifier hs-type">terAsk</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681514995"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="terLocal"><span class="annot"><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-type">terLocal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681515202"><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681514995"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515202"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681514995"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515202"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>  </span><span id="terAsks"><span class="annot"><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-type">terAsks</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681514996"><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681514996"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681514995"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681514996"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621681515603"><span class="annot"><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var hs-var">terAsks</span></a></span><span> </span><span id="local-6989586621681515607"><span class="annot"><span class="annottext">TerEnv -&gt; a
</span><a href="#local-6989586621681515607"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; a
</span><a href="#local-6989586621681515607"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; a) -&gt; m TerEnv -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m TerEnv
forall (m :: * -&gt; *). MonadTer m =&gt; m TerEnv
</span><a href="Agda.Termination.Monad.html#terAsk"><span class="hs-identifier hs-var">terAsk</span></a></span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><span class="hs-comment">-- | Termination monad.</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">newtype</span><span> </span><span id="TerM"><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span></span><span> </span><span id="local-6989586621681515001"><span class="annot"><a href="#local-6989586621681515001"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TerM"><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="terM"><span class="annot"><span class="annottext">forall a. TerM a -&gt; ReaderT TerEnv TCM a
</span><a href="Agda.Termination.Monad.html#terM"><span class="hs-identifier hs-var hs-var">terM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515001"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621681515612"><span id="local-6989586621681515618"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; TerM a -&gt; TerM b)
-&gt; (forall a b. a -&gt; TerM b -&gt; TerM a) -&gt; Functor TerM
forall a b. a -&gt; TerM b -&gt; TerM a
forall a b. (a -&gt; b) -&gt; TerM a -&gt; TerM b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; TerM a -&gt; TerM b
fmap :: forall a b. (a -&gt; b) -&gt; TerM a -&gt; TerM b
$c&lt;$ :: forall a b. a -&gt; TerM b -&gt; TerM a
&lt;$ :: forall a b. a -&gt; TerM b -&gt; TerM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span>
</span><span id="line-180"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515631"><span id="local-6989586621681515637"><span id="local-6989586621681515642"><span id="local-6989586621681515647"><span id="local-6989586621681515652"><span class="annot"><span class="annottext">Functor TerM
Functor TerM =&gt;
(forall a. a -&gt; TerM a)
-&gt; (forall a b. TerM (a -&gt; b) -&gt; TerM a -&gt; TerM b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; TerM a -&gt; TerM b -&gt; TerM c)
-&gt; (forall a b. TerM a -&gt; TerM b -&gt; TerM b)
-&gt; (forall a b. TerM a -&gt; TerM b -&gt; TerM a)
-&gt; Applicative TerM
forall a. a -&gt; TerM a
forall a b. TerM a -&gt; TerM b -&gt; TerM a
forall a b. TerM a -&gt; TerM b -&gt; TerM b
forall a b. TerM (a -&gt; b) -&gt; TerM a -&gt; TerM b
forall a b c. (a -&gt; b -&gt; c) -&gt; TerM a -&gt; TerM b -&gt; TerM c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; TerM a
pure :: forall a. a -&gt; TerM a
$c&lt;*&gt; :: forall a b. TerM (a -&gt; b) -&gt; TerM a -&gt; TerM b
&lt;*&gt; :: forall a b. TerM (a -&gt; b) -&gt; TerM a -&gt; TerM b
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; TerM a -&gt; TerM b -&gt; TerM c
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; TerM a -&gt; TerM b -&gt; TerM c
$c*&gt; :: forall a b. TerM a -&gt; TerM b -&gt; TerM b
*&gt; :: forall a b. TerM a -&gt; TerM b -&gt; TerM b
$c&lt;* :: forall a b. TerM a -&gt; TerM b -&gt; TerM a
&lt;* :: forall a b. TerM a -&gt; TerM b -&gt; TerM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span>
</span><span id="line-181"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515668"><span id="local-6989586621681515674"><span id="local-6989586621681515679"><span class="annot"><span class="annottext">Applicative TerM
Applicative TerM =&gt;
(forall a b. TerM a -&gt; (a -&gt; TerM b) -&gt; TerM b)
-&gt; (forall a b. TerM a -&gt; TerM b -&gt; TerM b)
-&gt; (forall a. a -&gt; TerM a)
-&gt; Monad TerM
forall a. a -&gt; TerM a
forall a b. TerM a -&gt; TerM b -&gt; TerM b
forall a b. TerM a -&gt; (a -&gt; TerM b) -&gt; TerM b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. TerM a -&gt; (a -&gt; TerM b) -&gt; TerM b
&gt;&gt;= :: forall a b. TerM a -&gt; (a -&gt; TerM b) -&gt; TerM b
$c&gt;&gt; :: forall a b. TerM a -&gt; TerM b -&gt; TerM b
&gt;&gt; :: forall a b. TerM a -&gt; TerM b -&gt; TerM b
$creturn :: forall a. a -&gt; TerM a
return :: forall a. a -&gt; TerM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span>
</span><span id="line-182"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515692"><span class="annot"><span class="annottext">Monad TerM
Monad TerM =&gt; (forall a. String -&gt; TerM a) -&gt; MonadFail TerM
forall a. String -&gt; TerM a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. String -&gt; m a) -&gt; MonadFail m
$cfail :: forall a. String -&gt; TerM a
fail :: forall a. String -&gt; TerM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">Fail.MonadFail</span></span></span><span>
</span><span id="line-183"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515705"><span id="local-6989586621681515711"><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCErr"><span class="hs-identifier hs-type">TCErr</span></a></span></span></span><span>
</span><span id="line-184"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515722"><span class="annot"><span class="annottext">ReadTCState TerM
String -&gt; (Integer -&gt; Integer) -&gt; TerM ()
ReadTCState TerM =&gt;
(String -&gt; (Integer -&gt; Integer) -&gt; TerM ()) -&gt; MonadStatistics TerM
forall (m :: * -&gt; *).
ReadTCState m =&gt;
(String -&gt; (Integer -&gt; Integer) -&gt; m ()) -&gt; MonadStatistics m
$cmodifyCounter :: String -&gt; (Integer -&gt; Integer) -&gt; TerM ()
modifyCounter :: String -&gt; (Integer -&gt; Integer) -&gt; TerM ()
</span><a href="Agda.TypeChecking.Monad.Statistics.html#MonadStatistics"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadStatistics</span></a></span></span><span>
</span><span id="line-185"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515737"><span id="local-6989586621681515743"><span class="annot"><span class="annottext">Monad TerM
Functor TerM
Applicative TerM
TerM PragmaOptions
TerM CommandLineOptions
(Functor TerM, Applicative TerM, Monad TerM) =&gt;
TerM PragmaOptions -&gt; TerM CommandLineOptions -&gt; HasOptions TerM
forall (m :: * -&gt; *).
(Functor m, Applicative m, Monad m) =&gt;
m PragmaOptions -&gt; m CommandLineOptions -&gt; HasOptions m
$cpragmaOptions :: TerM PragmaOptions
pragmaOptions :: TerM PragmaOptions
$ccommandLineOptions :: TerM CommandLineOptions
commandLineOptions :: TerM CommandLineOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#HasOptions"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">HasOptions</span></a></span></span></span><span>
</span><span id="line-186"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515759"><span class="annot"><span class="annottext">Functor TerM
MonadFail TerM
Applicative TerM
(Functor TerM, Applicative TerM, MonadFail TerM) =&gt;
(SomeBuiltin -&gt; TerM (Maybe (Builtin PrimFun))) -&gt; HasBuiltins TerM
SomeBuiltin -&gt; TerM (Maybe (Builtin PrimFun))
forall (m :: * -&gt; *).
(Functor m, Applicative m, MonadFail m) =&gt;
(SomeBuiltin -&gt; m (Maybe (Builtin PrimFun))) -&gt; HasBuiltins m
$cgetBuiltinThing :: SomeBuiltin -&gt; TerM (Maybe (Builtin PrimFun))
getBuiltinThing :: SomeBuiltin -&gt; TerM (Maybe (Builtin PrimFun))
</span><a href="Agda.TypeChecking.Monad.Builtin.html#HasBuiltins"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">HasBuiltins</span></a></span></span><span>
</span><span id="line-187"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515775"><span id="local-6989586621681515781"><span id="local-6989586621681515786"><span id="local-6989586621681515791"><span id="local-6989586621681515796"><span id="local-6989586621681515801"><span id="local-6989586621681515806"><span class="annot"><span class="annottext">Monad TerM
Functor TerM
Applicative TerM
TerM Bool
TerM Verbosity
TerM ProfileOptions
(Functor TerM, Applicative TerM, Monad TerM) =&gt;
(String -&gt; Int -&gt; TCM Doc -&gt; TerM String)
-&gt; (forall a. String -&gt; Int -&gt; String -&gt; TerM a -&gt; TerM a)
-&gt; (forall a. String -&gt; Int -&gt; String -&gt; TerM a -&gt; TerM a)
-&gt; TerM Verbosity
-&gt; TerM ProfileOptions
-&gt; TerM Bool
-&gt; (forall a. TerM a -&gt; TerM a)
-&gt; MonadDebug TerM
String -&gt; Int -&gt; TCM Doc -&gt; TerM String
forall a. String -&gt; Int -&gt; String -&gt; TerM a -&gt; TerM a
forall a. TerM a -&gt; TerM a
forall (m :: * -&gt; *).
(Functor m, Applicative m, Monad m) =&gt;
(String -&gt; Int -&gt; TCM Doc -&gt; m String)
-&gt; (forall a. String -&gt; Int -&gt; String -&gt; m a -&gt; m a)
-&gt; (forall a. String -&gt; Int -&gt; String -&gt; m a -&gt; m a)
-&gt; m Verbosity
-&gt; m ProfileOptions
-&gt; m Bool
-&gt; (forall a. m a -&gt; m a)
-&gt; MonadDebug m
$cformatDebugMessage :: String -&gt; Int -&gt; TCM Doc -&gt; TerM String
formatDebugMessage :: String -&gt; Int -&gt; TCM Doc -&gt; TerM String
$ctraceDebugMessage :: forall a. String -&gt; Int -&gt; String -&gt; TerM a -&gt; TerM a
traceDebugMessage :: forall a. String -&gt; Int -&gt; String -&gt; TerM a -&gt; TerM a
$cverboseBracket :: forall a. String -&gt; Int -&gt; String -&gt; TerM a -&gt; TerM a
verboseBracket :: forall a. String -&gt; Int -&gt; String -&gt; TerM a -&gt; TerM a
$cgetVerbosity :: TerM Verbosity
getVerbosity :: TerM Verbosity
$cgetProfileOptions :: TerM ProfileOptions
getProfileOptions :: TerM ProfileOptions
$cisDebugPrinting :: TerM Bool
isDebugPrinting :: TerM Bool
$cnowDebugPrinting :: forall a. TerM a -&gt; TerM a
nowDebugPrinting :: forall a. TerM a -&gt; TerM a
</span><a href="Agda.TypeChecking.Monad.Debug.html#MonadDebug"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadDebug</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-188"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515827"><span id="local-6989586621681515833"><span id="local-6989586621681515838"><span class="annot"><span class="annottext">Functor TerM
MonadFail TerM
Applicative TerM
HasOptions TerM
MonadTCEnv TerM
MonadDebug TerM
(Functor TerM, Applicative TerM, MonadFail TerM, HasOptions TerM,
 MonadDebug TerM, MonadTCEnv TerM) =&gt;
(QName -&gt; TerM Definition)
-&gt; (QName -&gt; TerM (Either SigError Definition))
-&gt; (QName -&gt; TerM RewriteRules)
-&gt; HasConstInfo TerM
QName -&gt; TerM RewriteRules
QName -&gt; TerM (Either SigError Definition)
QName -&gt; TerM Definition
forall (m :: * -&gt; *).
(Functor m, Applicative m, MonadFail m, HasOptions m, MonadDebug m,
 MonadTCEnv m) =&gt;
(QName -&gt; m Definition)
-&gt; (QName -&gt; m (Either SigError Definition))
-&gt; (QName -&gt; m RewriteRules)
-&gt; HasConstInfo m
$cgetConstInfo :: QName -&gt; TerM Definition
getConstInfo :: QName -&gt; TerM Definition
$cgetConstInfo' :: QName -&gt; TerM (Either SigError Definition)
getConstInfo' :: QName -&gt; TerM (Either SigError Definition)
$cgetRewriteRulesFor :: QName -&gt; TerM RewriteRules
getRewriteRulesFor :: QName -&gt; TerM RewriteRules
</span><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">HasConstInfo</span></a></span></span></span></span><span>
</span><span id="line-189"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515848"><span class="annot"><span class="annottext">Monad TerM
Monad TerM =&gt; (forall a. IO a -&gt; TerM a) -&gt; MonadIO TerM
forall a. IO a -&gt; TerM a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. IO a -&gt; m a) -&gt; MonadIO m
$cliftIO :: forall a. IO a -&gt; TerM a
liftIO :: forall a. IO a -&gt; TerM a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></span></span><span>
</span><span id="line-190"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515860"><span id="local-6989586621681515866"><span class="annot"><span class="annottext">Monad TerM
TerM TCEnv
Monad TerM =&gt;
TerM TCEnv
-&gt; (forall a. (TCEnv -&gt; TCEnv) -&gt; TerM a -&gt; TerM a)
-&gt; MonadTCEnv TerM
forall a. (TCEnv -&gt; TCEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *).
Monad m =&gt;
m TCEnv
-&gt; (forall a. (TCEnv -&gt; TCEnv) -&gt; m a -&gt; m a) -&gt; MonadTCEnv m
$caskTC :: TerM TCEnv
askTC :: TerM TCEnv
$clocalTC :: forall a. (TCEnv -&gt; TCEnv) -&gt; TerM a -&gt; TerM a
localTC :: forall a. (TCEnv -&gt; TCEnv) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.TypeChecking.Monad.Base.html#MonadTCEnv"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadTCEnv</span></a></span></span></span><span>
</span><span id="line-191"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515877"><span id="local-6989586621681515883"><span id="local-6989586621681515888"><span class="annot"><span class="annottext">Monad TerM
TerM TCState
Monad TerM =&gt;
TerM TCState
-&gt; (TCState -&gt; TerM ())
-&gt; ((TCState -&gt; TCState) -&gt; TerM ())
-&gt; MonadTCState TerM
TCState -&gt; TerM ()
(TCState -&gt; TCState) -&gt; TerM ()
forall (m :: * -&gt; *).
Monad m =&gt;
m TCState
-&gt; (TCState -&gt; m ())
-&gt; ((TCState -&gt; TCState) -&gt; m ())
-&gt; MonadTCState m
$cgetTC :: TerM TCState
getTC :: TerM TCState
$cputTC :: TCState -&gt; TerM ()
putTC :: TCState -&gt; TerM ()
$cmodifyTC :: (TCState -&gt; TCState) -&gt; TerM ()
modifyTC :: (TCState -&gt; TCState) -&gt; TerM ()
</span><a href="Agda.TypeChecking.Monad.Base.html#MonadTCState"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadTCState</span></a></span></span></span></span><span>
</span><span id="line-192"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515909"><span class="annot"><span class="annottext">Applicative TerM
MonadIO TerM
HasOptions TerM
MonadTCState TerM
MonadTCEnv TerM
(Applicative TerM, MonadIO TerM, MonadTCEnv TerM,
 MonadTCState TerM, HasOptions TerM) =&gt;
(forall a. TCM a -&gt; TerM a) -&gt; MonadTCM TerM
forall a. TCM a -&gt; TerM a
forall (tcm :: * -&gt; *).
(Applicative tcm, MonadIO tcm, MonadTCEnv tcm, MonadTCState tcm,
 HasOptions tcm) =&gt;
(forall a. TCM a -&gt; tcm a) -&gt; MonadTCM tcm
$cliftTCM :: forall a. TCM a -&gt; TerM a
liftTCM :: forall a. TCM a -&gt; TerM a
</span><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadTCM</span></a></span></span><span>
</span><span id="line-193"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515921"><span id="local-6989586621681515929"><span id="local-6989586621681515934"><span class="annot"><span class="annottext">Monad TerM
TerM TCState
Monad TerM =&gt;
TerM TCState
-&gt; (forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; TerM b -&gt; TerM b)
-&gt; (forall a. (TCState -&gt; TCState) -&gt; TerM a -&gt; TerM a)
-&gt; ReadTCState TerM
forall a. (TCState -&gt; TCState) -&gt; TerM a -&gt; TerM a
forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; TerM b -&gt; TerM b
forall (m :: * -&gt; *).
Monad m =&gt;
m TCState
-&gt; (forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; m b -&gt; m b)
-&gt; (forall a. (TCState -&gt; TCState) -&gt; m a -&gt; m a)
-&gt; ReadTCState m
$cgetTCState :: TerM TCState
getTCState :: TerM TCState
$clocallyTCState :: forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; TerM b -&gt; TerM b
locallyTCState :: forall a b. Lens' TCState a -&gt; (a -&gt; a) -&gt; TerM b -&gt; TerM b
$cwithTCState :: forall a. (TCState -&gt; TCState) -&gt; TerM a -&gt; TerM a
withTCState :: forall a. (TCState -&gt; TCState) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.TypeChecking.Monad.Base.html#ReadTCState"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ReadTCState</span></a></span></span></span></span><span>
</span><span id="line-194"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515952"><span class="annot"><span class="annottext">Applicative TerM
HasOptions TerM
MonadTCEnv TerM
ReadTCState TerM
(Applicative TerM, MonadTCEnv TerM, ReadTCState TerM,
 HasOptions TerM) =&gt;
(forall a. ReduceM a -&gt; TerM a) -&gt; MonadReduce TerM
forall a. ReduceM a -&gt; TerM a
forall (m :: * -&gt; *).
(Applicative m, MonadTCEnv m, ReadTCState m, HasOptions m) =&gt;
(forall a. ReduceM a -&gt; m a) -&gt; MonadReduce m
$cliftReduce :: forall a. ReduceM a -&gt; TerM a
liftReduce :: forall a. ReduceM a -&gt; TerM a
</span><a href="Agda.TypeChecking.Monad.Base.html#MonadReduce"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadReduce</span></a></span></span><span>
</span><span id="line-195"></span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621681515964"><span id="local-6989586621681515970"><span id="local-6989586621681515975"><span id="local-6989586621681515980"><span class="annot"><span class="annottext">MonadTCEnv TerM
MonadTCEnv TerM =&gt;
(forall a. Name -&gt; Dom Type -&gt; TerM a -&gt; TerM a)
-&gt; (forall a.
    Origin -&gt; Name -&gt; Term -&gt; Dom Type -&gt; TerM a -&gt; TerM a)
-&gt; (forall a.
    Substitution -&gt; (Context -&gt; Context) -&gt; TerM a -&gt; TerM a)
-&gt; (forall a. Range -&gt; String -&gt; (Name -&gt; TerM a) -&gt; TerM a)
-&gt; MonadAddContext TerM
forall a. Range -&gt; String -&gt; (Name -&gt; TerM a) -&gt; TerM a
forall a. Origin -&gt; Name -&gt; Term -&gt; Dom Type -&gt; TerM a -&gt; TerM a
forall a. Name -&gt; Dom Type -&gt; TerM a -&gt; TerM a
forall a. Substitution -&gt; (Context -&gt; Context) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *).
MonadTCEnv m =&gt;
(forall a. Name -&gt; Dom Type -&gt; m a -&gt; m a)
-&gt; (forall a. Origin -&gt; Name -&gt; Term -&gt; Dom Type -&gt; m a -&gt; m a)
-&gt; (forall a. Substitution -&gt; (Context -&gt; Context) -&gt; m a -&gt; m a)
-&gt; (forall a. Range -&gt; String -&gt; (Name -&gt; m a) -&gt; m a)
-&gt; MonadAddContext m
$caddCtx :: forall a. Name -&gt; Dom Type -&gt; TerM a -&gt; TerM a
addCtx :: forall a. Name -&gt; Dom Type -&gt; TerM a -&gt; TerM a
$caddLetBinding' :: forall a. Origin -&gt; Name -&gt; Term -&gt; Dom Type -&gt; TerM a -&gt; TerM a
addLetBinding' :: forall a. Origin -&gt; Name -&gt; Term -&gt; Dom Type -&gt; TerM a -&gt; TerM a
$cupdateContext :: forall a. Substitution -&gt; (Context -&gt; Context) -&gt; TerM a -&gt; TerM a
updateContext :: forall a. Substitution -&gt; (Context -&gt; Context) -&gt; TerM a -&gt; TerM a
$cwithFreshName :: forall a. Range -&gt; String -&gt; (Name -&gt; TerM a) -&gt; TerM a
withFreshName :: forall a. Range -&gt; String -&gt; (Name -&gt; TerM a) -&gt; TerM a
</span><a href="Agda.TypeChecking.Monad.Context.html#MonadAddContext"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">MonadAddContext</span></a></span></span></span></span></span><span>
</span><span id="line-196"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MonadTCEnv TerM
MonadReduce TerM
ReadTCState TerM
HasBuiltins TerM
MonadAddContext TerM
MonadDebug TerM
HasConstInfo TerM
(HasBuiltins TerM, HasConstInfo TerM, MonadAddContext TerM,
 MonadDebug TerM, MonadReduce TerM, MonadTCEnv TerM,
 ReadTCState TerM) =&gt;
PureTCM TerM
forall (m :: * -&gt; *).
(HasBuiltins m, HasConstInfo m, MonadAddContext m, MonadDebug m,
 MonadReduce m, MonadTCEnv m, ReadTCState m) =&gt;
PureTCM m
</span><a href="Agda.TypeChecking.Monad.Pure.html#PureTCM"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">PureTCM</span></a></span><span>
</span><span id="line-197"></span><span>           </span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- This could be derived automatically, but the derived type family becomes `BenchPhase (ReaderT TerEnv TCM)` which</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- is *fine* but triggers complaints that the &quot;type family application is no smaller than the instance head, why not</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- nuke everything with UndecidableInstances&quot;.</span><span>
</span><span id="line-202"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Utils.Benchmark.html#MonadBench"><span class="hs-identifier hs-type">MonadBench</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="BenchPhase"><span class="annot"><a href="Agda.Utils.Benchmark.html#BenchPhase"><span class="hs-identifier hs-var">BenchPhase</span></a></span></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Benchmarking.html#Phase"><span class="hs-identifier hs-type">Phase</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621681516021"><span class="annot"><span class="annottext">getBenchmark :: TerM (Benchmark (BenchPhase TerM))
</span><a href="#local-6989586621681516021"><span class="hs-identifier hs-var hs-var hs-var hs-var">getBenchmark</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM (Benchmark (BenchPhase TerM))
-&gt; TerM (Benchmark (BenchPhase TerM))
forall a. ReaderT TerEnv TCM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT TerEnv TCM (Benchmark (BenchPhase TerM))
 -&gt; TerM (Benchmark (BenchPhase TerM)))
-&gt; ReaderT TerEnv TCM (Benchmark (BenchPhase TerM))
-&gt; TerM (Benchmark (BenchPhase TerM))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM (Benchmark (BenchPhase (ReaderT TerEnv TCM)))
ReaderT TerEnv TCM (Benchmark (BenchPhase TerM))
forall (m :: * -&gt; *). MonadBench m =&gt; m (Benchmark (BenchPhase m))
</span><a href="Agda.Utils.Benchmark.html#getBenchmark"><span class="hs-identifier hs-var">B.getBenchmark</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621681516025"><span class="annot"><span class="annottext">putBenchmark :: Benchmark (BenchPhase TerM) -&gt; TerM ()
</span><a href="#local-6989586621681516025"><span class="hs-identifier hs-var hs-var hs-var hs-var">putBenchmark</span></a></span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM () -&gt; TerM ()
forall a. ReaderT TerEnv TCM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT TerEnv TCM () -&gt; TerM ())
-&gt; (Benchmark Phase -&gt; ReaderT TerEnv TCM ())
-&gt; Benchmark Phase
-&gt; TerM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Benchmark (BenchPhase (ReaderT TerEnv TCM))
-&gt; ReaderT TerEnv TCM ()
Benchmark Phase -&gt; ReaderT TerEnv TCM ()
forall (m :: * -&gt; *).
MonadBench m =&gt;
Benchmark (BenchPhase m) -&gt; m ()
</span><a href="Agda.Utils.Benchmark.html#putBenchmark"><span class="hs-identifier hs-var">B.putBenchmark</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span id="local-6989586621681516030"><span class="annot"><span class="annottext">modifyBenchmark :: (Benchmark (BenchPhase TerM) -&gt; Benchmark (BenchPhase TerM))
-&gt; TerM ()
</span><a href="#local-6989586621681516030"><span class="hs-identifier hs-var hs-var hs-var hs-var">modifyBenchmark</span></a></span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM () -&gt; TerM ()
forall a. ReaderT TerEnv TCM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT TerEnv TCM () -&gt; TerM ())
-&gt; ((Benchmark Phase -&gt; Benchmark Phase) -&gt; ReaderT TerEnv TCM ())
-&gt; (Benchmark Phase -&gt; Benchmark Phase)
-&gt; TerM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Benchmark (BenchPhase (ReaderT TerEnv TCM))
 -&gt; Benchmark (BenchPhase (ReaderT TerEnv TCM)))
-&gt; ReaderT TerEnv TCM ()
(Benchmark Phase -&gt; Benchmark Phase) -&gt; ReaderT TerEnv TCM ()
forall (m :: * -&gt; *).
MonadBench m =&gt;
(Benchmark (BenchPhase m) -&gt; Benchmark (BenchPhase m)) -&gt; m ()
</span><a href="Agda.Utils.Benchmark.html#modifyBenchmark"><span class="hs-identifier hs-var">B.modifyBenchmark</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621681516034"><span class="annot"><span class="annottext">finally :: forall a b. TerM a -&gt; TerM b -&gt; TerM a
</span><a href="#local-6989586621681516034"><span class="hs-identifier hs-var hs-var hs-var hs-var">finally</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span id="local-6989586621681516036"><span class="annot"><span class="annottext">ReaderT TerEnv TCM b
</span><a href="#local-6989586621681516036"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span id="local-6989586621681516037"><span class="annot"><span class="annottext">ReaderT TerEnv TCM c
</span><a href="#local-6989586621681516037"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM b -&gt; TerM b
forall a. ReaderT TerEnv TCM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT TerEnv TCM b -&gt; TerM b) -&gt; ReaderT TerEnv TCM b -&gt; TerM b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT TerEnv TCM b
-&gt; ReaderT TerEnv TCM c -&gt; ReaderT TerEnv TCM b
forall b c.
ReaderT TerEnv TCM b
-&gt; ReaderT TerEnv TCM c -&gt; ReaderT TerEnv TCM b
forall (m :: * -&gt; *) b c. MonadBench m =&gt; m b -&gt; m c -&gt; m b
</span><a href="Agda.Utils.Benchmark.html#finally"><span class="hs-identifier hs-var">B.finally</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM b
</span><a href="#local-6989586621681516036"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM c
</span><a href="#local-6989586621681516037"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681516045"><span class="annot"><a href="Agda.Termination.Monad.html#MonadTer"><span class="hs-identifier hs-type">MonadTer</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621681516052"><span class="annot"><span class="annottext">terAsk :: TerM TerEnv
</span><a href="Agda.Termination.Monad.html#terAsk"><span class="hs-identifier hs-var hs-var hs-var hs-var">terAsk</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM TerEnv -&gt; TerM TerEnv
forall a. ReaderT TerEnv TCM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT TerEnv TCM TerEnv -&gt; TerM TerEnv)
-&gt; ReaderT TerEnv TCM TerEnv -&gt; TerM TerEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM TerEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621681516057"><span class="annot"><span class="annottext">terLocal :: forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var hs-var hs-var hs-var">terLocal</span></a></span></span><span> </span><span id="local-6989586621681516058"><span class="annot"><span class="annottext">TerEnv -&gt; TerEnv
</span><a href="#local-6989586621681516058"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM a -&gt; TerM a
forall a. ReaderT TerEnv TCM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-var">TerM</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT TerEnv TCM a -&gt; TerM a)
-&gt; (TerM a -&gt; ReaderT TerEnv TCM a) -&gt; TerM a -&gt; TerM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; ReaderT TerEnv TCM a -&gt; ReaderT TerEnv TCM a
forall a.
(TerEnv -&gt; TerEnv) -&gt; ReaderT TerEnv TCM a -&gt; ReaderT TerEnv TCM a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; TerEnv
</span><a href="#local-6989586621681516058"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT TerEnv TCM a -&gt; ReaderT TerEnv TCM a)
-&gt; (TerM a -&gt; ReaderT TerEnv TCM a)
-&gt; TerM a
-&gt; ReaderT TerEnv TCM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TerM a -&gt; ReaderT TerEnv TCM a
forall a. TerM a -&gt; ReaderT TerEnv TCM a
</span><a href="Agda.Termination.Monad.html#terM"><span class="hs-identifier hs-var">terM</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | Generic run method for termination monad.</span></span><span>
</span><span id="line-214"></span><span id="local-6989586621681515210"><span class="annot"><a href="Agda.Termination.Monad.html#runTer"><span class="hs-identifier hs-type">runTer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515210"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515210"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-215"></span><span id="runTer"><span class="annot"><span class="annottext">runTer :: forall a. TerEnv -&gt; TerM a -&gt; TCM a
</span><a href="Agda.Termination.Monad.html#runTer"><span class="hs-identifier hs-var hs-var">runTer</span></a></span></span><span> </span><span id="local-6989586621681516061"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516061"><span class="hs-identifier hs-var">tenv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span id="local-6989586621681516062"><span class="annot"><span class="annottext">ReaderT TerEnv TCM a
</span><a href="#local-6989586621681516062"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM a -&gt; TerEnv -&gt; TCMT IO a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT TerEnv TCM a
</span><a href="#local-6989586621681516062"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516061"><span class="hs-identifier hs-var">tenv</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="annot"><span class="hs-comment">-- | Run TerM computation in default environment (created from options).</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span id="local-6989586621681515215"><span class="annot"><a href="Agda.Termination.Monad.html#runTerDefault"><span class="hs-identifier hs-type">runTerDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515215"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515215"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-220"></span><span id="runTerDefault"><span class="annot"><span class="annottext">runTerDefault :: forall a. TerM a -&gt; TCM a
</span><a href="Agda.Termination.Monad.html#runTerDefault"><span class="hs-identifier hs-var hs-var">runTerDefault</span></a></span></span><span> </span><span id="local-6989586621681516078"><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516078"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">-- Assemble then initial configuration of the termination environment.</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621681516079"><span class="annot"><span class="annottext">CutOff
</span><a href="#local-6989586621681516079"><span class="hs-identifier hs-var">cutoff</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; CutOff
</span><a href="Agda.Interaction.Options.Base.html#optTerminationDepth"><span class="hs-identifier hs-var">optTerminationDepth</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; CutOff)
-&gt; TCMT IO PragmaOptions -&gt; TCMT IO CutOff
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- Get the name of size suc (if sized types are enabled)</span><span>
</span><span id="line-227"></span><span>  </span><span id="local-6989586621681516081"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681516081"><span class="hs-identifier hs-var">suc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, HasOptions m) =&gt;
m (Maybe QName)
</span><a href="Agda.TypeChecking.Monad.SizedTypes.html#sizeSucName"><span class="hs-identifier hs-var">sizeSucName</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-comment">-- The name of sharp (if available).</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621681516083"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681516083"><span class="hs-identifier hs-var">sharp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoinductionKit -&gt; QName) -&gt; Maybe CoinductionKit -&gt; Maybe QName
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">CoinductionKit -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Builtin.html#nameOfSharp"><span class="hs-identifier hs-var">nameOfSharp</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe CoinductionKit -&gt; Maybe QName)
-&gt; TCMT IO (Maybe CoinductionKit) -&gt; TCMT IO (Maybe QName)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe CoinductionKit)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#coinductionKit"><span class="hs-identifier hs-var">coinductionKit</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681516086"><span class="annot"><span class="annottext">tenv :: TerEnv
</span><a href="#local-6989586621681516086"><span class="hs-identifier hs-var hs-var">tenv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="Agda.Termination.Monad.html#defaultTerEnv"><span class="hs-identifier hs-var">defaultTerEnv</span></a></span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terSizeSuc"><span class="hs-identifier hs-var">terSizeSuc</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516081"><span class="hs-identifier hs-type">suc</span></a></span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terSharp"><span class="hs-identifier hs-var">terSharp</span></a></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516083"><span class="hs-identifier hs-type">sharp</span></a></span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terCutOff"><span class="hs-identifier hs-var">terCutOff</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516079"><span class="hs-identifier hs-type">cutoff</span></a></span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><span class="annottext">TerEnv -&gt; TerM a -&gt; TCM a
forall a. TerEnv -&gt; TerM a -&gt; TCM a
</span><a href="Agda.Termination.Monad.html#runTer"><span class="hs-identifier hs-var">runTer</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516086"><span class="hs-identifier hs-var">tenv</span></a></span><span> </span><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516078"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- -- * Termination monad is a 'MonadTCM'.</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- instance MonadError TCErr TerM where</span><span>
</span><span id="line-243"></span><span class="hs-comment">--   throwError = liftTCM . throwError</span><span>
</span><span id="line-244"></span><span class="hs-comment">--   catchError m handler = TerM $ ReaderT $ \ tenv -&gt; do</span><span>
</span><span id="line-245"></span><span class="hs-comment">--     runTer tenv m `catchError` (\ err -&gt; runTer tenv $ handler err)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681515223"><span id="local-6989586621681516090"><span id="local-6989586621681516094"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681515223"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515223"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621681516101"><span class="annot"><span class="annottext">&lt;&gt; :: TerM m -&gt; TerM m -&gt; TerM m
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m -&gt; m -&gt; m) -&gt; TerM m -&gt; TerM m -&gt; TerM m
forall a b c. (a -&gt; b -&gt; c) -&gt; TerM a -&gt; TerM b -&gt; TerM c
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681515226"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621681515226"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621681515226"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515226"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621681516114"><span class="annot"><span class="annottext">mempty :: TerM m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; TerM m
forall a. a -&gt; TerM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621681516116"><span class="annot"><span class="annottext">mappend :: TerM m -&gt; TerM m -&gt; TerM m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TerM m -&gt; TerM m -&gt; TerM m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621681516122"><span class="annot"><span class="annottext">mconcat :: [TerM m] -&gt; TerM m
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mconcat</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[m] -&gt; m
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([m] -&gt; m) -&gt; ([TerM m] -&gt; TerM [m]) -&gt; [TerM m] -&gt; TerM m
forall (m :: * -&gt; *) b c a.
Functor m =&gt;
(b -&gt; c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="Agda.Utils.Functor.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TerM m] -&gt; TerM [m]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-comment">-- * Modifiers and accessors for the termination environment in the monad.</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetUseDotPatterns"><span class="hs-identifier hs-type">terGetUseDotPatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-258"></span><span id="terGetUseDotPatterns"><span class="annot"><span class="annottext">terGetUseDotPatterns :: TerM Bool
</span><a href="Agda.Termination.Monad.html#terGetUseDotPatterns"><span class="hs-identifier hs-var hs-var">terGetUseDotPatterns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Bool) -&gt; TerM Bool
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terUseDotPatterns"><span class="hs-identifier hs-var">terUseDotPatterns</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span id="local-6989586621681515234"><span class="annot"><a href="Agda.Termination.Monad.html#terSetUseDotPatterns"><span class="hs-identifier hs-type">terSetUseDotPatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515234"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515234"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-261"></span><span id="terSetUseDotPatterns"><span class="annot"><span class="annottext">terSetUseDotPatterns :: forall a. Bool -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetUseDotPatterns"><span class="hs-identifier hs-var hs-var">terSetUseDotPatterns</span></a></span></span><span> </span><span id="local-6989586621681516128"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516128"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516129"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516129"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516129"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terUseDotPatterns"><span class="hs-identifier hs-var">terUseDotPatterns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516128"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetSizeSuc"><span class="hs-identifier hs-type">terGetSizeSuc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span id="terGetSizeSuc"><span class="annot"><span class="annottext">terGetSizeSuc :: TerM (Maybe QName)
</span><a href="Agda.Termination.Monad.html#terGetSizeSuc"><span class="hs-identifier hs-var hs-var">terGetSizeSuc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Maybe QName) -&gt; TerM (Maybe QName)
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Maybe QName
</span><a href="Agda.Termination.Monad.html#terSizeSuc"><span class="hs-identifier hs-var">terSizeSuc</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetCurrent"><span class="hs-identifier hs-type">terGetCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-267"></span><span id="terGetCurrent"><span class="annot"><span class="annottext">terGetCurrent :: TerM QName
</span><a href="Agda.Termination.Monad.html#terGetCurrent"><span class="hs-identifier hs-var hs-var">terGetCurrent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; QName) -&gt; TerM QName
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; QName
</span><a href="Agda.Termination.Monad.html#terCurrent"><span class="hs-identifier hs-var">terCurrent</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span id="local-6989586621681515236"><span class="annot"><a href="Agda.Termination.Monad.html#terSetCurrent"><span class="hs-identifier hs-type">terSetCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515236"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-270"></span><span id="terSetCurrent"><span class="annot"><span class="annottext">terSetCurrent :: forall a. QName -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetCurrent"><span class="hs-identifier hs-var hs-var">terSetCurrent</span></a></span></span><span> </span><span id="local-6989586621681516134"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516134"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516135"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516135"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516135"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terCurrent"><span class="hs-identifier hs-var">terCurrent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516134"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetSharp"><span class="hs-identifier hs-type">terGetSharp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span id="terGetSharp"><span class="annot"><span class="annottext">terGetSharp :: TerM (Maybe QName)
</span><a href="Agda.Termination.Monad.html#terGetSharp"><span class="hs-identifier hs-var hs-var">terGetSharp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Maybe QName) -&gt; TerM (Maybe QName)
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Maybe QName
</span><a href="Agda.Termination.Monad.html#terSharp"><span class="hs-identifier hs-var">terSharp</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetCutOff"><span class="hs-identifier hs-type">terGetCutOff</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.CutOff.html#CutOff"><span class="hs-identifier hs-type">CutOff</span></a></span><span>
</span><span id="line-276"></span><span id="terGetCutOff"><span class="annot"><span class="annottext">terGetCutOff :: TerM CutOff
</span><a href="Agda.Termination.Monad.html#terGetCutOff"><span class="hs-identifier hs-var hs-var">terGetCutOff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; CutOff) -&gt; TerM CutOff
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; CutOff
</span><a href="Agda.Termination.Monad.html#terCutOff"><span class="hs-identifier hs-var">terCutOff</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetMutual"><span class="hs-identifier hs-type">terGetMutual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.RecCheck.html#MutualNames"><span class="hs-identifier hs-type">MutualNames</span></a></span><span>
</span><span id="line-279"></span><span id="terGetMutual"><span class="annot"><span class="annottext">terGetMutual :: TerM MutualNames
</span><a href="Agda.Termination.Monad.html#terGetMutual"><span class="hs-identifier hs-var hs-var">terGetMutual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; MutualNames) -&gt; TerM MutualNames
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; MutualNames
</span><a href="Agda.Termination.Monad.html#terMutual"><span class="hs-identifier hs-var">terMutual</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetUserNames"><span class="hs-identifier hs-type">terGetUserNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span id="terGetUserNames"><span class="annot"><span class="annottext">terGetUserNames :: TerM MutualNames
</span><a href="Agda.Termination.Monad.html#terGetUserNames"><span class="hs-identifier hs-var hs-var">terGetUserNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; MutualNames) -&gt; TerM MutualNames
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; MutualNames
</span><a href="Agda.Termination.Monad.html#terUserNames"><span class="hs-identifier hs-var">terUserNames</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetTarget"><span class="hs-identifier hs-type">terGetTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#Target"><span class="hs-identifier hs-type">Target</span></a></span><span>
</span><span id="line-285"></span><span id="terGetTarget"><span class="annot"><span class="annottext">terGetTarget :: TerM Target
</span><a href="Agda.Termination.Monad.html#terGetTarget"><span class="hs-identifier hs-var hs-var">terGetTarget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Target) -&gt; TerM Target
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Target
</span><a href="Agda.Termination.Monad.html#terTarget"><span class="hs-identifier hs-var">terTarget</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span id="local-6989586621681515238"><span class="annot"><a href="Agda.Termination.Monad.html#terSetTarget"><span class="hs-identifier hs-type">terSetTarget</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#Target"><span class="hs-identifier hs-type">Target</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515238"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-288"></span><span id="terSetTarget"><span class="annot"><span class="annottext">terSetTarget :: forall a. Target -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetTarget"><span class="hs-identifier hs-var hs-var">terSetTarget</span></a></span></span><span> </span><span id="local-6989586621681516143"><span class="annot"><span class="annottext">Target
</span><a href="#local-6989586621681516143"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516144"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516144"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516144"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terTarget"><span class="hs-identifier hs-var">terTarget</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516143"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetHaveInlinedWith"><span class="hs-identifier hs-type">terGetHaveInlinedWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-291"></span><span id="terGetHaveInlinedWith"><span class="annot"><span class="annottext">terGetHaveInlinedWith :: TerM Bool
</span><a href="Agda.Termination.Monad.html#terGetHaveInlinedWith"><span class="hs-identifier hs-var hs-var">terGetHaveInlinedWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Bool) -&gt; TerM Bool
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terHaveInlinedWith"><span class="hs-identifier hs-var">terHaveInlinedWith</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621681516146"><span class="annot"><a href="Agda.Termination.Monad.html#terSetHaveInlinedWith"><span class="hs-identifier hs-type">terSetHaveInlinedWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516146"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516146"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-294"></span><span id="terSetHaveInlinedWith"><span class="annot"><span class="annottext">terSetHaveInlinedWith :: forall a. TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetHaveInlinedWith"><span class="hs-identifier hs-var hs-var">terSetHaveInlinedWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516149"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516149"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516149"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terHaveInlinedWith"><span class="hs-identifier hs-var">terHaveInlinedWith</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetMaskArgs"><span class="hs-identifier hs-type">terGetMaskArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span>
</span><span id="line-297"></span><span id="terGetMaskArgs"><span class="annot"><span class="annottext">terGetMaskArgs :: TerM [Bool]
</span><a href="Agda.Termination.Monad.html#terGetMaskArgs"><span class="hs-identifier hs-var hs-var">terGetMaskArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; [Bool]) -&gt; TerM [Bool]
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; [Bool]
</span><a href="Agda.Termination.Monad.html#terMaskArgs"><span class="hs-identifier hs-var">terMaskArgs</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span id="local-6989586621681515241"><span class="annot"><a href="Agda.Termination.Monad.html#terSetMaskArgs"><span class="hs-identifier hs-type">terSetMaskArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515241"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515241"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-300"></span><span id="terSetMaskArgs"><span class="annot"><span class="annottext">terSetMaskArgs :: forall a. [Bool] -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetMaskArgs"><span class="hs-identifier hs-var hs-var">terSetMaskArgs</span></a></span></span><span> </span><span id="local-6989586621681516153"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621681516153"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516154"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516154"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516154"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terMaskArgs"><span class="hs-identifier hs-var">terMaskArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516153"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetMaskResult"><span class="hs-identifier hs-type">terGetMaskResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-303"></span><span id="terGetMaskResult"><span class="annot"><span class="annottext">terGetMaskResult :: TerM Bool
</span><a href="Agda.Termination.Monad.html#terGetMaskResult"><span class="hs-identifier hs-var hs-var">terGetMaskResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Bool) -&gt; TerM Bool
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terMaskResult"><span class="hs-identifier hs-var">terMaskResult</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span id="local-6989586621681516156"><span class="annot"><a href="Agda.Termination.Monad.html#terSetMaskResult"><span class="hs-identifier hs-type">terSetMaskResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516156"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516156"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-306"></span><span id="terSetMaskResult"><span class="annot"><span class="annottext">terSetMaskResult :: forall a. Bool -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetMaskResult"><span class="hs-identifier hs-var hs-var">terSetMaskResult</span></a></span></span><span> </span><span id="local-6989586621681516159"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516159"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516160"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516160"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516160"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terMaskResult"><span class="hs-identifier hs-var">terMaskResult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516159"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetPatterns"><span class="hs-identifier hs-type">terGetPatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#MaskedDeBruijnPatterns"><span class="hs-identifier hs-type">MaskedDeBruijnPatterns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span id="terGetPatterns"><span class="annot"><span class="annottext">terGetPatterns :: TerM MaskedDeBruijnPatterns
</span><a href="Agda.Termination.Monad.html#terGetPatterns"><span class="hs-identifier hs-var hs-var">terGetPatterns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621681516162"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516162"><span class="hs-identifier hs-var">n</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Int) -&gt; TerM Int
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Int
</span><a href="Agda.Termination.Monad.html#terPatternsRaise"><span class="hs-identifier hs-var">terPatternsRaise</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span id="local-6989586621681516163"><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516163"><span class="hs-identifier hs-var">mps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; MaskedDeBruijnPatterns) -&gt; TerM MaskedDeBruijnPatterns
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; MaskedDeBruijnPatterns
</span><a href="Agda.Termination.Monad.html#terPatterns"><span class="hs-identifier hs-var">terPatterns</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns -&gt; TerM MaskedDeBruijnPatterns
forall a. a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MaskedDeBruijnPatterns -&gt; TerM MaskedDeBruijnPatterns)
-&gt; MaskedDeBruijnPatterns -&gt; TerM MaskedDeBruijnPatterns
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516162"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516163"><span class="hs-identifier hs-var">mps</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Masked DeBruijnPattern -&gt; Masked DeBruijnPattern)
-&gt; MaskedDeBruijnPatterns -&gt; MaskedDeBruijnPatterns
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DeBruijnPattern -&gt; DeBruijnPattern)
-&gt; Masked DeBruijnPattern -&gt; Masked DeBruijnPattern
forall a b. (a -&gt; b) -&gt; Masked a -&gt; Masked b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DeBruijnPattern -&gt; DeBruijnPattern
forall a. Subst a =&gt; Int -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516162"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516163"><span class="hs-identifier hs-var">mps</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span id="local-6989586621681515247"><span class="annot"><a href="Agda.Termination.Monad.html#terSetPatterns"><span class="hs-identifier hs-type">terSetPatterns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#MaskedDeBruijnPatterns"><span class="hs-identifier hs-type">MaskedDeBruijnPatterns</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515247"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-315"></span><span id="terSetPatterns"><span class="annot"><span class="annottext">terSetPatterns :: forall a. MaskedDeBruijnPatterns -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetPatterns"><span class="hs-identifier hs-var hs-var">terSetPatterns</span></a></span></span><span> </span><span id="local-6989586621681516167"><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516167"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516168"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516168"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516168"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terPatterns"><span class="hs-identifier hs-var">terPatterns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516167"><span class="hs-identifier hs-type">ps</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span id="local-6989586621681516169"><span class="annot"><a href="Agda.Termination.Monad.html#terRaise"><span class="hs-identifier hs-type">terRaise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516169"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-318"></span><span id="terRaise"><span class="annot"><span class="annottext">terRaise :: forall a. TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terRaise"><span class="hs-identifier hs-var hs-var">terRaise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516174"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516174"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516174"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terPatternsRaise"><span class="hs-identifier hs-var">terPatternsRaise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terPatternsRaise"><span class="hs-identifier hs-var">terPatternsRaise</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516174"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetGuarded"><span class="hs-identifier hs-type">terGetGuarded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#Guarded"><span class="hs-identifier hs-type">Guarded</span></a></span><span>
</span><span id="line-321"></span><span id="terGetGuarded"><span class="annot"><span class="annottext">terGetGuarded :: TerM Guarded
</span><a href="Agda.Termination.Monad.html#terGetGuarded"><span class="hs-identifier hs-var hs-var">terGetGuarded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Guarded) -&gt; TerM Guarded
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Guarded
</span><a href="Agda.Termination.Monad.html#terGuarded"><span class="hs-identifier hs-var">terGuarded</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621681515251"><span class="annot"><a href="Agda.Termination.Monad.html#terModifyGuarded"><span class="hs-identifier hs-type">terModifyGuarded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Order.html#Order"><span class="hs-identifier hs-type">Order</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Order.html#Order"><span class="hs-identifier hs-type">Order</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515251"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515251"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-324"></span><span id="terModifyGuarded"><span class="annot"><span class="annottext">terModifyGuarded :: forall a. (Guarded -&gt; Guarded) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terModifyGuarded"><span class="hs-identifier hs-var hs-var">terModifyGuarded</span></a></span></span><span> </span><span id="local-6989586621681516179"><span class="annot"><span class="annottext">Guarded -&gt; Guarded
</span><a href="#local-6989586621681516179"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516180"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516180"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516180"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terGuarded"><span class="hs-identifier hs-var">terGuarded</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516179"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terGuarded"><span class="hs-identifier hs-var">terGuarded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516180"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span id="local-6989586621681515253"><span class="annot"><a href="Agda.Termination.Monad.html#terSetGuarded"><span class="hs-identifier hs-type">terSetGuarded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Order.html#Order"><span class="hs-identifier hs-type">Order</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515253"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515253"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-327"></span><span id="terSetGuarded"><span class="annot"><span class="annottext">terSetGuarded :: forall a. Guarded -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetGuarded"><span class="hs-identifier hs-var hs-var">terSetGuarded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Guarded -&gt; Guarded) -&gt; TerM a -&gt; TerM a
forall a. (Guarded -&gt; Guarded) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terModifyGuarded"><span class="hs-identifier hs-var">terModifyGuarded</span></a></span><span> </span><span class="annot"><span class="annottext">((Guarded -&gt; Guarded) -&gt; TerM a -&gt; TerM a)
-&gt; (Guarded -&gt; Guarded -&gt; Guarded) -&gt; Guarded -&gt; TerM a -&gt; TerM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Guarded -&gt; Guarded -&gt; Guarded
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span id="local-6989586621681516183"><span class="annot"><a href="Agda.Termination.Monad.html#terUnguarded"><span class="hs-identifier hs-type">terUnguarded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516183"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516183"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-330"></span><span id="terUnguarded"><span class="annot"><span class="annottext">terUnguarded :: forall a. TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terUnguarded"><span class="hs-identifier hs-var hs-var">terUnguarded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Guarded -&gt; TerM a -&gt; TerM a
forall a. Guarded -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetGuarded"><span class="hs-identifier hs-var">terSetGuarded</span></a></span><span> </span><span class="annot"><span class="annottext">Guarded
</span><a href="Agda.Termination.Order.html#unknown"><span class="hs-identifier hs-var">unknown</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><span class="hs-comment">-- | Lens for '_terSizeDepth'.</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><a href="Agda.Termination.Monad.html#terSizeDepth"><span class="hs-identifier hs-type">terSizeDepth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerEnv"><span class="hs-identifier hs-type">TerEnv</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-335"></span><span id="terSizeDepth"><span class="annot"><span class="annottext">terSizeDepth :: Lens' TerEnv Int
</span><a href="Agda.Termination.Monad.html#terSizeDepth"><span class="hs-identifier hs-var hs-var">terSizeDepth</span></a></span></span><span> </span><span id="local-6989586621681516188"><span class="annot"><span class="annottext">Int -&gt; f Int
</span><a href="#local-6989586621681516188"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681516189"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516189"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; f Int
</span><a href="#local-6989586621681516188"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TerEnv -&gt; Int
</span><a href="Agda.Termination.Monad.html#_terSizeDepth"><span class="hs-identifier hs-var">_terSizeDepth</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516189"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f Int -&gt; (Int -&gt; TerEnv) -&gt; f TerEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516191"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516191"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516189"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#_terSizeDepth"><span class="hs-identifier hs-var">_terSizeDepth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516191"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="annot"><span class="hs-comment">-- | Lens for 'terUsableVars'.</span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetUsableVars"><span class="hs-identifier hs-type">terGetUsableVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-340"></span><span id="terGetUsableVars"><span class="annot"><span class="annottext">terGetUsableVars :: TerM VarSet
</span><a href="Agda.Termination.Monad.html#terGetUsableVars"><span class="hs-identifier hs-var hs-var">terGetUsableVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; VarSet) -&gt; TerM VarSet
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; VarSet
</span><a href="Agda.Termination.Monad.html#terUsableVars"><span class="hs-identifier hs-var">terUsableVars</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span id="local-6989586621681515262"><span class="annot"><a href="Agda.Termination.Monad.html#terModifyUsableVars"><span class="hs-identifier hs-type">terModifyUsableVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515262"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515262"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-343"></span><span id="terModifyUsableVars"><span class="annot"><span class="annottext">terModifyUsableVars :: forall a. (VarSet -&gt; VarSet) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terModifyUsableVars"><span class="hs-identifier hs-var hs-var">terModifyUsableVars</span></a></span></span><span> </span><span id="local-6989586621681516195"><span class="annot"><span class="annottext">VarSet -&gt; VarSet
</span><a href="#local-6989586621681516195"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516196"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516196"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516196"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terUsableVars"><span class="hs-identifier hs-var">terUsableVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516195"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terUsableVars"><span class="hs-identifier hs-var">terUsableVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516196"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span id="local-6989586621681515264"><span class="annot"><a href="Agda.Termination.Monad.html#terSetUsableVars"><span class="hs-identifier hs-type">terSetUsableVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515264"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-346"></span><span id="terSetUsableVars"><span class="annot"><span class="annottext">terSetUsableVars :: forall a. VarSet -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetUsableVars"><span class="hs-identifier hs-var hs-var">terSetUsableVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet) -&gt; TerM a -&gt; TerM a
forall a. (VarSet -&gt; VarSet) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terModifyUsableVars"><span class="hs-identifier hs-var">terModifyUsableVars</span></a></span><span> </span><span class="annot"><span class="annottext">((VarSet -&gt; VarSet) -&gt; TerM a -&gt; TerM a)
-&gt; (VarSet -&gt; VarSet -&gt; VarSet) -&gt; VarSet -&gt; TerM a -&gt; TerM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><span class="hs-comment">-- | Lens for 'terUseSizeLt'.</span></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="annot"><a href="Agda.Termination.Monad.html#terGetUseSizeLt"><span class="hs-identifier hs-type">terGetUseSizeLt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-351"></span><span id="terGetUseSizeLt"><span class="annot"><span class="annottext">terGetUseSizeLt :: TerM Bool
</span><a href="Agda.Termination.Monad.html#terGetUseSizeLt"><span class="hs-identifier hs-var hs-var">terGetUseSizeLt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; Bool) -&gt; TerM Bool
forall a. (TerEnv -&gt; a) -&gt; TerM a
forall (m :: * -&gt; *) a. MonadTer m =&gt; (TerEnv -&gt; a) -&gt; m a
</span><a href="Agda.Termination.Monad.html#terAsks"><span class="hs-identifier hs-var">terAsks</span></a></span><span> </span><span class="annot"><span class="annottext">TerEnv -&gt; Bool
</span><a href="Agda.Termination.Monad.html#terUseSizeLt"><span class="hs-identifier hs-var">terUseSizeLt</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span id="local-6989586621681515266"><span class="annot"><a href="Agda.Termination.Monad.html#terModifyUseSizeLt"><span class="hs-identifier hs-type">terModifyUseSizeLt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515266"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515266"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-354"></span><span id="terModifyUseSizeLt"><span class="annot"><span class="annottext">terModifyUseSizeLt :: forall a. (Bool -&gt; Bool) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terModifyUseSizeLt"><span class="hs-identifier hs-var hs-var">terModifyUseSizeLt</span></a></span></span><span> </span><span id="local-6989586621681516201"><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="#local-6989586621681516201"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a)
-&gt; (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516202"><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516202"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerEnv
</span><a href="#local-6989586621681516202"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terUseSizeLt"><span class="hs-identifier hs-var">terUseSizeLt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681516201"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#terUseSizeLt"><span class="hs-identifier hs-var">terUseSizeLt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516202"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span id="local-6989586621681516203"><span class="annot"><a href="Agda.Termination.Monad.html#terSetUseSizeLt"><span class="hs-identifier hs-type">terSetUseSizeLt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516203"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516203"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-357"></span><span id="terSetUseSizeLt"><span class="annot"><span class="annottext">terSetUseSizeLt :: forall a. Bool -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetUseSizeLt"><span class="hs-identifier hs-var hs-var">terSetUseSizeLt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; TerM a -&gt; TerM a
forall a. (Bool -&gt; Bool) -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terModifyUseSizeLt"><span class="hs-identifier hs-var">terModifyUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; Bool) -&gt; TerM a -&gt; TerM a)
-&gt; (Bool -&gt; Bool -&gt; Bool) -&gt; Bool -&gt; TerM a -&gt; TerM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><span class="hs-comment">-- | Compute usable vars from patterns and run subcomputation.</span></span><span>
</span><span id="line-360"></span><span id="local-6989586621681515269"><span id="local-6989586621681515271"><span class="annot"><a href="Agda.Termination.Monad.html#withUsableVars"><span class="hs-identifier hs-type">withUsableVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#UsableSizeVars"><span class="hs-identifier hs-type">UsableSizeVars</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515269"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681515269"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515271"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515271"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-361"></span><span id="withUsableVars"><span class="annot"><span class="annottext">withUsableVars :: forall a b. UsableSizeVars a =&gt; a -&gt; TerM b -&gt; TerM b
</span><a href="Agda.Termination.Monad.html#withUsableVars"><span class="hs-identifier hs-var hs-var">withUsableVars</span></a></span></span><span> </span><span id="local-6989586621681516249"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681516249"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621681516250"><span class="annot"><span class="annottext">TerM b
</span><a href="#local-6989586621681516250"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621681516251"><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681516251"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; TerM VarSet
forall a. UsableSizeVars a =&gt; a -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var">usableSizeVars</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681516249"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; TerM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">70</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TerM ()) -&gt; String -&gt; TerM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;usableSizeVars = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681516251"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TerM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TerM ()) -&gt; TCM Doc -&gt; TerM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681516251"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;no usuable size vars&quot;</span></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;the size variables amoung these variables are usable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; TCM Doc) -&gt; [Int] -&gt; [TCM Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; TCM Doc) -&gt; (Int -&gt; Term) -&gt; Int -&gt; TCM Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [TCM Doc]) -&gt; [Int] -&gt; [TCM Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; [Int]
</span><span class="hs-identifier hs-var">VarSet.toList</span></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681516251"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">VarSet -&gt; TerM b -&gt; TerM b
forall a. VarSet -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetUsableVars"><span class="hs-identifier hs-var">terSetUsableVars</span></a></span><span> </span><span class="annot"><span class="annottext">VarSet
</span><a href="#local-6989586621681516251"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">(TerM b -&gt; TerM b) -&gt; TerM b -&gt; TerM b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TerM b
</span><a href="#local-6989586621681516250"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><span class="hs-comment">-- | Set 'terUseSizeLt' when going under constructor @c@.</span></span><span>
</span><span id="line-370"></span><span id="local-6989586621681516262"><span class="annot"><a href="Agda.Termination.Monad.html#conUseSizeLt"><span class="hs-identifier hs-type">conUseSizeLt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516262"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516262"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-371"></span><span id="conUseSizeLt"><span class="annot"><span class="annottext">conUseSizeLt :: forall a. QName -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#conUseSizeLt"><span class="hs-identifier hs-var hs-var">conUseSizeLt</span></a></span></span><span> </span><span id="local-6989586621681516267"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516267"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621681516268"><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516268"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="annottext">TerM Bool -&gt; TerM a -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Bool -&gt; TerM Bool
forall a. TCM a -&gt; TerM a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Bool -&gt; TerM Bool) -&gt; TCM Bool -&gt; TerM Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Bool
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Bool
</span><a href="Agda.TypeChecking.Records.html#isEtaOrCoinductiveRecordConstructor"><span class="hs-identifier hs-var">isEtaOrCoinductiveRecordConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516267"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Non-eta inductive records are the same as datatypes</span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; TerM a -&gt; TerM a
forall a. Bool -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetUseSizeLt"><span class="hs-identifier hs-var">terSetUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516268"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; TerM a -&gt; TerM a
forall a. Bool -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetUseSizeLt"><span class="hs-identifier hs-var">terSetUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516268"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Set 'terUseSizeLt' for arguments following projection @q@.</span><span>
</span><span id="line-377"></span><span class="hs-comment">--   We disregard j&lt;i after a non-coinductive projection.</span><span>
</span><span id="line-378"></span><span class="hs-comment">--   However, the projection need not be recursive (Issue 1470).</span><span>
</span><span id="line-379"></span><span id="local-6989586621681516272"><span class="annot"><a href="Agda.Termination.Monad.html#projUseSizeLt"><span class="hs-identifier hs-type">projUseSizeLt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516272"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516272"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-380"></span><span id="projUseSizeLt"><span class="annot"><span class="annottext">projUseSizeLt :: forall a. QName -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#projUseSizeLt"><span class="hs-identifier hs-var hs-var">projUseSizeLt</span></a></span></span><span> </span><span id="local-6989586621681516284"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516284"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621681516285"><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516285"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621681516286"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516286"><span class="hs-identifier hs-var">co</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; QName -&gt; TerM Bool
forall (tcm :: * -&gt; *). MonadTCM tcm =&gt; Bool -&gt; QName -&gt; tcm Bool
</span><a href="Agda.Termination.Monad.html#isCoinductiveProjection"><span class="hs-identifier hs-var">isCoinductiveProjection</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516284"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; TerM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.size&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TerM ()) -&gt; String -&gt; TerM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ShowS -&gt; ShowS
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyUnless"><span class="hs-identifier hs-var">applyUnless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516286"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;not &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;using SIZELT vars after projection &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516284"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; TerM a -&gt; TerM a
forall a. Bool -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetUseSizeLt"><span class="hs-identifier hs-var">terSetUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516286"><span class="hs-identifier hs-var">co</span></a></span><span> </span><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516285"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | For termination checking purposes flat should not be considered a</span><span>
</span><span id="line-387"></span><span class="hs-comment">--   projection. That is, it flat doesn't preserve either structural order</span><span>
</span><span id="line-388"></span><span class="hs-comment">--   or guardedness like other projections do.</span><span>
</span><span id="line-389"></span><span class="hs-comment">--   Andreas, 2012-06-09: the same applies to projections of recursive records.</span><span>
</span><span id="line-390"></span><span id="local-6989586621681515315"><span class="annot"><a href="Agda.Termination.Monad.html#isProjectionButNotCoinductive"><span class="hs-identifier hs-type">isProjectionButNotCoinductive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515315"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681515315"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-391"></span><span id="isProjectionButNotCoinductive"><span class="annot"><span class="annottext">isProjectionButNotCoinductive :: forall (tcm :: * -&gt; *). MonadTCM tcm =&gt; QName -&gt; tcm Bool
</span><a href="Agda.Termination.Monad.html#isProjectionButNotCoinductive"><span class="hs-identifier hs-var hs-var">isProjectionButNotCoinductive</span></a></span></span><span> </span><span id="local-6989586621681516315"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516315"><span class="hs-identifier hs-var">qn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM Bool -&gt; tcm Bool
forall a. TCM a -&gt; tcm a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Bool -&gt; tcm Bool) -&gt; TCM Bool -&gt; tcm Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621681516316"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516316"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Bool
</span><a href="#local-6989586621681516317"><span class="hs-identifier hs-var">isProjectionButNotCoinductive'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516315"><span class="hs-identifier hs-var">qn</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;identifier&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516315"><span class="hs-identifier hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-395"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TCM Doc) -&gt; String -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-396"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516316"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is an inductive projection&quot;</span></span><span>
</span><span id="line-397"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is either not a projection or coinductive&quot;</span></span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516316"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621681516317"><span class="annot"><span class="annottext">isProjectionButNotCoinductive' :: QName -&gt; TCM Bool
</span><a href="#local-6989586621681516317"><span class="hs-identifier hs-var hs-var">isProjectionButNotCoinductive'</span></a></span></span><span> </span><span id="local-6989586621681516332"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516332"><span class="hs-identifier hs-var">qn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>      </span><span id="local-6989586621681516333"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681516333"><span class="hs-identifier hs-var">flat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoinductionKit -&gt; QName) -&gt; Maybe CoinductionKit -&gt; Maybe QName
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">CoinductionKit -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Builtin.html#nameOfFlat"><span class="hs-identifier hs-var">nameOfFlat</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe CoinductionKit -&gt; Maybe QName)
-&gt; TCMT IO (Maybe CoinductionKit) -&gt; TCMT IO (Maybe QName)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe CoinductionKit)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#coinductionKit"><span class="hs-identifier hs-var">coinductionKit</span></a></span><span>
</span><span id="line-402"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516332"><span class="hs-identifier hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681516333"><span class="hs-identifier hs-var">flat</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-404"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>          </span><span id="local-6989586621681516335"><span class="annot"><span class="annottext">Maybe Projection
</span><a href="#local-6989586621681516335"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO (Maybe Projection)
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe Projection)
</span><a href="Agda.TypeChecking.Monad.Signature.html#isProjection"><span class="hs-identifier hs-var">isProjection</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516332"><span class="hs-identifier hs-var">qn</span></a></span><span>
</span><span id="line-406"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Projection
</span><a href="#local-6989586621681516335"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projProper :: Projection -&gt; Maybe QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projProper"><span class="hs-identifier hs-var">projProper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projFromType :: Projection -&gt; Arg QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projFromType"><span class="hs-identifier hs-var">projFromType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681516340"><span class="annot"><span class="annottext">Arg QName
</span><a href="#local-6989586621681516340"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-408"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Bool
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Bool
</span><a href="Agda.TypeChecking.Records.html#isInductiveRecord"><span class="hs-identifier hs-var">isInductiveRecord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg QName -&gt; QName
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg QName
</span><a href="#local-6989586621681516340"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>            </span><span class="annot"><span class="annottext">Maybe Projection
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | Check whether a projection belongs to a coinductive record</span><span>
</span><span id="line-412"></span><span class="hs-comment">--   and is actually recursive.</span><span>
</span><span id="line-413"></span><span class="hs-comment">--   E.g.</span><span>
</span><span id="line-414"></span><span class="hs-comment">--   @</span><span>
</span><span id="line-415"></span><span class="hs-comment">--      isCoinductiveProjection (Stream.head) = return False</span><span>
</span><span id="line-416"></span><span class="hs-comment">--</span><span>
</span><span id="line-417"></span><span class="hs-comment">--      isCoinductiveProjection (Stream.tail) = return True</span><span>
</span><span id="line-418"></span><span class="hs-comment">--   @</span><span>
</span><span id="line-419"></span><span id="local-6989586621681515311"><span class="annot"><a href="Agda.Termination.Monad.html#isCoinductiveProjection"><span class="hs-identifier hs-type">isCoinductiveProjection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#MonadTCM"><span class="hs-identifier hs-type">MonadTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515311"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681515311"><span class="hs-identifier hs-type">tcm</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-420"></span><span id="isCoinductiveProjection"><span class="annot"><span class="annottext">isCoinductiveProjection :: forall (tcm :: * -&gt; *). MonadTCM tcm =&gt; Bool -&gt; QName -&gt; tcm Bool
</span><a href="Agda.Termination.Monad.html#isCoinductiveProjection"><span class="hs-identifier hs-var hs-var">isCoinductiveProjection</span></a></span></span><span> </span><span id="local-6989586621681516458"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516458"><span class="hs-identifier hs-var">mustBeRecursive</span></a></span></span><span> </span><span id="local-6989586621681516459"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TCM Bool -&gt; tcm Bool
forall a. TCM a -&gt; tcm a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Bool -&gt; tcm Bool) -&gt; TCM Bool -&gt; tcm Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.guardedness&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TCMT IO ()) -&gt; String -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;checking isCoinductiveProjection &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621681516460"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681516460"><span class="hs-identifier hs-var">flat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CoinductionKit -&gt; QName) -&gt; Maybe CoinductionKit -&gt; Maybe QName
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">CoinductionKit -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Builtin.html#nameOfFlat"><span class="hs-identifier hs-var">nameOfFlat</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe CoinductionKit -&gt; Maybe QName)
-&gt; TCMT IO (Maybe CoinductionKit) -&gt; TCMT IO (Maybe QName)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe CoinductionKit)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#coinductionKit"><span class="hs-identifier hs-var">coinductionKit</span></a></span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-comment">-- yes for &#9837;</span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681516460"><span class="hs-identifier hs-var">flat</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>    </span><span id="local-6989586621681516461"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681516461"><span class="hs-identifier hs-var">pdef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Defn -&gt; Maybe Projection
</span><a href="Agda.TypeChecking.Monad.Signature.html#isProjection_"><span class="hs-identifier hs-var">isProjection_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681516461"><span class="hs-identifier hs-var">pdef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-427"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projProper :: Projection -&gt; Maybe QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projProper"><span class="hs-identifier hs-var">projProper</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projFromType :: Projection -&gt; Arg QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projFromType"><span class="hs-identifier hs-var">projFromType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681516466"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516466"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projIndex :: Projection -&gt; Int
</span><a href="Agda.TypeChecking.Monad.Base.html#projIndex"><span class="hs-identifier hs-var">projIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681516468"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516468"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO (Maybe Defn) -&gt; TCM Bool -&gt; (Defn -&gt; TCM Bool) -&gt; TCM Bool
forall (m :: * -&gt; *) a b.
Monad m =&gt;
m (Maybe a) -&gt; m b -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.Utils.Maybe.html#caseMaybeM"><span class="hs-identifier hs-var">caseMaybeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; TCMT IO (Maybe Defn)
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m (Maybe Defn)
</span><a href="Agda.TypeChecking.Records.html#isRecord"><span class="hs-identifier hs-var">isRecord</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516466"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Bool
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">((Defn -&gt; TCM Bool) -&gt; TCM Bool) -&gt; (Defn -&gt; TCM Bool) -&gt; TCM Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516471"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681516471"><span class="hs-identifier hs-var">rdef</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-429"></span><span>          </span><span class="hs-comment">-- no for inductive or non-recursive record</span><span>
</span><span id="line-430"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Defn -&gt; Maybe Induction
</span><a href="Agda.TypeChecking.Monad.Base.html#recInduction"><span class="hs-identifier hs-var">recInduction</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681516471"><span class="hs-identifier hs-var">rdef</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Induction -&gt; Maybe Induction -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Maybe Induction
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#CoInductive"><span class="hs-identifier hs-var">CoInductive</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.guardedness&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TCMT IO ()) -&gt; String -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is coinductive; record type is &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516466"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-432"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516458"><span class="hs-identifier hs-var">mustBeRecursive</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-433"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.guardedness&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TCMT IO ()) -&gt; String -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; must be recursive&quot;</span></span><span>
</span><span id="line-434"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defn -&gt; Bool
</span><a href="#local-6989586621681516476"><span class="hs-identifier hs-var">safeRecRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681516471"><span class="hs-identifier hs-var">rdef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.guardedness&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TCMT IO ()) -&gt; String -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; has been declared recursive, doing actual check now...&quot;</span></span><span>
</span><span id="line-436"></span><span>                </span><span class="hs-comment">-- TODO: the following test for recursiveness of a projection should be cached.</span><span>
</span><span id="line-437"></span><span>                </span><span class="hs-comment">-- E.g., it could be stored in the @Projection@ component.</span><span>
</span><span id="line-438"></span><span>                </span><span class="hs-comment">-- Now check if type of field mentions mutually recursive symbol.</span><span>
</span><span id="line-439"></span><span>                </span><span class="hs-comment">-- Get the type of the field by dropping record parameters and record argument.</span><span>
</span><span id="line-440"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier hs-type">TelV</span></a></span><span> </span><span id="local-6989586621681516478"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681516478"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621681516479"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681516479"><span class="hs-identifier hs-var">core</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TelV Type
</span><a href="Agda.TypeChecking.Substitute.html#telView%27"><span class="hs-identifier hs-var">telView'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681516461"><span class="hs-identifier hs-var">pdef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621681516482"><span class="annot"><span class="annottext">[Dom (String, Type)]
</span><a href="#local-6989586621681516482"><span class="hs-identifier hs-var">pars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516483"><span class="annot"><span class="annottext">[Dom (String, Type)]
</span><a href="#local-6989586621681516483"><span class="hs-identifier hs-var">tel'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; [Dom (String, Type)]
-&gt; ([Dom (String, Type)], [Dom (String, Type)])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516468"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([Dom (String, Type)]
 -&gt; ([Dom (String, Type)], [Dom (String, Type)]))
-&gt; [Dom (String, Type)]
-&gt; ([Dom (String, Type)], [Dom (String, Type)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [Dom (String, Type)]
forall t. Tele (Dom t) -&gt; [Dom (String, t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681516478"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-442"></span><span>                    </span><span id="local-6989586621681516486"><span class="annot"><span class="annottext">mut :: [QName]
</span><a href="#local-6989586621681516486"><span class="hs-identifier hs-var hs-var">mut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; Maybe [QName] -&gt; [QName]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">[QName]
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [QName] -&gt; [QName]) -&gt; Maybe [QName] -&gt; [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Defn -&gt; Maybe [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#recMutual"><span class="hs-identifier hs-var">recMutual</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681516471"><span class="hs-identifier hs-var">rdef</span></a></span><span>
</span><span id="line-443"></span><span>                </span><span class="hs-comment">-- Check if any recursive symbols appear in the record type.</span><span>
</span><span id="line-444"></span><span>                </span><span class="hs-comment">-- Q (2014-07-01): Should we normalize the type?</span><span>
</span><span id="line-445"></span><span>                </span><span class="hs-comment">-- A (2017-01-13): Yes, since we also normalize during positivity check?</span><span>
</span><span id="line-446"></span><span>                </span><span class="hs-comment">-- See issue #1899.</span><span>
</span><span id="line-447"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.guardedness&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM Doc) -&gt; TCM Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-448"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;looking for recursive occurrences of&quot;</span></span><span>
</span><span id="line-449"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(QName -&gt; TCM Doc) -&gt; [QName] -&gt; [TCM Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681516486"><span class="hs-identifier hs-var">mut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;in&quot;</span></span><span>
</span><span id="line-451"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Dom (String, Type)] -&gt; TCM Doc -&gt; TCM Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
[Dom (String, Type)] -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom (String, Type)]
</span><a href="#local-6989586621681516482"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM Doc) -&gt; TCM Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dom (String, Type)] -&gt; Telescope
</span><a href="Agda.Syntax.Internal.html#telFromList"><span class="hs-identifier hs-var">telFromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom (String, Type)]
</span><a href="#local-6989586621681516483"><span class="hs-identifier hs-var">tel'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;and&quot;</span></span><span>
</span><span id="line-453"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCM Doc -&gt; TCM Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681516478"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM Doc) -&gt; TCM Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681516479"><span class="hs-identifier hs-var">core</span></a></span><span>
</span><span id="line-454"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; TCMT IO () -&gt; TCMT IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[QName] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681516486"><span class="hs-identifier hs-var">mut</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCMT IO ()
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-456"></span><span>                </span><span id="local-6989586621681516493"><span class="annot"><span class="annottext">MutualNames
</span><a href="#local-6989586621681516493"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Bool) -&gt; ([Type], Type) -&gt; TCM MutualNames
forall a. GetDefs a =&gt; (QName -&gt; Bool) -&gt; a -&gt; TCM MutualNames
</span><a href="Agda.Termination.RecCheck.html#anyDefs"><span class="hs-identifier hs-var">anyDefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681516486"><span class="hs-identifier hs-var">mut</span></a></span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; QName -&gt; Bool
forall a. Ord a =&gt; [a] -&gt; a -&gt; Bool
</span><a href="Agda.Utils.List.html#hasElem"><span class="hs-operator hs-var">`hasElem`</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dom (String, Type) -&gt; Type) -&gt; [Dom (String, Type)] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String, Type) -&gt; Type)
-&gt; (Dom (String, Type) -&gt; (String, Type))
-&gt; Dom (String, Type)
-&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dom (String, Type) -&gt; (String, Type)
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dom (String, Type)]
</span><a href="#local-6989586621681516483"><span class="hs-identifier hs-var">tel'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681516479"><span class="hs-identifier hs-var">core</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; TCM Doc -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.guardedness&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCMT IO ()) -&gt; TCM Doc -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-458"></span><span>                  </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;found&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">MutualNames -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">MutualNames
</span><a href="#local-6989586621681516493"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;none&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(QName -&gt; TCM Doc) -&gt; [QName] -&gt; [TCM Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">([QName] -&gt; [TCM Doc]) -&gt; [QName] -&gt; [TCM Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MutualNames -&gt; [QName]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">MutualNames
</span><a href="#local-6989586621681516493"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; TCM Bool) -&gt; Bool -&gt; TCM Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MutualNames -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">MutualNames
</span><a href="#local-6989586621681516493"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-460"></span><span>      </span><span class="annot"><span class="annottext">Maybe Projection
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-461"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String -&gt; TCMT IO ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; Int -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;term.guardedness&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TCMT IO ()) -&gt; String -&gt; TCMT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Syntax.Common.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516459"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; is not a proper projection&quot;</span></span><span>
</span><span id="line-462"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; TCM Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-comment">-- Andreas, 2018-02-24, issue #2975, example:</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-comment">-- record R : Set where</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-comment">--   coinductive</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-comment">--   field force : R</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-comment">--   r : R</span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-comment">--   force r = r</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-comment">-- @</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-comment">-- The termination checker expects the positivity checker to have run on the</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-comment">-- record declaration R to know whether R is recursive.</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-comment">-- However, here, because the awkward processing of record declarations (see #434),</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-comment">-- that has not happened.  To avoid crashing (as in Agda 2.5.3),</span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-comment">-- we rather give the possibly wrong answer here,</span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-comment">-- restoring the behavior of Agda 2.5.2.  TODO: fix record declaration checking.</span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><a href="#local-6989586621681516476"><span class="hs-identifier hs-type">safeRecRecursive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-480"></span><span>  </span><span id="local-6989586621681516476"><span class="annot"><span class="annottext">safeRecRecursive :: Defn -&gt; Bool
</span><a href="#local-6989586621681516476"><span class="hs-identifier hs-var hs-var">safeRecRecursive</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recMutual :: Defn -&gt; Maybe [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#recMutual"><span class="hs-identifier hs-var">recMutual</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681516498"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681516498"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[QName] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621681516498"><span class="hs-identifier hs-var">qs</span></a></span><span>
</span><span id="line-481"></span><span>  </span><span class="annot"><a href="#local-6989586621681516476"><span class="hs-identifier hs-var">safeRecRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="annot"><span class="hs-comment">-- * De Bruijn pattern stuff</span></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><span class="hs-comment">-- | How long is the path to the deepest atomic pattern?</span></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Agda.Termination.Monad.html#patternDepth"><span class="hs-identifier hs-type">patternDepth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681515360"><span class="annot"><a href="#local-6989586621681515360"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pattern%27"><span class="hs-identifier hs-type">Pattern'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-487"></span><span id="patternDepth"><span class="annot"><span class="annottext">patternDepth :: forall a. Pattern' a -&gt; Int
</span><a href="Agda.Termination.Monad.html#patternDepth"><span class="hs-identifier hs-var hs-var">patternDepth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaxNat -&gt; Int
</span><a href="Agda.Utils.Monoid.html#getMaxNat"><span class="hs-identifier hs-var">getMaxNat</span></a></span><span> </span><span class="annot"><span class="annottext">(MaxNat -&gt; Int) -&gt; (Pattern' a -&gt; MaxNat) -&gt; Pattern' a -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Pattern' a -&gt; MaxNat -&gt; MaxNat) -&gt; Pattern' a -&gt; MaxNat
forall m. Monoid m =&gt; (Pattern' a -&gt; m -&gt; m) -&gt; Pattern' a -&gt; m
forall a b m.
(PatternLike a b, Monoid m) =&gt;
(Pattern' a -&gt; m -&gt; m) -&gt; b -&gt; m
</span><a href="Agda.Syntax.Internal.Pattern.html#foldrPattern"><span class="hs-identifier hs-var">foldrPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' a -&gt; MaxNat -&gt; MaxNat
</span><a href="#local-6989586621681516508"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><a href="#local-6989586621681516508"><span class="hs-identifier hs-type">depth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Pattern%27"><span class="hs-identifier hs-type">Pattern'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Monoid.html#MaxNat"><span class="hs-identifier hs-type">MaxNat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Monoid.html#MaxNat"><span class="hs-identifier hs-type">MaxNat</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span id="local-6989586621681516508"><span class="annot"><span class="annottext">depth :: Pattern' a -&gt; MaxNat -&gt; MaxNat
</span><a href="#local-6989586621681516508"><span class="hs-identifier hs-var hs-var">depth</span></a></span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConP"><span class="hs-identifier hs-type">ConP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaxNat -&gt; MaxNat
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span>      </span><span class="hs-comment">-- add 1 to the maximum of the depth of the subpatterns</span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><a href="#local-6989586621681516508"><span class="hs-identifier hs-var">depth</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' a
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaxNat -&gt; MaxNat
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>        </span><span class="hs-comment">-- atomic pattern (leaf) has depth 0</span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span class="hs-comment">-- | A dummy pattern used to mask a pattern that cannot be used</span><span>
</span><span id="line-493"></span><span class="hs-comment">--   for structural descent.</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="annot"><a href="Agda.Termination.Monad.html#unusedVar"><span class="hs-identifier hs-type">unusedVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#DeBruijnPattern"><span class="hs-identifier hs-type">DeBruijnPattern</span></a></span><span>
</span><span id="line-496"></span><span id="unusedVar"><span class="annot"><span class="annottext">unusedVar :: DeBruijnPattern
</span><a href="Agda.Termination.Monad.html#unusedVar"><span class="hs-identifier hs-var hs-var">unusedVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; DeBruijnPattern
forall a. Literal -&gt; Pattern' a
</span><a href="Agda.Syntax.Internal.html#litP"><span class="hs-identifier hs-var">litP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Literal
</span><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-var">LitString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;term.unused.pat.var&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | Extract variables from 'DeBruijnPattern's that could witness a decrease</span><span>
</span><span id="line-499"></span><span class="hs-comment">--   via a SIZELT constraint.</span><span>
</span><span id="line-500"></span><span class="hs-comment">--</span><span>
</span><span id="line-501"></span><span class="hs-comment">--   These variables must be under an inductive constructor (with no record</span><span>
</span><span id="line-502"></span><span class="hs-comment">--   constructor in the way), or after a coinductive projection (with no</span><span>
</span><span id="line-503"></span><span class="hs-comment">--   inductive one in the way).</span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-keyword">class</span><span> </span><span id="UsableSizeVars"><span class="annot"><a href="Agda.Termination.Monad.html#UsableSizeVars"><span class="hs-identifier hs-var">UsableSizeVars</span></a></span></span><span> </span><span id="local-6989586621681515294"><span class="annot"><a href="#local-6989586621681515294"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>  </span><span id="usableSizeVars"><span class="annot"><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-type">usableSizeVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681515294"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.VarSet.html#VarSet"><span class="hs-identifier hs-type">VarSet</span></a></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#UsableSizeVars"><span class="hs-identifier hs-type">UsableSizeVars</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#DeBruijnPattern"><span class="hs-identifier hs-type">DeBruijnPattern</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-509"></span><span>  </span><span id="local-6989586621681516538"><span class="annot"><span class="annottext">usableSizeVars :: DeBruijnPattern -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableSizeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DeBruijnPattern -&gt; TerM VarSet -&gt; TerM VarSet)
-&gt; DeBruijnPattern -&gt; TerM VarSet
forall m.
Monoid m =&gt;
(DeBruijnPattern -&gt; m -&gt; m) -&gt; DeBruijnPattern -&gt; m
forall a b m.
(PatternLike a b, Monoid m) =&gt;
(Pattern' a -&gt; m -&gt; m) -&gt; b -&gt; m
</span><a href="Agda.Syntax.Internal.Pattern.html#foldrPattern"><span class="hs-identifier hs-var">foldrPattern</span></a></span><span> </span><span class="annot"><span class="annottext">((DeBruijnPattern -&gt; TerM VarSet -&gt; TerM VarSet)
 -&gt; DeBruijnPattern -&gt; TerM VarSet)
-&gt; (DeBruijnPattern -&gt; TerM VarSet -&gt; TerM VarSet)
-&gt; DeBruijnPattern
-&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#VarP"><span class="hs-identifier hs-type">VarP</span></a></span><span> </span><span class="annot"><span class="annottext">PatternInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681516540"><span class="annot"><span class="annottext">DBPatVar
</span><a href="#local-6989586621681516540"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet)
-&gt; TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TerM Bool -&gt; TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="annot"><span class="annottext">TerM Bool
</span><a href="Agda.Termination.Monad.html#terGetUseSizeLt"><span class="hs-identifier hs-var">terGetUseSizeLt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; TerM VarSet
forall a. a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; TerM VarSet) -&gt; VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><span class="hs-identifier hs-var">VarSet.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; VarSet) -&gt; Int -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DBPatVar -&gt; Int
</span><a href="Agda.Syntax.Internal.html#dbPatVarIndex"><span class="hs-identifier hs-var">dbPatVarIndex</span></a></span><span> </span><span class="annot"><span class="annottext">DBPatVar
</span><a href="#local-6989586621681516540"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TerM VarSet -&gt; TerM VarSet) -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-511"></span><span>                   </span><span class="hs-comment">{-else-}</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TerM VarSet
forall a. a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">VarSet
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-512"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConP"><span class="hs-identifier hs-type">ConP</span></a></span><span> </span><span id="local-6989586621681516543"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681516543"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConPatternInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[NamedArg DeBruijnPattern]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TerM VarSet -&gt; TerM VarSet
forall a. QName -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#conUseSizeLt"><span class="hs-identifier hs-var">conUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; TerM VarSet -&gt; TerM VarSet)
-&gt; QName -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681516543"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#LitP"><span class="hs-identifier hs-type">LitP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516546"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-514"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516546"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-515"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#ProjP"><span class="hs-identifier hs-type">ProjP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516546"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#IApplyP"><span class="hs-identifier hs-type">IApplyP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516546"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-517"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefP"><span class="hs-identifier hs-type">DefP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516546"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-518"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681516546"><span class="annot"><span class="annottext">none :: p -&gt; m a
</span><a href="#local-6989586621681516546"><span class="hs-identifier hs-var hs-var">none</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#UsableSizeVars"><span class="hs-identifier hs-type">UsableSizeVars</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#DeBruijnPattern"><span class="hs-identifier hs-type">DeBruijnPattern</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-521"></span><span>  </span><span id="local-6989586621681516574"><span class="annot"><span class="annottext">usableSizeVars :: [DeBruijnPattern] -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableSizeVars</span></a></span></span><span> </span><span id="local-6989586621681516575"><span class="annot"><span class="annottext">[DeBruijnPattern]
</span><a href="#local-6989586621681516575"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[DeBruijnPattern]
</span><a href="#local-6989586621681516575"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TerM VarSet
forall a. a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">VarSet
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#ProjP"><span class="hs-identifier hs-type">ProjP</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681516576"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516576"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681516577"><span class="annot"><span class="annottext">[DeBruijnPattern]
</span><a href="#local-6989586621681516577"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TerM VarSet -&gt; TerM VarSet
forall a. QName -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#projUseSizeLt"><span class="hs-identifier hs-var">projUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516576"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">(TerM VarSet -&gt; TerM VarSet) -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DeBruijnPattern] -&gt; TerM VarSet
forall a. UsableSizeVars a =&gt; a -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var">usableSizeVars</span></a></span><span> </span><span class="annot"><span class="annottext">[DeBruijnPattern]
</span><a href="#local-6989586621681516577"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681516578"><span class="annot"><span class="annottext">DeBruijnPattern
</span><a href="#local-6989586621681516578"><span class="hs-identifier hs-var">p</span></a></span></span><span>         </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681516579"><span class="annot"><span class="annottext">[DeBruijnPattern]
</span><a href="#local-6989586621681516579"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet -&gt; VarSet)
-&gt; TerM VarSet -&gt; TerM (VarSet -&gt; VarSet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DeBruijnPattern -&gt; TerM VarSet
forall a. UsableSizeVars a =&gt; a -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var">usableSizeVars</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijnPattern
</span><a href="#local-6989586621681516578"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">TerM (VarSet -&gt; VarSet) -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. TerM (a -&gt; b) -&gt; TerM a -&gt; TerM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DeBruijnPattern] -&gt; TerM VarSet
forall a. UsableSizeVars a =&gt; a -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var">usableSizeVars</span></a></span><span> </span><span class="annot"><span class="annottext">[DeBruijnPattern]
</span><a href="#local-6989586621681516579"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#UsableSizeVars"><span class="hs-identifier hs-type">UsableSizeVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#DeBruijnPattern"><span class="hs-identifier hs-type">DeBruijnPattern</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-528"></span><span>  </span><span id="local-6989586621681516602"><span class="annot"><span class="annottext">usableSizeVars :: Masked DeBruijnPattern -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableSizeVars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span id="local-6989586621681516604"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516604"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681516605"><span class="annot"><span class="annottext">DeBruijnPattern
</span><a href="#local-6989586621681516605"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DeBruijnPattern -&gt; TerM VarSet -&gt; TerM VarSet)
-&gt; DeBruijnPattern -&gt; TerM VarSet
forall m.
Monoid m =&gt;
(DeBruijnPattern -&gt; m -&gt; m) -&gt; DeBruijnPattern -&gt; m
forall a b m.
(PatternLike a b, Monoid m) =&gt;
(Pattern' a -&gt; m -&gt; m) -&gt; b -&gt; m
</span><a href="Agda.Syntax.Internal.Pattern.html#foldrPattern"><span class="hs-operator hs-var">`foldrPattern`</span></a></span><span> </span><span class="annot"><span class="annottext">DeBruijnPattern
</span><a href="#local-6989586621681516605"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((DeBruijnPattern -&gt; TerM VarSet -&gt; TerM VarSet) -&gt; TerM VarSet)
-&gt; (DeBruijnPattern -&gt; TerM VarSet -&gt; TerM VarSet) -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#VarP"><span class="hs-identifier hs-type">VarP</span></a></span><span> </span><span class="annot"><span class="annottext">PatternInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681516606"><span class="annot"><span class="annottext">DBPatVar
</span><a href="#local-6989586621681516606"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet)
-&gt; TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TerM Bool -&gt; TerM VarSet -&gt; TerM VarSet -&gt; TerM VarSet
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="annot"><span class="annottext">TerM Bool
</span><a href="Agda.Termination.Monad.html#terGetUseSizeLt"><span class="hs-identifier hs-var">terGetUseSizeLt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarSet -&gt; TerM VarSet
forall a. a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; TerM VarSet) -&gt; VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; VarSet
</span><span class="hs-identifier hs-var">VarSet.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; VarSet) -&gt; Int -&gt; VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DBPatVar -&gt; Int
</span><a href="Agda.Syntax.Internal.html#dbPatVarIndex"><span class="hs-identifier hs-var">dbPatVarIndex</span></a></span><span> </span><span class="annot"><span class="annottext">DBPatVar
</span><a href="#local-6989586621681516606"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TerM VarSet -&gt; TerM VarSet) -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-530"></span><span>                   </span><span class="hs-comment">{-else-}</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TerM VarSet
forall a. a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">VarSet
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConP"><span class="hs-identifier hs-type">ConP</span></a></span><span> </span><span id="local-6989586621681516607"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681516607"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConPatternInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[NamedArg DeBruijnPattern]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516604"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516608"><span class="hs-identifier hs-var">none</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TerM VarSet -&gt; TerM VarSet
forall a. QName -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#conUseSizeLt"><span class="hs-identifier hs-var">conUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; TerM VarSet -&gt; TerM VarSet)
-&gt; QName -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681516607"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#LitP"><span class="hs-identifier hs-type">LitP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516608"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DotP"><span class="hs-identifier hs-type">DotP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516608"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#ProjP"><span class="hs-identifier hs-type">ProjP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516608"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-535"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#IApplyP"><span class="hs-identifier hs-type">IApplyP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516608"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Internal.html#DefP"><span class="hs-identifier hs-type">DefP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TerM VarSet -&gt; TerM VarSet
forall {m :: * -&gt; *} {a} {p}. (Monad m, Monoid a) =&gt; p -&gt; m a
</span><a href="#local-6989586621681516608"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621681516608"><span class="annot"><span class="annottext">none :: p -&gt; m a
</span><a href="#local-6989586621681516608"><span class="hs-identifier hs-var hs-var">none</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#UsableSizeVars"><span class="hs-identifier hs-type">UsableSizeVars</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#MaskedDeBruijnPatterns"><span class="hs-identifier hs-type">MaskedDeBruijnPatterns</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-540"></span><span>  </span><span id="local-6989586621681516629"><span class="annot"><span class="annottext">usableSizeVars :: MaskedDeBruijnPatterns -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var hs-var hs-var hs-var">usableSizeVars</span></a></span></span><span> </span><span id="local-6989586621681516630"><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516630"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516630"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-542"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; TerM VarSet
forall a. a -&gt; TerM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">VarSet
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-543"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#ProjP"><span class="hs-identifier hs-type">ProjP</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681516631"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516631"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681516632"><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516632"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TerM VarSet -&gt; TerM VarSet
forall a. QName -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#projUseSizeLt"><span class="hs-identifier hs-var">projUseSizeLt</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681516631"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">(TerM VarSet -&gt; TerM VarSet) -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns -&gt; TerM VarSet
forall a. UsableSizeVars a =&gt; a -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var">usableSizeVars</span></a></span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516632"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-544"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681516633"><span class="annot"><span class="annottext">Masked DeBruijnPattern
</span><a href="#local-6989586621681516633"><span class="hs-identifier hs-var">p</span></a></span></span><span>                    </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681516634"><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516634"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarSet -&gt; VarSet -&gt; VarSet
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">(VarSet -&gt; VarSet -&gt; VarSet)
-&gt; TerM VarSet -&gt; TerM (VarSet -&gt; VarSet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Masked DeBruijnPattern -&gt; TerM VarSet
forall a. UsableSizeVars a =&gt; a -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var">usableSizeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Masked DeBruijnPattern
</span><a href="#local-6989586621681516633"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">TerM (VarSet -&gt; VarSet) -&gt; TerM VarSet -&gt; TerM VarSet
forall a b. TerM (a -&gt; b) -&gt; TerM a -&gt; TerM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns -&gt; TerM VarSet
forall a. UsableSizeVars a =&gt; a -&gt; TerM VarSet
</span><a href="Agda.Termination.Monad.html#usableSizeVars"><span class="hs-identifier hs-var">usableSizeVars</span></a></span><span> </span><span class="annot"><span class="annottext">MaskedDeBruijnPatterns
</span><a href="#local-6989586621681516634"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="annot"><span class="hs-comment">-- * Masked patterns (which are not eligible for structural descent, only for size descent)</span></span><span>
</span><span id="line-547"></span><span class="hs-comment">--   See issue #1023.</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="hs-keyword">type</span><span> </span><span id="MaskedDeBruijnPatterns"><span class="annot"><a href="Agda.Termination.Monad.html#MaskedDeBruijnPatterns"><span class="hs-identifier hs-var">MaskedDeBruijnPatterns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#DeBruijnPattern"><span class="hs-identifier hs-type">DeBruijnPattern</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-keyword">data</span><span> </span><span id="Masked"><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-var">Masked</span></a></span></span><span> </span><span id="local-6989586621681515390"><span class="annot"><a href="#local-6989586621681515390"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Masked"><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-var">Masked</span></a></span></span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="getMask"><span class="annot"><span class="annottext">forall a. Masked a -&gt; Bool
</span><a href="Agda.Termination.Monad.html#getMask"><span class="hs-identifier hs-var hs-var">getMask</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ True if thing not eligible for structural descent.</span></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="getMasked"><span class="annot"><span class="annottext">forall a. Masked a -&gt; a
</span><a href="Agda.Termination.Monad.html#getMasked"><span class="hs-identifier hs-var hs-var">getMasked</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681515390"><span class="hs-identifier hs-type">a</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ Thing.</span></span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681516639"><span id="local-6989586621681516644"><span class="annot"><span class="annottext">Masked a -&gt; Masked a -&gt; Bool
(Masked a -&gt; Masked a -&gt; Bool)
-&gt; (Masked a -&gt; Masked a -&gt; Bool) -&gt; Eq (Masked a)
forall a. Eq a =&gt; Masked a -&gt; Masked a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Masked a -&gt; Masked a -&gt; Bool
== :: Masked a -&gt; Masked a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Masked a -&gt; Masked a -&gt; Bool
/= :: Masked a -&gt; Masked a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516652"><span id="local-6989586621681516657"><span id="local-6989586621681516661"><span id="local-6989586621681516665"><span id="local-6989586621681516668"><span id="local-6989586621681516671"><span id="local-6989586621681516674"><span class="annot"><span class="annottext">Eq (Masked a)
Eq (Masked a) =&gt;
(Masked a -&gt; Masked a -&gt; Ordering)
-&gt; (Masked a -&gt; Masked a -&gt; Bool)
-&gt; (Masked a -&gt; Masked a -&gt; Bool)
-&gt; (Masked a -&gt; Masked a -&gt; Bool)
-&gt; (Masked a -&gt; Masked a -&gt; Bool)
-&gt; (Masked a -&gt; Masked a -&gt; Masked a)
-&gt; (Masked a -&gt; Masked a -&gt; Masked a)
-&gt; Ord (Masked a)
Masked a -&gt; Masked a -&gt; Bool
Masked a -&gt; Masked a -&gt; Ordering
Masked a -&gt; Masked a -&gt; Masked a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Masked a)
forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Bool
forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Ordering
forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Masked a
$ccompare :: forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Ordering
compare :: Masked a -&gt; Masked a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Bool
&lt; :: Masked a -&gt; Masked a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Bool
&lt;= :: Masked a -&gt; Masked a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Bool
&gt; :: Masked a -&gt; Masked a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Bool
&gt;= :: Masked a -&gt; Masked a -&gt; Bool
$cmax :: forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Masked a
max :: Masked a -&gt; Masked a -&gt; Masked a
$cmin :: forall a. Ord a =&gt; Masked a -&gt; Masked a -&gt; Masked a
min :: Masked a -&gt; Masked a -&gt; Masked a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516680"><span id="local-6989586621681516686"><span id="local-6989586621681516690"><span class="annot"><span class="annottext">Int -&gt; Masked a -&gt; ShowS
[Masked a] -&gt; ShowS
Masked a -&gt; String
(Int -&gt; Masked a -&gt; ShowS)
-&gt; (Masked a -&gt; String) -&gt; ([Masked a] -&gt; ShowS) -&gt; Show (Masked a)
forall a. Show a =&gt; Int -&gt; Masked a -&gt; ShowS
forall a. Show a =&gt; [Masked a] -&gt; ShowS
forall a. Show a =&gt; Masked a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Masked a -&gt; ShowS
showsPrec :: Int -&gt; Masked a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Masked a -&gt; String
show :: Masked a -&gt; String
$cshowList :: forall a. Show a =&gt; [Masked a] -&gt; ShowS
showList :: [Masked a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516693"><span id="local-6989586621681516695"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Masked a -&gt; Masked b)
-&gt; (forall a b. a -&gt; Masked b -&gt; Masked a) -&gt; Functor Masked
forall a b. a -&gt; Masked b -&gt; Masked a
forall a b. (a -&gt; b) -&gt; Masked a -&gt; Masked b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Masked a -&gt; Masked b
fmap :: forall a b. (a -&gt; b) -&gt; Masked a -&gt; Masked b
$c&lt;$ :: forall a b. a -&gt; Masked b -&gt; Masked a
&lt;$ :: forall a b. a -&gt; Masked b -&gt; Masked a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516697"><span id="local-6989586621681516703"><span id="local-6989586621681516706"><span id="local-6989586621681516711"><span id="local-6989586621681516713"><span id="local-6989586621681516716"><span id="local-6989586621681516719"><span id="local-6989586621681516722"><span id="local-6989586621681516725"><span id="local-6989586621681516728"><span id="local-6989586621681516731"><span id="local-6989586621681516733"><span id="local-6989586621681516736"><span id="local-6989586621681516741"><span id="local-6989586621681516746"><span id="local-6989586621681516751"><span id="local-6989586621681516756"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; Masked m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Masked a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Masked a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Masked a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Masked a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Masked a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Masked a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Masked a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Masked a -&gt; a)
-&gt; (forall a. Masked a -&gt; [a])
-&gt; (forall a. Masked a -&gt; Bool)
-&gt; (forall a. Masked a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Masked a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Masked a -&gt; a)
-&gt; (forall a. Ord a =&gt; Masked a -&gt; a)
-&gt; (forall a. Num a =&gt; Masked a -&gt; a)
-&gt; (forall a. Num a =&gt; Masked a -&gt; a)
-&gt; Foldable Masked
forall a. Eq a =&gt; a -&gt; Masked a -&gt; Bool
forall a. Num a =&gt; Masked a -&gt; a
forall a. Ord a =&gt; Masked a -&gt; a
forall m. Monoid m =&gt; Masked m -&gt; m
forall a. Masked a -&gt; Bool
forall a. Masked a -&gt; Int
forall a. Masked a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Masked a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Masked a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Masked a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Masked a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; Masked m -&gt; m
fold :: forall m. Monoid m =&gt; Masked m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Masked a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Masked a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Masked a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Masked a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Masked a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Masked a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Masked a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Masked a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Masked a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Masked a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Masked a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Masked a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Masked a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Masked a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Masked a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Masked a -&gt; a
$ctoList :: forall a. Masked a -&gt; [a]
toList :: forall a. Masked a -&gt; [a]
$cnull :: forall a. Masked a -&gt; Bool
null :: forall a. Masked a -&gt; Bool
$clength :: forall a. Masked a -&gt; Int
length :: forall a. Masked a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; Masked a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; Masked a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; Masked a -&gt; a
maximum :: forall a. Ord a =&gt; Masked a -&gt; a
$cminimum :: forall a. Ord a =&gt; Masked a -&gt; a
minimum :: forall a. Ord a =&gt; Masked a -&gt; a
$csum :: forall a. Num a =&gt; Masked a -&gt; a
sum :: forall a. Num a =&gt; Masked a -&gt; a
$cproduct :: forall a. Num a =&gt; Masked a -&gt; a
product :: forall a. Num a =&gt; Masked a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516766"><span id="local-6989586621681516771"><span id="local-6989586621681516777"><span id="local-6989586621681516782"><span class="annot"><span class="annottext">Functor Masked
Foldable Masked
(Functor Masked, Foldable Masked) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; Masked a -&gt; f (Masked b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    Masked (f a) -&gt; f (Masked a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Masked a -&gt; m (Masked b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    Masked (m a) -&gt; m (Masked a))
-&gt; Traversable Masked
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Masked (m a) -&gt; m (Masked a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
Masked (f a) -&gt; f (Masked a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Masked a -&gt; m (Masked b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Masked a -&gt; f (Masked b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Masked a -&gt; f (Masked b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Masked a -&gt; f (Masked b)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
Masked (f a) -&gt; f (Masked a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
Masked (f a) -&gt; f (Masked a)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Masked a -&gt; m (Masked b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Masked a -&gt; m (Masked b)
$csequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Masked (m a) -&gt; m (Masked a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Masked (m a) -&gt; m (Masked a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span id="local-6989586621681515435"><span class="annot"><a href="Agda.Termination.Monad.html#masked"><span class="hs-identifier hs-type">masked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681515435"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515435"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-557"></span><span id="masked"><span class="annot"><span class="annottext">masked :: forall a. a -&gt; Masked a
</span><a href="Agda.Termination.Monad.html#masked"><span class="hs-identifier hs-var hs-var">masked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Masked a
forall a. Bool -&gt; a -&gt; Masked a
</span><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-var">Masked</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span id="local-6989586621681516788"><span class="annot"><a href="Agda.Termination.Monad.html#notMasked"><span class="hs-identifier hs-type">notMasked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621681516788"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681516788"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-560"></span><span id="notMasked"><span class="annot"><span class="annottext">notMasked :: forall a. a -&gt; Masked a
</span><a href="Agda.Termination.Monad.html#notMasked"><span class="hs-identifier hs-var hs-var">notMasked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Masked a
forall a. Bool -&gt; a -&gt; Masked a
</span><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-var">Masked</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681516793"><span class="annot"><a href="Agda.Utils.Functor.html#Decoration"><span class="hs-identifier hs-type">Decoration</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-563"></span><span>  </span><span id="local-6989586621681516801"><span class="annot"><span class="annottext">traverseF :: forall (m :: * -&gt; *) a b.
Functor m =&gt;
(a -&gt; m b) -&gt; Masked a -&gt; m (Masked b)
</span><a href="#local-6989586621681516801"><span class="hs-identifier hs-var hs-var hs-var hs-var">traverseF</span></a></span></span><span> </span><span id="local-6989586621681516803"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621681516803"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span id="local-6989586621681516804"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516804"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681516805"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681516805"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Masked b
forall a. Bool -&gt; a -&gt; Masked a
</span><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-var">Masked</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516804"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Masked b) -&gt; m b -&gt; m (Masked b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621681516803"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681516805"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="annot"><span class="hs-comment">-- | Print masked things in double parentheses.</span></span><span>
</span><span id="line-566"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681515450"><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515450"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html#PrettyTCM"><span class="hs-identifier hs-type">PrettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515450"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-567"></span><span>  </span><span id="local-6989586621681516819"><span class="annot"><span class="annottext">prettyTCM :: forall (m :: * -&gt; *). MonadPretty m =&gt; Masked a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var hs-var hs-var hs-var">prettyTCM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#Masked"><span class="hs-identifier hs-type">Masked</span></a></span><span> </span><span id="local-6989586621681516820"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516820"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681516821"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681516821"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (m Doc -&gt; m Doc) -&gt; m Doc -&gt; m Doc
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681516820"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span> </span><span class="annot"><span class="annottext">(m Doc -&gt; m Doc) -&gt; (m Doc -&gt; m Doc) -&gt; m Doc -&gt; m Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">m Doc -&gt; m Doc
forall (m :: * -&gt; *). Functor m =&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#parens"><span class="hs-identifier hs-var">parens</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m Doc -&gt; m Doc) -&gt; m Doc -&gt; m Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681516821"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><span class="hs-comment">-- * Call pathes</span></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="annot"><span class="hs-comment">-- | Call paths.</span></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-comment">-- An old comment:</span><span>
</span><span id="line-574"></span><span class="hs-comment">--</span><span>
</span><span id="line-575"></span><span class="hs-comment">--   The call information is stored as free monoid</span><span>
</span><span id="line-576"></span><span class="hs-comment">--   over 'CallInfo'.  As long as we never look at it,</span><span>
</span><span id="line-577"></span><span class="hs-comment">--   only accumulate it, it does not matter whether we use</span><span>
</span><span id="line-578"></span><span class="hs-comment">--   'Set', (nub) list, or 'Tree'.</span><span>
</span><span id="line-579"></span><span class="hs-comment">--   Internally, due to lazyness, it is anyway a binary tree of</span><span>
</span><span id="line-580"></span><span class="hs-comment">--   'mappend' nodes and singleton leafs.</span><span>
</span><span id="line-581"></span><span class="hs-comment">--   Since we define no order on 'CallInfo' (expensive),</span><span>
</span><span id="line-582"></span><span class="hs-comment">--   we cannot use a 'Set' or nub list.</span><span>
</span><span id="line-583"></span><span class="hs-comment">--   Performance-wise, I could not see a difference between Set and list.</span><span>
</span><span id="line-584"></span><span class="hs-comment">--</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- If the binary tree is balanced &quot;incorrectly&quot;, then forcing it could</span><span>
</span><span id="line-586"></span><span class="hs-comment">-- be expensive, so a switch was made to difference lists.</span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="hs-keyword">newtype</span><span> </span><span id="CallPath"><span class="annot"><a href="Agda.Termination.Monad.html#CallPath"><span class="hs-identifier hs-var">CallPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CallPath"><span class="annot"><a href="Agda.Termination.Monad.html#CallPath"><span class="hs-identifier hs-var">CallPath</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DList</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CallInfo"><span class="hs-identifier hs-type">CallInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681516826"><span id="local-6989586621681516832"><span id="local-6989586621681516836"><span class="annot"><span class="annottext">Int -&gt; CallPath -&gt; ShowS
[CallPath] -&gt; ShowS
CallPath -&gt; String
(Int -&gt; CallPath -&gt; ShowS)
-&gt; (CallPath -&gt; String) -&gt; ([CallPath] -&gt; ShowS) -&gt; Show CallPath
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; CallPath -&gt; ShowS
showsPrec :: Int -&gt; CallPath -&gt; ShowS
$cshow :: CallPath -&gt; String
show :: CallPath -&gt; String
$cshowList :: [CallPath] -&gt; ShowS
showList :: [CallPath] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516840"><span id="local-6989586621681516845"><span id="local-6989586621681516851"><span class="annot"><span class="annottext">NonEmpty CallPath -&gt; CallPath
CallPath -&gt; CallPath -&gt; CallPath
(CallPath -&gt; CallPath -&gt; CallPath)
-&gt; (NonEmpty CallPath -&gt; CallPath)
-&gt; (forall b. Integral b =&gt; b -&gt; CallPath -&gt; CallPath)
-&gt; Semigroup CallPath
forall b. Integral b =&gt; b -&gt; CallPath -&gt; CallPath
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
$c&lt;&gt; :: CallPath -&gt; CallPath -&gt; CallPath
&lt;&gt; :: CallPath -&gt; CallPath -&gt; CallPath
$csconcat :: NonEmpty CallPath -&gt; CallPath
sconcat :: NonEmpty CallPath -&gt; CallPath
$cstimes :: forall b. Integral b =&gt; b -&gt; CallPath -&gt; CallPath
stimes :: forall b. Integral b =&gt; b -&gt; CallPath -&gt; CallPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681516860"><span id="local-6989586621681516865"><span id="local-6989586621681516869"><span class="annot"><span class="annottext">Semigroup CallPath
CallPath
Semigroup CallPath =&gt;
CallPath
-&gt; (CallPath -&gt; CallPath -&gt; CallPath)
-&gt; ([CallPath] -&gt; CallPath)
-&gt; Monoid CallPath
[CallPath] -&gt; CallPath
CallPath -&gt; CallPath -&gt; CallPath
forall a.
Semigroup a =&gt;
a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
$cmempty :: CallPath
mempty :: CallPath
$cmappend :: CallPath -&gt; CallPath -&gt; CallPath
mappend :: CallPath -&gt; CallPath -&gt; CallPath
$cmconcat :: [CallPath] -&gt; CallPath
mconcat :: [CallPath] -&gt; CallPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="annot"><span class="hs-comment">-- | The calls making up the call path.</span></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span class="annot"><a href="Agda.Termination.Monad.html#callInfos"><span class="hs-identifier hs-type">callInfos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#CallPath"><span class="hs-identifier hs-type">CallPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CallInfo"><span class="hs-identifier hs-type">CallInfo</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-594"></span><span id="callInfos"><span class="annot"><span class="annottext">callInfos :: CallPath -&gt; [CallInfo]
</span><a href="Agda.Termination.Monad.html#callInfos"><span class="hs-identifier hs-var hs-var">callInfos</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Termination.Monad.html#CallPath"><span class="hs-identifier hs-type">CallPath</span></a></span><span> </span><span id="local-6989586621681516874"><span class="annot"><span class="annottext">DList CallInfo
</span><a href="#local-6989586621681516874"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DList CallInfo -&gt; [CallInfo]
forall a. DList a -&gt; [a]
</span><span class="hs-identifier hs-var">DL.toList</span></span><span> </span><span class="annot"><span class="annottext">DList CallInfo
</span><a href="#local-6989586621681516874"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="annot"><span class="hs-comment">-- | Only show intermediate nodes.  (Drop last 'CallInfo').</span></span><span>
</span><span id="line-597"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681516879"><span id="local-6989586621681516883"><span class="annot"><a href="Agda.Syntax.Common.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#CallPath"><span class="hs-identifier hs-type">CallPath</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-598"></span><span>  </span><span id="local-6989586621681516894"><span class="annot"><span class="annottext">pretty :: CallPath -&gt; Doc
</span><a href="#local-6989586621681516894"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span id="local-6989586621681516896"><span class="annot"><span class="annottext">CallPath
</span><a href="#local-6989586621681516896"><span class="hs-identifier hs-var">cis0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[CallInfo] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[CallInfo]
</span><a href="#local-6989586621681516897"><span class="hs-identifier hs-var">cis</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Doc
forall a. Null a =&gt; a
</span><a href="Agda.Utils.Null.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-599"></span><span>    </span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
forall (t :: * -&gt; *). Foldable t =&gt; t Doc -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#hsep"><span class="hs-identifier hs-var">P.hsep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CallInfo -&gt; Doc) -&gt; [CallInfo] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516900"><span class="annot"><span class="annottext">CallInfo
</span><a href="#local-6989586621681516900"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681516901"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">P.&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">CallInfo -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">CallInfo
</span><a href="#local-6989586621681516900"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[CallInfo]
</span><a href="#local-6989586621681516897"><span class="hs-identifier hs-var">cis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Doc a -&gt; Doc a -&gt; Doc a
</span><span class="hs-operator hs-var">P.&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681516901"><span class="hs-identifier hs-var">arrow</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-601"></span><span>      </span><span id="local-6989586621681516897"><span class="annot"><span class="annottext">cis :: [CallInfo]
</span><a href="#local-6989586621681516897"><span class="hs-identifier hs-var hs-var">cis</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CallInfo] -&gt; [CallInfo]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">init</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CallPath -&gt; [CallInfo]
</span><a href="Agda.Termination.Monad.html#callInfos"><span class="hs-identifier hs-var">callInfos</span></a></span><span> </span><span class="annot"><span class="annottext">CallPath
</span><a href="#local-6989586621681516896"><span class="hs-identifier hs-var">cis0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>      </span><span id="local-6989586621681516901"><span class="annot"><span class="annottext">arrow :: Doc
</span><a href="#local-6989586621681516901"><span class="hs-identifier hs-var hs-var">arrow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc
</span><span class="hs-string">&quot;--&gt;&quot;</span></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="annot"><span class="hs-comment">-- * Size depth estimation</span></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">-- | A very crude way of estimating the @SIZELT@ chains</span><span>
</span><span id="line-607"></span><span class="hs-comment">--   @i &gt; j &gt; k@ in context.  Returns 3 in this case.</span><span>
</span><span id="line-608"></span><span class="hs-comment">--   Overapproximates.</span><span>
</span><span id="line-609"></span><span class="hs-keyword">class</span><span> </span><span id="TerSetSizeDepth"><span class="annot"><a href="Agda.Termination.Monad.html#TerSetSizeDepth"><span class="hs-identifier hs-var">TerSetSizeDepth</span></a></span></span><span> </span><span id="local-6989586621681515469"><span class="annot"><a href="#local-6989586621681515469"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-610"></span><span>  </span><span id="terSetSizeDepth"><span class="annot"><a href="Agda.Termination.Monad.html#terSetSizeDepth"><span class="hs-identifier hs-type">terSetSizeDepth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621681515467"><span class="annot"><a href="#local-6989586621681515469"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515467"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerM"><span class="hs-identifier hs-type">TerM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681515467"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerSetSizeDepth"><span class="hs-identifier hs-type">TerSetSizeDepth</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-613"></span><span>  </span><span id="local-6989586621681516911"><span class="annot"><span class="annottext">terSetSizeDepth :: forall a. Telescope -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetSizeDepth"><span class="hs-identifier hs-var hs-var hs-var hs-var">terSetSizeDepth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dom (String, Type)] -&gt; TerM a -&gt; TerM a
forall a. [Dom (String, Type)] -&gt; TerM a -&gt; TerM a
forall b a. TerSetSizeDepth b =&gt; b -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetSizeDepth"><span class="hs-identifier hs-var">terSetSizeDepth</span></a></span><span> </span><span class="annot"><span class="annottext">([Dom (String, Type)] -&gt; TerM a -&gt; TerM a)
-&gt; (Telescope -&gt; [Dom (String, Type)])
-&gt; Telescope
-&gt; TerM a
-&gt; TerM a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [Dom (String, Type)]
forall t. Tele (Dom t) -&gt; [Dom (String, t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- TODO: more precise analysis, constructing a tree</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- of relations between size variables.</span><span>
</span><span id="line-617"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Agda.Termination.Monad.html#TerSetSizeDepth"><span class="hs-identifier hs-type">TerSetSizeDepth</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ListTel"><span class="hs-identifier hs-type">ListTel</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-618"></span><span>  </span><span id="local-6989586621681516943"><span class="annot"><span class="annottext">terSetSizeDepth :: forall a. [Dom (String, Type)] -&gt; TerM a -&gt; TerM a
</span><a href="Agda.Termination.Monad.html#terSetSizeDepth"><span class="hs-identifier hs-var hs-var hs-var hs-var">terSetSizeDepth</span></a></span></span><span> </span><span id="local-6989586621681516944"><span class="annot"><span class="annottext">[Dom (String, Type)]
</span><a href="#local-6989586621681516944"><span class="hs-identifier hs-var">doms</span></a></span></span><span> </span><span id="local-6989586621681516945"><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516945"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>    </span><span id="local-6989586621681516946"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516946"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Int -&gt; TerM Int
forall a. TCM a -&gt; TerM a
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Int -&gt; TerM Int) -&gt; TCM Int -&gt; TerM Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; TCMT IO [Int] -&gt; TCM Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-620"></span><span>      </span><span class="annot"><span class="annottext">[Dom (String, Type)]
-&gt; (Dom (String, Type) -&gt; TCM Int) -&gt; TCMT IO [Int]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[Dom (String, Type)]
</span><a href="#local-6989586621681516944"><span class="hs-identifier hs-var">doms</span></a></span><span> </span><span class="annot"><span class="annottext">((Dom (String, Type) -&gt; TCM Int) -&gt; TCMT IO [Int])
-&gt; (Dom (String, Type) -&gt; TCM Int) -&gt; TCMT IO [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681516948"><span class="annot"><span class="annottext">Dom (String, Type)
</span><a href="#local-6989586621681516948"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-621"></span><span>        </span><span class="hs-comment">-- Andreas, 2022-03-12, TODO:</span><span>
</span><span id="line-622"></span><span>        </span><span class="hs-comment">-- use ifBlocked?  Shouldn't blocked types be treated like metas?</span><span>
</span><span id="line-623"></span><span>        </span><span id="local-6989586621681516949"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681516949"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Type
forall a (m :: * -&gt; *). (Reduce a, MonadReduce m) =&gt; a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#reduce"><span class="hs-identifier hs-var">reduce</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TCMT IO Type) -&gt; Type -&gt; TCMT IO Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String, Type) -&gt; Type) -&gt; (String, Type) -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom (String, Type) -&gt; (String, Type)
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom (String, Type)
</span><a href="#local-6989586621681516948"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-624"></span><span>        </span><span class="annot"><span class="annottext">TCM Bool -&gt; TCM Int -&gt; TCM Int -&gt; TCM Int
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe BoundedSize -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe BoundedSize -&gt; Bool)
-&gt; TCMT IO (Maybe BoundedSize) -&gt; TCM Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO (Maybe BoundedSize)
forall a (m :: * -&gt; *).
(IsSizeType a, HasOptions m, HasBuiltins m) =&gt;
a -&gt; m (Maybe BoundedSize)
forall (m :: * -&gt; *).
(HasOptions m, HasBuiltins m) =&gt;
Type -&gt; m (Maybe BoundedSize)
</span><a href="Agda.TypeChecking.Monad.SizedTypes.html#isSizeType"><span class="hs-identifier hs-var">isSizeType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681516949"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TCM Int
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">{- else -}</span><span> </span><span class="annot"><span class="annottext">(TCM Int -&gt; TCM Int) -&gt; TCM Int -&gt; TCM Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-625"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Term
forall t a. Type'' t a -&gt; a
</span><a href="Agda.Syntax.Internal.html#unEl"><span class="hs-identifier hs-var">unEl</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681516949"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-626"></span><span>            </span><span class="annot"><a href="Agda.Syntax.Internal.html#MetaV"><span class="hs-identifier hs-type">MetaV</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TCM Int
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-627"></span><span>            </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; TCM Int
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><span class="annottext">(TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall a. (TerEnv -&gt; TerEnv) -&gt; TerM a -&gt; TerM a
forall (m :: * -&gt; *) a.
MonadTer m =&gt;
(TerEnv -&gt; TerEnv) -&gt; m a -&gt; m a
</span><a href="Agda.Termination.Monad.html#terLocal"><span class="hs-identifier hs-var">terLocal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' TerEnv Int -&gt; LensSet TerEnv Int
forall o i. Lens' o i -&gt; LensSet o i
</span><a href="Agda.Utils.Lens.html#set"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f Int) -&gt; TerEnv -&gt; f TerEnv
Lens' TerEnv Int
</span><a href="Agda.Termination.Monad.html#terSizeDepth"><span class="hs-identifier hs-var">terSizeDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681516946"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TerM a
</span><a href="#local-6989586621681516945"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-629"></span></pre></body></html>