<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wunused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NondecreasingIndentation   #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.TypeChecking.Rules.Record</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">not</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(||)</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html"><span class="hs-identifier">Agda.Syntax.Abstract</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html"><span class="hs-identifier">Agda.Syntax.Abstract.Views</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Position.html"><span class="hs-identifier">Agda.Syntax.Position</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Info.html"><span class="hs-identifier">Agda.Syntax.Info</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Info</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.html"><span class="hs-identifier">Agda.TypeChecking.Monad</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.html"><span class="hs-identifier">Agda.TypeChecking.Primitive</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html"><span class="hs-identifier">Agda.TypeChecking.Positivity.Occurrence</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Polarity.html"><span class="hs-identifier">Agda.TypeChecking.Polarity</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html"><span class="hs-identifier">Agda.TypeChecking.CompiledClause</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html#hasProjectionPatterns"><span class="hs-identifier">hasProjectionPatterns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.Compile.html"><span class="hs-identifier">Agda.TypeChecking.CompiledClause.Compile</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.InstanceArguments.html"><span class="hs-identifier">Agda.TypeChecking.InstanceArguments</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Data</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#getGeneralizedParameters"><span class="hs-identifier">getGeneralizedParameters</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#bindGeneralizedParameters"><span class="hs-identifier">bindGeneralizedParameters</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#bindParameters"><span class="hs-identifier">bindParameters</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#checkDataSort"><span class="hs-identifier">checkDataSort</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#fitsIn"><span class="hs-identifier">fitsIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#forceSort"><span class="hs-identifier">forceSort</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#defineCompData"><span class="hs-identifier">defineCompData</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Data.html#defineKanOperationForFields"><span class="hs-identifier">defineKanOperationForFields</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Term.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Term</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Term.html#isType_"><span class="hs-identifier">isType_</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-pragma">{-# SOURCE</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Rules.Decl.html"><span class="hs-identifier">Agda.TypeChecking.Rules.Decl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Rules.Decl.html#checkDecl"><span class="hs-identifier">checkDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Boolean.html"><span class="hs-identifier">Agda.Utils.Boolean</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier">applyWhen</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.List.html#headWithDefault"><span class="hs-identifier">headWithDefault</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Null.html"><span class="hs-identifier">Agda.Utils.Null</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.POMonoid.html"><span class="hs-identifier">Agda.Utils.POMonoid</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">render</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.Pretty.html"><span class="hs-identifier">Agda.Syntax.Common.Pretty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Size.html"><span class="hs-identifier">Agda.Utils.Size</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-57"></span><span class="annot"><span class="hs-comment">-- * Records</span></span><span>
</span><span id="line-58"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- | @checkRecDef i name con ps contel fields@</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">--     [@name@]    Record type identifier.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">--     [@con@]     Maybe constructor name and info.</span><span>
</span><span id="line-65"></span><span class="hs-comment">--</span><span>
</span><span id="line-66"></span><span class="hs-comment">--     [@ps@]      Record parameters.</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">--     [@contel@]  Approximate type of constructor (@fields@ -&gt; dummy).</span><span>
</span><span id="line-69"></span><span class="hs-comment">--                 Does not include record parameters.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">--     [@fields@]  List of field signatures.</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#checkRecDef"><span class="hs-identifier hs-type">checkRecDef</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DefInfo"><span class="hs-identifier hs-type">A.DefInfo</span></a></span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ Position and other info.</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>                     </span><span class="annot"><span class="hs-comment">-- ^ Record type identifier.</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#UniverseCheck"><span class="hs-identifier hs-type">UniverseCheck</span></a></span><span>             </span><span class="annot"><span class="hs-comment">-- ^ Check universes?</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#RecordDirectives"><span class="hs-identifier hs-type">A.RecordDirectives</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ (Co)Inductive, (No)Eta, (Co)Pattern, Constructor?</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#DataDefParams"><span class="hs-identifier hs-type">A.DataDefParams</span></a></span><span>           </span><span class="annot"><span class="hs-comment">-- ^ Record parameters.</span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Expr"><span class="hs-identifier hs-type">A.Expr</span></a></span><span>                    </span><span class="hs-comment">-- ^ Approximate type of constructor (@fields@ -&gt; dummy).</span><span>
</span><span id="line-80"></span><span>                               </span><span class="hs-comment">--   Does not include record parameters.</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Field"><span class="hs-identifier hs-type">A.Field</span></a></span><span class="hs-special">]</span><span>                 </span><span class="annot"><span class="hs-comment">-- ^ Field signatures.</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="checkRecDef"><span class="annot"><span class="annottext">checkRecDef :: DefInfo
-&gt; QName
-&gt; UniverseCheck
-&gt; RecordDirectives
-&gt; DataDefParams
-&gt; Expr
-&gt; [Field]
-&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Record.html#checkRecDef"><span class="hs-identifier hs-var hs-var">checkRecDef</span></a></span></span><span> </span><span id="local-6989586621681616098"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616098"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681616099"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681616100"><span class="annot"><span class="annottext">UniverseCheck
</span><a href="#local-6989586621681616100"><span class="hs-identifier hs-var">uc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#RecordDirectives"><span class="hs-identifier hs-type">RecordDirectives</span></a></span><span> </span><span id="local-6989586621681616102"><span class="annot"><span class="annottext">Maybe (Ranged Induction)
</span><a href="#local-6989586621681616102"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621681616103"><span class="annot"><span class="annottext">Maybe HasEta0
</span><a href="#local-6989586621681616103"><span class="hs-identifier hs-var">eta0</span></a></span></span><span> </span><span id="local-6989586621681616104"><span class="annot"><span class="annottext">Maybe Range
</span><a href="#local-6989586621681616104"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681616105"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681616105"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#DataDefParams"><span class="hs-identifier hs-type">A.DataDefParams</span></a></span><span> </span><span id="local-6989586621681616107"><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621681616107"><span class="hs-identifier hs-var">gpars</span></a></span></span><span> </span><span id="local-6989586621681616108"><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621681616108"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681616109"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681616109"><span class="hs-identifier hs-var">contel0</span></a></span></span><span> </span><span id="local-6989586621681616110"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616110"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- Andreas, 2022-10-06, issue #6165:</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">-- The target type of the constructor is a meaningless dummy expression which does not type-check.</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">-- We replace it by Set/Type (builtinSet) which is still incorrect but type-checks.</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- It will be fixed after type-checking.</span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621681616111"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681616111"><span class="hs-identifier hs-var">aType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Expr
</span><a href="Agda.Syntax.Abstract.html#Def"><span class="hs-identifier hs-var">A.Def</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Expr) -&gt; (Maybe QName -&gt; QName) -&gt; Maybe QName -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName -&gt; QName
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">QName
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe QName -&gt; Expr) -&gt; TCMT IO (Maybe QName) -&gt; TCMT IO Expr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *). HasBuiltins m =&gt; BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getBuiltinName%27"><span class="hs-identifier hs-var">getBuiltinName'</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinSet"><span class="hs-identifier hs-var">builtinSet</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616119"><span class="annot"><span class="annottext">contel :: Expr
</span><a href="#local-6989586621681616119"><span class="hs-identifier hs-var hs-var">contel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PiView -&gt; Expr
</span><a href="Agda.Syntax.Abstract.Views.html#unPiView"><span class="hs-identifier hs-var">A.unPiView</span></a></span><span> </span><span class="annot"><span class="annottext">(PiView -&gt; Expr) -&gt; (Expr -&gt; PiView) -&gt; Expr -&gt; Expr
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.Views.html#PiView"><span class="hs-identifier hs-type">A.PiView</span></a></span><span> </span><span id="local-6989586621681616122"><span class="annot"><span class="annottext">[(ExprInfo, Telescope1)]
</span><a href="#local-6989586621681616122"><span class="hs-identifier hs-var">tels</span></a></span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(ExprInfo, Telescope1)] -&gt; Expr -&gt; PiView
</span><a href="Agda.Syntax.Abstract.Views.html#PiView"><span class="hs-identifier hs-var">A.PiView</span></a></span><span> </span><span class="annot"><span class="annottext">[(ExprInfo, Telescope1)]
</span><a href="#local-6989586621681616122"><span class="hs-identifier hs-var">tels</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681616111"><span class="hs-identifier hs-var">aType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PiView -&gt; PiView) -&gt; (Expr -&gt; PiView) -&gt; Expr -&gt; PiView
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; PiView
</span><a href="Agda.Syntax.Abstract.Views.html#piView"><span class="hs-identifier hs-var">A.piView</span></a></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr) -&gt; Expr -&gt; Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681616109"><span class="hs-identifier hs-var">contel0</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="annottext">Call -&gt; TCM () -&gt; TCM ()
forall a. Call -&gt; TCMT IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadTrace m =&gt; Call -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#traceCall"><span class="hs-identifier hs-var">traceCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; [LamBinding] -&gt; [Field] -&gt; Call
</span><a href="Agda.TypeChecking.Monad.Base.html#CheckRecDef"><span class="hs-identifier hs-var">CheckRecDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621681616108"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616110"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking record def&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ps =&quot;</span></span><span>     </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Semigroup (m Doc), Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyList"><span class="hs-identifier hs-var">prettyList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LamBinding -&gt; TCMT IO Doc) -&gt; [LamBinding] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">LamBinding -&gt; TCMT IO Doc
forall a (m :: * -&gt; *).
(ToConcrete a, Pretty (ConOfAbs a), MonadAbsToCon m) =&gt;
a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyA"><span class="hs-identifier hs-var">prettyA</span></a></span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621681616108"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;contel =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; TCMT IO Doc
forall a (m :: * -&gt; *).
(ToConcrete a, Pretty (ConOfAbs a), MonadAbsToCon m) =&gt;
a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyA"><span class="hs-identifier hs-var">prettyA</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681616119"><span class="hs-identifier hs-var">contel</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;fields =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Constr Field] -&gt; TCMT IO Doc
forall a (m :: * -&gt; *).
(ToConcrete a, Pretty (ConOfAbs a), MonadAbsToCon m) =&gt;
a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyA"><span class="hs-identifier hs-var">prettyA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Field -&gt; Constr Field) -&gt; [Field] -&gt; [Constr Field]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Field -&gt; Constr Field
forall a. a -&gt; Constr a
</span><a href="Agda.Syntax.Common.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616110"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">-- get type of record</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621681616135"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681616135"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; TCMT IO Definition
forall (m :: * -&gt; *).
(Functor m, HasConstInfo m, HasOptions m, ReadTCState m,
 MonadTCEnv m, MonadDebug m) =&gt;
Definition -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#instantiateDef"><span class="hs-identifier hs-var">instantiateDef</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; TCMT IO Definition)
-&gt; TCMT IO Definition -&gt; TCMT IO Definition
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621681616139"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616139"><span class="hs-identifier hs-var">t</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Type
forall a (m :: * -&gt; *).
(InstantiateFull a, MonadReduce m) =&gt;
a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier hs-var">instantiateFull</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TCMT IO Type) -&gt; Type -&gt; TCMT IO Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681616135"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616142"><span class="annot"><span class="annottext">npars :: Nat
</span><a href="#local-6989586621681616142"><span class="hs-identifier hs-var hs-var">npars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681616135"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span> </span><span id="local-6989586621681616145"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616145"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616145"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Nat
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- If the record type is erased, then hard compile-time mode is</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-comment">-- entered.</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">Definition -&gt; TCM () -&gt; TCM ()
forall q a. LensQuantity q =&gt; q -&gt; TCM a -&gt; TCM a
</span><a href="Agda.TypeChecking.Monad.Signature.html#setHardCompileTimeModeIfErased%27"><span class="hs-identifier hs-var">setHardCompileTimeModeIfErased'</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681616135"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621681616147"><span class="annot"><span class="annottext">[Maybe Name]
</span><a href="#local-6989586621681616147"><span class="hs-identifier hs-var">parNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; QName -&gt; TCM [Maybe Name]
</span><a href="Agda.TypeChecking.Rules.Data.html#getGeneralizedParameters"><span class="hs-identifier hs-var">getGeneralizedParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621681616107"><span class="hs-identifier hs-var">gpars</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><span class="annottext">[Maybe Name] -&gt; Type -&gt; (Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ()
forall a.
[Maybe Name] -&gt; Type -&gt; (Telescope -&gt; Type -&gt; TCM a) -&gt; TCM a
</span><a href="Agda.TypeChecking.Rules.Data.html#bindGeneralizedParameters"><span class="hs-identifier hs-var">bindGeneralizedParameters</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Name]
</span><a href="#local-6989586621681616147"><span class="hs-identifier hs-var">parNames</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616139"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">((Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ())
-&gt; (Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681616148"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616148"><span class="hs-identifier hs-var">gtel</span></a></span></span><span> </span><span id="local-6989586621681616149"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616149"><span class="hs-identifier hs-var">t0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-114"></span><span>     </span><span class="annot"><span class="annottext">Nat
-&gt; [LamBinding] -&gt; Type -&gt; (Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ()
forall a.
Nat
-&gt; [LamBinding] -&gt; Type -&gt; (Telescope -&gt; Type -&gt; TCM a) -&gt; TCM a
</span><a href="Agda.TypeChecking.Rules.Data.html#bindParameters"><span class="hs-identifier hs-var">bindParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616142"><span class="hs-identifier hs-var">npars</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Name] -&gt; Nat
forall a. [a] -&gt; Nat
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Nat
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Name]
</span><a href="#local-6989586621681616147"><span class="hs-identifier hs-var">parNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LamBinding]
</span><a href="#local-6989586621681616108"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616149"><span class="hs-identifier hs-var">t0</span></a></span><span> </span><span class="annot"><span class="annottext">((Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ())
-&gt; (Telescope -&gt; Type -&gt; TCM ()) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681616151"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616151"><span class="hs-identifier hs-var">ptel</span></a></span></span><span> </span><span id="local-6989586621681616152"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616152"><span class="hs-identifier hs-var">t0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616153"><span class="annot"><span class="annottext">tel :: Telescope
</span><a href="#local-6989586621681616153"><span class="hs-identifier hs-var hs-var">tel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616148"><span class="hs-identifier hs-var">gtel</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616151"><span class="hs-identifier hs-var">ptel</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-comment">-- Generate type of constructor from field telescope @contel@,</span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-comment">-- which is the approximate constructor type (target missing).</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-comment">-- Check and evaluate field types.</span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking fields&quot;</span></span><span>
</span><span id="line-123"></span><span>      </span><span id="local-6989586621681616155"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616155"><span class="hs-identifier hs-var">contype</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Type -&gt; TCMT IO Type
forall (m :: * -&gt; *) a.
(MonadTCEnv m, HasOptions m, MonadDebug m) =&gt;
m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Modality.html#workOnTypes"><span class="hs-identifier hs-var">workOnTypes</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Type -&gt; TCMT IO Type) -&gt; TCMT IO Type -&gt; TCMT IO Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Type
forall a (m :: * -&gt; *).
(InstantiateFull a, MonadReduce m) =&gt;
a -&gt; m a
</span><a href="Agda.TypeChecking.Reduce.html#instantiateFull"><span class="hs-identifier hs-var">instantiateFull</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TCMT IO Type) -&gt; TCMT IO Type -&gt; TCMT IO Type
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; TCMT IO Type
</span><a href="Agda.TypeChecking.Rules.Term.html#isType_"><span class="hs-identifier hs-var">isType_</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621681616119"><span class="hs-identifier hs-var">contel</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;contype = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616155"><span class="hs-identifier hs-var">contype</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-comment">-- compute the field telescope (does not include record parameters)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier hs-type">TelV</span></a></span><span> </span><span id="local-6989586621681616158"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TelV Type
</span><a href="Agda.TypeChecking.Substitute.html#telView%27"><span class="hs-identifier hs-var">telView'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616155"><span class="hs-identifier hs-var">contype</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-comment">-- Compute correct type of constructor</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-comment">-- t = tel -&gt; t0 where t0 must be a sort s</span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html#TelV"><span class="hs-identifier hs-type">TelV</span></a></span><span> </span><span id="local-6989586621681616160"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616160"><span class="hs-identifier hs-var">idxTel</span></a></span></span><span> </span><span id="local-6989586621681616161"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616161"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO (TelV Type)
forall (m :: * -&gt; *).
(MonadReduce m, MonadAddContext m) =&gt;
Type -&gt; m (TelV Type)
</span><a href="Agda.TypeChecking.Telescope.html#telView"><span class="hs-identifier hs-var">telView</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616152"><span class="hs-identifier hs-var">t0</span></a></span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616160"><span class="hs-identifier hs-var">idxTel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeError -&gt; TCM ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM ()) -&gt; TypeError -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#ShouldBeASort"><span class="hs-identifier hs-var">ShouldBeASort</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616152"><span class="hs-identifier hs-var">t0</span></a></span><span>
</span><span id="line-135"></span><span>      </span><span id="local-6989586621681616167"><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681616167"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCM Sort
</span><a href="Agda.TypeChecking.Rules.Data.html#forceSort"><span class="hs-identifier hs-var">forceSort</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616161"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-comment">-- needed for impredicative Prop (not implemented yet)</span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-comment">-- ftel &lt;- return $</span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-comment">--   if s == Prop</span><span>
</span><span id="line-140"></span><span>      </span><span class="hs-comment">--   then telFromList $ map (setRelevance Irrelevant) $ telToList ftel</span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-comment">--   else ftel</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>        </span><span id="local-6989586621681616168"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616168"><span class="hs-identifier hs-var">gamma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Telescope
forall (m :: * -&gt; *). (Applicative m, MonadTCEnv m) =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span>  </span><span class="hs-comment">-- the record params (incl. module params)</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;gamma = &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616168"><span class="hs-identifier hs-var">gamma</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-comment">-- record type (name applied to parameters)</span><span>
</span><span id="line-148"></span><span>      </span><span id="local-6989586621681616171"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616171"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Sort -&gt; Term -&gt; Type
forall t a. Sort' t -&gt; a -&gt; Type'' t a
</span><a href="Agda.Syntax.Internal.html#El"><span class="hs-identifier hs-var">El</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681616167"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Type) -&gt; ([Arg Term] -&gt; Term) -&gt; [Arg Term] -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Def"><span class="hs-identifier hs-var">Def</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Elims -&gt; Term) -&gt; ([Arg Term] -&gt; Elims) -&gt; [Arg Term] -&gt; Term
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; Elim) -&gt; [Arg Term] -&gt; Elims
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Arg Term -&gt; Elim
forall a. Arg a -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg Term] -&gt; Type) -&gt; TCMT IO [Arg Term] -&gt; TCMT IO Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO [Arg Term]
forall (m :: * -&gt; *). (Applicative m, MonadTCEnv m) =&gt; m [Arg Term]
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextArgs"><span class="hs-identifier hs-var">getContextArgs</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-comment">-- Put in @rect@ as correct target of constructor type.</span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-comment">-- Andreas, 2011-05-10 use telePi_ instead of telePi to preserve</span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-comment">-- even names of non-dependent fields in constructor type (Issue 322).</span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616176"><span class="annot"><span class="annottext">contype :: Type
</span><a href="#local-6989586621681616176"><span class="hs-identifier hs-var hs-var">contype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Type -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#telePi_"><span class="hs-identifier hs-var">telePi_</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Type -&gt; Type
forall a. Subst a =&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616171"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-comment">-- NB: contype does not contain the parameter telescope</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-comment">-- Obtain name of constructor (if present).</span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681616180"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616180"><span class="hs-identifier hs-var">hasNamedCon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616181"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616181"><span class="hs-identifier hs-var">conName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681616105"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681616182"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616182"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Bool, QName) -&gt; TCMT IO (Bool, QName)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616182"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">Maybe QName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>          </span><span id="local-6989586621681616183"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616183"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KillRangeT ModuleName
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">KillRangeT ModuleName -&gt; TCMT IO ModuleName -&gt; TCMT IO ModuleName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO ModuleName
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m ModuleName
</span><a href="Agda.TypeChecking.Monad.Env.html#currentModule"><span class="hs-identifier hs-var">currentModule</span></a></span><span>
</span><span id="line-161"></span><span>          </span><span class="hs-comment">-- Andreas, 2020-06-01, AIM XXXII</span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-comment">-- Using prettyTCM here jinxes the printer, see PR #4699.</span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-comment">-- r &lt;- prettyTCM name</span><span>
</span><span id="line-164"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616186"><span class="annot"><span class="annottext">r :: Doc
</span><a href="#local-6989586621681616186"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Doc) -&gt; Name -&gt; Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-165"></span><span>          </span><span id="local-6989586621681616189"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616189"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#qualify"><span class="hs-identifier hs-var">qualify</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616183"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; TCMT IO Name -&gt; TCMT IO QName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Name
forall a (m :: * -&gt; *).
(FreshName a, MonadFresh NameId m) =&gt;
a -&gt; m Name
forall (m :: * -&gt; *). MonadFresh NameId m =&gt; [Char] -&gt; m Name
</span><a href="Agda.TypeChecking.Monad.Base.html#freshName_"><span class="hs-identifier hs-var">freshName_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; [Char]
forall a. Doc a -&gt; [Char]
</span><span class="hs-identifier hs-var">render</span></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="#local-6989586621681616186"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.constructor&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>          </span><span class="annot"><span class="annottext">(Bool, QName) -&gt; TCMT IO (Bool, QName)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616189"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-comment">-- Add record type to signature.</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;adding record type to signature&quot;</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>      </span><span id="local-6989586621681616192"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616192"><span class="hs-identifier hs-var">etaenabled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Bool
forall (m :: * -&gt; *). HasOptions m =&gt; m Bool
</span><a href="Agda.TypeChecking.Monad.Options.html#etaEnabled"><span class="hs-identifier hs-var">etaEnabled</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681616194"><span class="hs-identifier hs-type">getName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>          </span><span id="local-6989586621681616194"><span class="annot"><span class="annottext">getName :: Field -&gt; [Dom' Term QName]
</span><a href="#local-6989586621681616194"><span class="hs-identifier hs-var hs-var">getName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Field"><span class="hs-identifier hs-type">A.Field</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681616197"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616197"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681616198"><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621681616198"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616197"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Dom' Term Expr -&gt; Dom' Term QName
forall a b. a -&gt; Dom' Term b -&gt; Dom' Term a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Arg Expr -&gt; Dom' Term Expr
forall a. Arg a -&gt; Dom a
</span><a href="Agda.Syntax.Internal.html#domFromArg"><span class="hs-identifier hs-var">domFromArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><a href="#local-6989586621681616198"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>          </span><span class="annot"><a href="#local-6989586621681616194"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#ScopedDecl"><span class="hs-identifier hs-type">A.ScopedDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621681616202"><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621681616202"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Field -&gt; [Dom' Term QName]
</span><a href="#local-6989586621681616194"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621681616202"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-176"></span><span>          </span><span class="annot"><a href="#local-6989586621681616194"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Field
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>          </span><span id="local-6989586621681616203"><span class="annot"><span class="annottext">setTactic :: Dom' t e -&gt; Dom' t e -&gt; Dom' t e
</span><a href="#local-6989586621681616203"><span class="hs-identifier hs-var hs-var">setTactic</span></a></span></span><span> </span><span id="local-6989586621681616204"><span class="annot"><span class="annottext">Dom' t e
</span><a href="#local-6989586621681616204"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681616205"><span class="annot"><span class="annottext">Dom' t e
</span><a href="#local-6989586621681616205"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dom' t e
</span><a href="#local-6989586621681616205"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#domTactic"><span class="hs-identifier hs-var">domTactic</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#domTactic"><span class="hs-identifier hs-var">domTactic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681616204"><span class="hs-identifier hs-type">dom</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>          </span><span id="local-6989586621681616207"><span class="annot"><span class="annottext">fs :: [Dom' Term QName]
</span><a href="#local-6989586621681616207"><span class="hs-identifier hs-var hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dom ([Char], Type) -&gt; Dom' Term QName -&gt; Dom' Term QName)
-&gt; [Dom ([Char], Type)] -&gt; [Dom' Term QName] -&gt; [Dom' Term QName]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Dom ([Char], Type) -&gt; Dom' Term QName -&gt; Dom' Term QName
forall {t} {e} {t} {e}. Dom' t e -&gt; Dom' t e -&gt; Dom' t e
</span><a href="#local-6989586621681616203"><span class="hs-identifier hs-var">setTactic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; [Dom ([Char], Type)]
forall t. Tele (Dom t) -&gt; [Dom ([Char], t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dom' Term QName] -&gt; [Dom' Term QName])
-&gt; [Dom' Term QName] -&gt; [Dom' Term QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Field -&gt; [Dom' Term QName]) -&gt; [Field] -&gt; [Dom' Term QName]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Field -&gt; [Dom' Term QName]
</span><a href="#local-6989586621681616194"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616110"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>          </span><span class="hs-comment">-- indCo is what the user wrote: inductive/coinductive/Nothing.</span><span>
</span><span id="line-183"></span><span>          </span><span class="hs-comment">-- We drop the Range.</span><span>
</span><span id="line-184"></span><span>          </span><span id="local-6989586621681616211"><span class="annot"><span class="annottext">indCo :: Maybe Induction
</span><a href="#local-6989586621681616211"><span class="hs-identifier hs-var hs-var">indCo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ranged Induction -&gt; Induction
forall a. Ranged a -&gt; a
</span><a href="Agda.Syntax.Common.html#rangedThing"><span class="hs-identifier hs-var">rangedThing</span></a></span><span> </span><span class="annot"><span class="annottext">(Ranged Induction -&gt; Induction)
-&gt; Maybe (Ranged Induction) -&gt; Maybe Induction
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Ranged Induction)
</span><a href="#local-6989586621681616102"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-185"></span><span>          </span><span class="hs-comment">-- A constructor is inductive unless declared coinductive.</span><span>
</span><span id="line-186"></span><span>          </span><span id="local-6989586621681616213"><span class="annot"><span class="annottext">conInduction :: Induction
</span><a href="#local-6989586621681616213"><span class="hs-identifier hs-var hs-var">conInduction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Maybe Induction -&gt; Induction
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621681616211"><span class="hs-identifier hs-var">indCo</span></a></span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-comment">-- Andreas, 2016-09-20, issue #2197.</span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-comment">-- Eta is inferred by the positivity checker.</span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-comment">-- We should turn it off until it is proven to be safe.</span><span>
</span><span id="line-190"></span><span>          </span><span id="local-6989586621681616215"><span class="annot"><span class="annottext">haveEta :: EtaEquality
</span><a href="#local-6989586621681616215"><span class="hs-identifier hs-var hs-var">haveEta</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EtaEquality
-&gt; (HasEta -&gt; EtaEquality) -&gt; Maybe HasEta -&gt; EtaEquality
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasEta -&gt; EtaEquality
</span><a href="Agda.TypeChecking.Monad.Base.html#Inferred"><span class="hs-identifier hs-var">Inferred</span></a></span><span> </span><span class="annot"><span class="annottext">(HasEta -&gt; EtaEquality) -&gt; HasEta -&gt; EtaEquality
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; HasEta
forall a. a -&gt; HasEta' a
</span><a href="Agda.Syntax.Common.html#NoEta"><span class="hs-identifier hs-var">NoEta</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="#local-6989586621681616219"><span class="hs-identifier hs-var">patCopat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HasEta -&gt; EtaEquality
</span><a href="Agda.TypeChecking.Monad.Base.html#Specified"><span class="hs-identifier hs-var">Specified</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HasEta
</span><a href="#local-6989586621681616221"><span class="hs-identifier hs-var">eta</span></a></span><span>
</span><span id="line-191"></span><span>          </span><span class="hs-comment">-- haveEta      = maybe (Inferred $ conInduction == Inductive &amp;&amp; etaenabled) Specified eta</span><span>
</span><span id="line-192"></span><span>          </span><span id="local-6989586621681616222"><span class="annot"><span class="annottext">con :: ConHead
</span><a href="#local-6989586621681616222"><span class="hs-identifier hs-var hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; DataOrRecord -&gt; Induction -&gt; [Arg QName] -&gt; ConHead
</span><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-var">ConHead</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616181"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; DataOrRecord
forall p. p -&gt; DataOrRecord' p
</span><a href="Agda.Syntax.Internal.html#IsRecord"><span class="hs-identifier hs-var">IsRecord</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="#local-6989586621681616219"><span class="hs-identifier hs-var">patCopat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681616213"><span class="hs-identifier hs-var">conInduction</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg QName] -&gt; ConHead) -&gt; [Arg QName] -&gt; ConHead
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dom' Term QName -&gt; Arg QName) -&gt; [Dom' Term QName] -&gt; [Arg QName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dom' Term QName -&gt; Arg QName
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom' Term QName]
</span><a href="#local-6989586621681616207"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-comment">-- A record is irrelevant if all of its fields are.</span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-comment">-- In this case, the associated module parameter will be irrelevant.</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-comment">-- See issue 392.</span><span>
</span><span id="line-197"></span><span>          </span><span class="hs-comment">-- Unless it's been declared coinductive or no-eta-equality (#2607).</span><span>
</span><span id="line-198"></span><span>          </span><span id="local-6989586621681616226"><span class="annot"><span class="annottext">recordRelevance :: Relevance
</span><a href="#local-6989586621681616226"><span class="hs-identifier hs-var hs-var">recordRelevance</span></a></span></span><span>
</span><span id="line-199"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#NoEta"><span class="hs-identifier hs-type">NoEta</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HasEta
</span><a href="#local-6989586621681616221"><span class="hs-identifier hs-var">eta</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Relevant"><span class="hs-identifier hs-var">Relevant</span></a></span><span>
</span><span id="line-200"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#CoInductive"><span class="hs-identifier hs-var">CoInductive</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681616213"><span class="hs-identifier hs-var">conInduction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Relevant"><span class="hs-identifier hs-var">Relevant</span></a></span><span>
</span><span id="line-201"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Relevance] -&gt; Relevance
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimum</span></span><span> </span><span class="annot"><span class="annottext">([Relevance] -&gt; Relevance) -&gt; [Relevance] -&gt; Relevance
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Irrelevant"><span class="hs-identifier hs-var">Irrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; [Relevance] -&gt; [Relevance]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(Dom ([Char], Type) -&gt; Relevance)
-&gt; [Dom ([Char], Type)] -&gt; [Relevance]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dom ([Char], Type) -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; [Dom ([Char], Type)]
forall t. Tele (Dom t) -&gt; [Dom ([Char], t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-comment">-- Andreas, 2017-01-26, issue #2436</span><span>
</span><span id="line-204"></span><span>      </span><span class="hs-comment">-- Disallow coinductive records with eta-equality</span><span>
</span><span id="line-205"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681616213"><span class="hs-identifier hs-var">conInduction</span></a></span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Induction -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#CoInductive"><span class="hs-identifier hs-var">CoInductive</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Boolean a =&gt; a -&gt; a -&gt; a
</span><a href="Agda.Utils.Boolean.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">EtaEquality -&gt; HasEta
</span><a href="Agda.TypeChecking.Monad.Base.html#theEtaEquality"><span class="hs-identifier hs-var">theEtaEquality</span></a></span><span> </span><span class="annot"><span class="annottext">EtaEquality
</span><a href="#local-6989586621681616215"><span class="hs-identifier hs-var">haveEta</span></a></span><span> </span><span class="annot"><span class="annottext">HasEta -&gt; HasEta -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">HasEta
forall a. HasEta' a
</span><a href="Agda.Syntax.Common.html#YesEta"><span class="hs-identifier hs-var">YesEta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">TypeError -&gt; TCM ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError -&gt; TCM ()) -&gt; (Doc -&gt; TypeError) -&gt; Doc -&gt; TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericDocError"><span class="hs-identifier hs-var">GenericDocError</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>          </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;Agda doesn't like coinductive records with eta-equality.&quot;</span></span><span>
</span><span id="line-208"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;If you must, use pragma&quot;</span></span><span>
</span><span id="line-209"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;{-# ETA&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;#-}&quot;</span></span><span>
</span><span id="line-210"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;record constructor is &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; ConHead -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616222"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-comment">-- Jesper, 2021-05-26: Warn when declaring coinductive record</span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-comment">-- but neither --guardedness nor --sized-types is enabled.</span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621681616213"><span class="hs-identifier hs-var">conInduction</span></a></span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Induction -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#CoInductive"><span class="hs-identifier hs-var">CoInductive</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Bool -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#unlessM"><span class="hs-identifier hs-var">unlessM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optGuardedness"><span class="hs-identifier hs-var">optGuardedness</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool)
-&gt; (PragmaOptions -&gt; Bool) -&gt; PragmaOptions -&gt; Bool
forall a. Boolean a =&gt; a -&gt; a -&gt; a
</span><a href="Agda.Utils.Boolean.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optSizedTypes"><span class="hs-identifier hs-var">optSizedTypes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; TCMT IO PragmaOptions -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-217"></span><span>          </span><span class="annot"><span class="annottext">Warning -&gt; TCM ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; TCM ()) -&gt; Warning -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#NoGuardednessFlag"><span class="hs-identifier hs-var">NoGuardednessFlag</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-comment">-- Add the record definition.</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-comment">-- Andreas, 2016-06-17, Issue #2018:</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-comment">-- Do not rely on @addConstant@ to put in the record parameters,</span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-comment">-- as they might be renamed in the context.</span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-comment">-- By putting them ourselves (e.g. by using the original type @t@)</span><span>
</span><span id="line-225"></span><span>      </span><span class="hs-comment">-- we make sure we get the original names!</span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616245"><span class="annot"><span class="annottext">npars :: Nat
</span><a href="#local-6989586621681616245"><span class="hs-identifier hs-var hs-var">npars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616153"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-227"></span><span>          </span><span id="local-6989586621681616246"><span class="annot"><span class="annottext">telh :: Telescope
</span><a href="#local-6989586621681616246"><span class="hs-identifier hs-var hs-var">telh</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; Tele a -&gt; Tele b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Dom Type
forall a. (LensHiding a, LensRelevance a) =&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Monad.Modality.html#hideAndRelParams"><span class="hs-identifier hs-var">hideAndRelParams</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616153"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616245"><span class="hs-identifier hs-var">npars</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>        </span><span class="annot"><span class="annottext">QName -&gt; ArgInfo -&gt; QName -&gt; Type -&gt; Defn -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#addConstant%27"><span class="hs-identifier hs-var">addConstant'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616139"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; TCM ()) -&gt; Defn -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-230"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span>
</span><span id="line-231"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recPars :: Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#recPars"><span class="hs-identifier hs-var">recPars</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616245"><span class="hs-identifier hs-var">npars</span></a></span><span>
</span><span id="line-232"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recClause :: Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#recClause"><span class="hs-identifier hs-var">recClause</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Clause
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-233"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recConHead :: ConHead
</span><a href="Agda.TypeChecking.Monad.Base.html#recConHead"><span class="hs-identifier hs-var">recConHead</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616222"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-234"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recNamedCon :: Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#recNamedCon"><span class="hs-identifier hs-var">recNamedCon</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616180"><span class="hs-identifier hs-var">hasNamedCon</span></a></span><span>
</span><span id="line-235"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recFields :: [Dom' Term QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#recFields"><span class="hs-identifier hs-var">recFields</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dom' Term QName]
</span><a href="#local-6989586621681616207"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-236"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recTel :: Telescope
</span><a href="Agda.TypeChecking.Monad.Base.html#recTel"><span class="hs-identifier hs-var">recTel</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616246"><span class="hs-identifier hs-var">telh</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-operator hs-var">`abstract`</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span>
</span><span id="line-237"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recAbstr :: IsAbstract
</span><a href="Agda.TypeChecking.Monad.Base.html#recAbstr"><span class="hs-identifier hs-var">recAbstr</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; IsAbstract
forall t. DefInfo' t -&gt; IsAbstract
</span><a href="Agda.Syntax.Info.html#defAbstract"><span class="hs-identifier hs-var">Info.defAbstract</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616098"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-238"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recEtaEquality' :: EtaEquality
</span><a href="Agda.TypeChecking.Monad.Base.html#recEtaEquality%27"><span class="hs-identifier hs-var">recEtaEquality'</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EtaEquality
</span><a href="#local-6989586621681616215"><span class="hs-identifier hs-var">haveEta</span></a></span><span>
</span><span id="line-239"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recPatternMatching :: PatternOrCopattern
</span><a href="Agda.TypeChecking.Monad.Base.html#recPatternMatching"><span class="hs-identifier hs-var">recPatternMatching</span></a></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="#local-6989586621681616219"><span class="hs-identifier hs-var">patCopat</span></a></span><span>
</span><span id="line-240"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recInduction :: Maybe Induction
</span><a href="Agda.TypeChecking.Monad.Base.html#recInduction"><span class="hs-identifier hs-var">recInduction</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621681616211"><span class="hs-identifier hs-var">indCo</span></a></span><span>
</span><span id="line-241"></span><span>                  </span><span class="hs-comment">-- We retain the original user declaration [(co)inductive]</span><span>
</span><span id="line-242"></span><span>                  </span><span class="hs-comment">-- in case the record turns out to be recursive.</span><span>
</span><span id="line-243"></span><span>              </span><span class="hs-comment">-- Determined by positivity checker:</span><span>
</span><span id="line-244"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recMutual :: Maybe [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#recMutual"><span class="hs-identifier hs-var">recMutual</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [QName]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-245"></span><span>              </span><span class="hs-comment">-- Determined by the termination checker:</span><span>
</span><span id="line-246"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recTerminates :: Maybe Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#recTerminates"><span class="hs-identifier hs-var">recTerminates</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-247"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recComp :: CompKit
</span><a href="Agda.TypeChecking.Monad.Base.html#recComp"><span class="hs-identifier hs-var">recComp</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompKit
</span><a href="Agda.TypeChecking.Monad.Base.html#emptyCompKit"><span class="hs-identifier hs-var">emptyCompKit</span></a></span><span> </span><span class="hs-comment">-- filled in later</span><span>
</span><span id="line-248"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>        </span><span id="local-6989586621681616268"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616268"><span class="hs-identifier hs-var">erasure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optErasure"><span class="hs-identifier hs-var">optErasure</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; TCMT IO PragmaOptions -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-comment">-- Add record constructor to signature</span><span>
</span><span id="line-252"></span><span>        </span><span class="annot"><span class="annottext">QName -&gt; ArgInfo -&gt; QName -&gt; Type -&gt; Defn -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#addConstant%27"><span class="hs-identifier hs-var">addConstant'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616181"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616181"><span class="hs-identifier hs-var">conName</span></a></span><span>
</span><span id="line-253"></span><span>             </span><span class="hs-comment">-- If --erasure is used, then the parameters are erased</span><span>
</span><span id="line-254"></span><span>             </span><span class="hs-comment">-- in the constructor's type.</span><span>
</span><span id="line-255"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; (Telescope -&gt; Telescope) -&gt; Telescope -&gt; Telescope
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616268"><span class="hs-identifier hs-var">erasure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; Tele a -&gt; Tele b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((Dom Type -&gt; Dom Type) -&gt; Telescope -&gt; Telescope)
-&gt; (Dom Type -&gt; Dom Type) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; Dom Type -&gt; Dom Type
forall a. LensQuantity a =&gt; Quantity -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#applyQuantity"><span class="hs-identifier hs-var">applyQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-var">zeroQuantity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616246"><span class="hs-identifier hs-var">telh</span></a></span><span>
</span><span id="line-256"></span><span>             </span><span class="annot"><span class="annottext">Telescope -&gt; Type -&gt; Type
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-operator hs-var">`abstract`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616176"><span class="hs-identifier hs-var">contype</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; TCM ()) -&gt; Defn -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span>
</span><span id="line-258"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">conPars :: Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#conPars"><span class="hs-identifier hs-var">conPars</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616245"><span class="hs-identifier hs-var">npars</span></a></span><span>
</span><span id="line-259"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conArity :: Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#conArity"><span class="hs-identifier hs-var">conArity</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dom' Term QName] -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom' Term QName]
</span><a href="#local-6989586621681616207"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-260"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conSrcCon :: ConHead
</span><a href="Agda.TypeChecking.Monad.Base.html#conSrcCon"><span class="hs-identifier hs-var">conSrcCon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616222"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-261"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conData :: QName
</span><a href="Agda.TypeChecking.Monad.Base.html#conData"><span class="hs-identifier hs-var">conData</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-262"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conAbstr :: IsAbstract
</span><a href="Agda.TypeChecking.Monad.Base.html#conAbstr"><span class="hs-identifier hs-var">conAbstr</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; IsAbstract
forall t. DefInfo' t -&gt; IsAbstract
</span><a href="Agda.Syntax.Info.html#defAbstract"><span class="hs-identifier hs-var">Info.defAbstract</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616098"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-263"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conComp :: CompKit
</span><a href="Agda.TypeChecking.Monad.Base.html#conComp"><span class="hs-identifier hs-var">conComp</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompKit
</span><a href="Agda.TypeChecking.Monad.Base.html#emptyCompKit"><span class="hs-identifier hs-var">emptyCompKit</span></a></span><span>  </span><span class="hs-comment">-- filled in later</span><span>
</span><span id="line-264"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conProj :: Maybe [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#conProj"><span class="hs-identifier hs-var">conProj</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [QName]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>       </span><span class="hs-comment">-- filled in later</span><span>
</span><span id="line-265"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conForced :: [IsForced]
</span><a href="Agda.TypeChecking.Monad.Base.html#conForced"><span class="hs-identifier hs-var">conForced</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conErased :: Maybe [Bool]
</span><a href="Agda.TypeChecking.Monad.Base.html#conErased"><span class="hs-identifier hs-var">conErased</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Bool]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-267"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conErasure :: Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#conErasure"><span class="hs-identifier hs-var">conErasure</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616268"><span class="hs-identifier hs-var">erasure</span></a></span><span>
</span><span id="line-268"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conInline :: Bool
</span><a href="Agda.TypeChecking.Monad.Base.html#conInline"><span class="hs-identifier hs-var">conInline</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-269"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-comment">-- Declare the constructor as eligible for instance search</span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; IsInstance
forall t. DefInfo' t -&gt; IsInstance
</span><a href="Agda.Syntax.Info.html#defInstance"><span class="hs-identifier hs-var">Info.defInstance</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616098"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><a href="Agda.Syntax.Common.html#InstanceDef"><span class="hs-identifier hs-type">InstanceDef</span></a></span><span> </span><span id="local-6989586621681616286"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681616286"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KwRange -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681616286"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>          </span><span class="hs-comment">-- Andreas, 2020-01-28, issue #4360:</span><span>
</span><span id="line-275"></span><span>          </span><span class="hs-comment">-- Use addTypedInstance instead of addNamedInstance</span><span>
</span><span id="line-276"></span><span>          </span><span class="hs-comment">-- to detect unusable instances.</span><span>
</span><span id="line-277"></span><span>          </span><span class="annot"><span class="annottext">QName -&gt; Type -&gt; TCM ()
</span><a href="Agda.TypeChecking.InstanceArguments.html#addTypedInstance"><span class="hs-identifier hs-var">addTypedInstance</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616181"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616176"><span class="hs-identifier hs-var">contype</span></a></span><span>
</span><span id="line-278"></span><span>          </span><span class="hs-comment">-- addNamedInstance conName name</span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">IsInstance
</span><a href="Agda.Syntax.Common.html#NotInstanceDef"><span class="hs-identifier hs-var">NotInstanceDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-comment">-- Check that the fields fit inside the sort</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; UniverseCheck -&gt; [IsForced] -&gt; Type -&gt; Sort -&gt; TCM Nat
</span><a href="Agda.TypeChecking.Rules.Data.html#fitsIn"><span class="hs-identifier hs-var">fitsIn</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616181"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">UniverseCheck
</span><a href="#local-6989586621681616100"><span class="hs-identifier hs-var">uc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616176"><span class="hs-identifier hs-var">contype</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681616167"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-comment">-- Check that the sort admits record declarations.</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">QName -&gt; Sort -&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Data.html#checkDataSort"><span class="hs-identifier hs-var">checkDataSort</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Sort
</span><a href="#local-6989586621681616167"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-comment">{- Andreas, 2011-04-27 WRONG because field types are checked again
         and then non-stricts should not yet be irrelevant

      -- make record parameters hidden and non-stricts irrelevant
      -- ctx &lt;- (reverse . map hideAndRelParams . take (size tel)) &lt;$&gt; getContext
      -}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">{- Andreas, 2013-09-13 DEBUGGING the debug printout
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ (prettyTCM =&lt;&lt; getContextTelescope)
        ]
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ (text . show =&lt;&lt; getContextTelescope)
        ]
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ (inTopContext . prettyTCM =&lt;&lt; getContextTelescope)
        ]
      reportSDoc &quot;tc.rec&quot; 80 $ sep
        [ &quot;current module record telescope&quot;
        , nest 2 $ do
           tel &lt;- getContextTelescope
           text (show tel) $+$ do
           inTopContext $ do
             prettyTCM tel $+$ do
               telA &lt;- reify tel
               text (show telA) $+$ do
               ctx &lt;- getContextTelescope
               &quot;should be empty:&quot; &lt;+&gt; prettyTCM ctx
        ]
-}</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616290"><span class="annot"><span class="annottext">info :: ArgInfo
</span><a href="#local-6989586621681616290"><span class="hs-identifier hs-var hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; ArgInfo -&gt; ArgInfo
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setRelevance"><span class="hs-identifier hs-var">setRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681616226"><span class="hs-identifier hs-var">recordRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-var">defaultArgInfo</span></a></span><span>
</span><span id="line-323"></span><span>          </span><span id="local-6989586621681616292"><span class="annot"><span class="annottext">addRecordVar :: TCM () -&gt; TCM ()
</span><a href="#local-6989586621681616292"><span class="hs-identifier hs-var hs-var">addRecordVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">Dom Type -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) b.
(MonadAddContext m, MonadFresh NameId m) =&gt;
Dom Type -&gt; m b -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#addRecordNameContext"><span class="hs-identifier hs-var">addRecordNameContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Dom Type -&gt; Dom Type
forall a. LensArgInfo a =&gt; ArgInfo -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setArgInfo"><span class="hs-identifier hs-var">setArgInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616290"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Dom Type) -&gt; Dom Type -&gt; Dom Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Dom Type
forall a. a -&gt; Dom a
</span><a href="Agda.Syntax.Internal.html#defaultDom"><span class="hs-identifier hs-var">defaultDom</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616171"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616296"><span class="annot"><span class="annottext">m :: ModuleName
</span><a href="#local-6989586621681616296"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ModuleName
</span><a href="Agda.Syntax.Abstract.Name.html#qnameToMName"><span class="hs-identifier hs-var">qnameToMName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span>  </span><span class="hs-comment">-- Name of record module.</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>      </span><span id="local-6989586621681616298"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616298"><span class="hs-identifier hs-var">eraseRecordParameters</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optEraseRecordParameters"><span class="hs-identifier hs-var">optEraseRecordParameters</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; TCMT IO PragmaOptions -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621681616300"><span class="hs-identifier hs-type">maybeErase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681615127"><span class="annot"><a href="#local-6989586621681615127"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#LensQuantity"><span class="hs-identifier hs-type">LensQuantity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681615127"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681615127"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681615127"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-330"></span><span>          </span><span id="local-6989586621681616300"><span class="annot"><span class="annottext">maybeErase :: forall a. LensQuantity a =&gt; a -&gt; a
</span><a href="#local-6989586621681616300"><span class="hs-identifier hs-var hs-var">maybeErase</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616298"><span class="hs-identifier hs-var">eraseRecordParameters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; a -&gt; a
forall a. LensQuantity a =&gt; Quantity -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setQuantity"><span class="hs-identifier hs-var">setQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-var">zeroQuantity</span></a></span><span>
</span><span id="line-331"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-comment">-- Andreas, 2016-02-09 setting all parameters hidden in the record</span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-comment">-- section telescope changes the semantics, see e.g.</span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-comment">-- test/Succeed/RecordInParModule.</span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-comment">-- Ulf, 2016-03-02 but it's the right thing to do (#1759)</span><span>
</span><span id="line-337"></span><span>      </span><span class="annot"><span class="annottext">(forall e. Dom e -&gt; Dom e) -&gt; TCM () -&gt; TCM ()
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
(forall e. Dom e -&gt; Dom e) -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#modifyContextInfo"><span class="hs-identifier hs-var">modifyContextInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom e -&gt; Dom e
forall a. LensHiding a =&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#hideOrKeepInstance"><span class="hs-identifier hs-var">hideOrKeepInstance</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom e -&gt; Dom e) -&gt; (Dom e -&gt; Dom e) -&gt; Dom e -&gt; Dom e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dom e -&gt; Dom e
forall a. LensQuantity a =&gt; a -&gt; a
</span><a href="#local-6989586621681616300"><span class="hs-identifier hs-var">maybeErase</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
</span><a href="#local-6989586621681616292"><span class="hs-identifier hs-var">addRecordVar</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-comment">-- Add the record section.</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.def&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-342"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;record section:&quot;</span></span><span>
</span><span id="line-343"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-344"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; ModuleName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616296"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc)
-&gt; (Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Doc) -&gt; TCMT IO Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Telescope
forall (m :: * -&gt; *). (Applicative m, MonadTCEnv m) =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; TCMT IO Doc) -&gt; [TCMT IO Doc] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Semigroup (m Doc), Foldable t) =&gt;
m Doc -&gt; t (m Doc) -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#punctuate"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#comma"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="annot"><span class="annottext">([TCMT IO Doc] -&gt; [TCMT IO Doc]) -&gt; [TCMT IO Doc] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Field -&gt; TCMT IO Doc) -&gt; [Field] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; TCMT IO Doc
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; TCMT IO Doc) -&gt; (Field -&gt; Doc) -&gt; Field -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Arg QName] -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="Agda.Syntax.Common.Pretty.html#pretty"><span class="hs-identifier hs-var">P.pretty</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg QName] -&gt; Doc) -&gt; (Field -&gt; [Arg QName]) -&gt; Field -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Dom' Term QName -&gt; Arg QName) -&gt; [Dom' Term QName] -&gt; [Arg QName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dom' Term QName -&gt; Arg QName
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">([Dom' Term QName] -&gt; [Arg QName])
-&gt; (Field -&gt; [Dom' Term QName]) -&gt; Field -&gt; [Arg QName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Field -&gt; [Dom' Term QName]
</span><a href="#local-6989586621681616194"><span class="hs-identifier hs-var">getName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616110"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-346"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.def&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;field tel =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="annottext">ModuleName -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#addSection"><span class="hs-identifier hs-var">addSection</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616296"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-comment">-- Andreas, 2016-02-09, Issue 1815 (see also issue 1759).</span><span>
</span><span id="line-354"></span><span>      </span><span class="hs-comment">-- For checking the record declarations, hide the record parameters</span><span>
</span><span id="line-355"></span><span>      </span><span class="hs-comment">-- and the parameters of the parent modules.</span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><span class="annottext">(forall e. Dom e -&gt; Dom e) -&gt; TCM () -&gt; TCM ()
forall (tcm :: * -&gt; *) a.
MonadTCEnv tcm =&gt;
(forall e. Dom e -&gt; Dom e) -&gt; tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#modifyContextInfo"><span class="hs-identifier hs-var">modifyContextInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom e -&gt; Dom e
forall a. LensHiding a =&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#hideOrKeepInstance"><span class="hs-identifier hs-var">hideOrKeepInstance</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom e -&gt; Dom e) -&gt; (Dom e -&gt; Dom e) -&gt; Dom e -&gt; Dom e
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dom e -&gt; Dom e
forall a. LensQuantity a =&gt; a -&gt; a
</span><a href="#local-6989586621681616300"><span class="hs-identifier hs-var">maybeErase</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-comment">-- If --erasure is used, then the parameters are erased in the</span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-comment">-- types of the projections.</span><span>
</span><span id="line-359"></span><span>        </span><span id="local-6989586621681616315"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616315"><span class="hs-identifier hs-var">erasure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optErasure"><span class="hs-identifier hs-var">optErasure</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; TCMT IO PragmaOptions -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span id="local-6989586621681616316"><span class="annot"><span class="annottext">[ContextEntry]
</span><a href="#local-6989586621681616316"><span class="hs-identifier hs-var">params</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; ([ContextEntry] -&gt; [ContextEntry])
-&gt; [ContextEntry]
-&gt; [ContextEntry]
forall b a. IsBool b =&gt; b -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616315"><span class="hs-identifier hs-var">erasure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ContextEntry -&gt; ContextEntry) -&gt; [ContextEntry] -&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((ContextEntry -&gt; ContextEntry)
 -&gt; [ContextEntry] -&gt; [ContextEntry])
-&gt; (ContextEntry -&gt; ContextEntry)
-&gt; [ContextEntry]
-&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; ContextEntry -&gt; ContextEntry
forall a. LensQuantity a =&gt; Quantity -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#applyQuantity"><span class="hs-identifier hs-var">applyQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="Agda.Syntax.Common.html#zeroQuantity"><span class="hs-identifier hs-var">zeroQuantity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ContextEntry] -&gt; [ContextEntry])
-&gt; TCMT IO [ContextEntry] -&gt; TCMT IO [ContextEntry]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO [ContextEntry]
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m [ContextEntry]
</span><a href="Agda.TypeChecking.Monad.Context.html#getContext"><span class="hs-identifier hs-var">getContext</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-comment">-- Check the types of the fields and the other record declarations.</span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
</span><a href="#local-6989586621681616292"><span class="hs-identifier hs-var">addRecordVar</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) a. MonadTCEnv m =&gt; ModuleName -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Env.html#withCurrentModule"><span class="hs-identifier hs-var">withCurrentModule</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616296"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>          </span><span class="hs-comment">-- Andreas, 2013-09-13, 2016-01-06.</span><span>
</span><span id="line-366"></span><span>          </span><span class="hs-comment">-- Argument telescope for the projections: all parameters are hidden.</span><span>
</span><span id="line-367"></span><span>          </span><span class="hs-comment">-- This means parameters of the parent modules and of the current</span><span>
</span><span id="line-368"></span><span>          </span><span class="hs-comment">-- record type.</span><span>
</span><span id="line-369"></span><span>          </span><span class="hs-comment">-- See test/Succeed/ProjectionsTakeModuleTelAsParameters.agda.</span><span>
</span><span id="line-370"></span><span>          </span><span id="local-6989586621681616319"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616319"><span class="hs-identifier hs-var">tel'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>            </span><span id="local-6989586621681616320"><span class="annot"><span class="annottext">ContextEntry
</span><a href="#local-6989586621681616320"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ContextEntry -&gt; [ContextEntry] -&gt; ContextEntry
forall a. a -&gt; [a] -&gt; a
</span><a href="Agda.Utils.List.html#headWithDefault"><span class="hs-identifier hs-var">headWithDefault</span></a></span><span> </span><span class="annot"><span class="annottext">ContextEntry
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">([ContextEntry] -&gt; ContextEntry)
-&gt; TCMT IO [ContextEntry] -&gt; TCMT IO ContextEntry
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO [ContextEntry]
forall (m :: * -&gt; *). MonadTCEnv m =&gt; m [ContextEntry]
</span><a href="Agda.TypeChecking.Monad.Context.html#getContext"><span class="hs-identifier hs-var">getContext</span></a></span><span>
</span><span id="line-372"></span><span>            </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Telescope
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Telescope) -&gt; Telescope -&gt; TCMT IO Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [Char]) -&gt; [ContextEntry] -&gt; Telescope
forall a. (a -&gt; [Char]) -&gt; ListTel' a -&gt; Telescope
</span><a href="Agda.Syntax.Internal.html#telFromList%27"><span class="hs-identifier hs-var">telFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Char]
</span><a href="Agda.Syntax.Abstract.Name.html#nameToArgName"><span class="hs-identifier hs-var">nameToArgName</span></a></span><span> </span><span class="annot"><span class="annottext">([ContextEntry] -&gt; Telescope) -&gt; [ContextEntry] -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ContextEntry] -&gt; [ContextEntry]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([ContextEntry] -&gt; [ContextEntry])
-&gt; [ContextEntry] -&gt; [ContextEntry]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ContextEntry
</span><a href="#local-6989586621681616320"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ContextEntry -&gt; [ContextEntry] -&gt; [ContextEntry]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ContextEntry]
</span><a href="#local-6989586621681616316"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-373"></span><span>          </span><span class="annot"><span class="annottext">ModuleName -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#setModuleCheckpoint"><span class="hs-identifier hs-var">setModuleCheckpoint</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616296"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-374"></span><span>          </span><span class="annot"><span class="annottext">ModuleName
-&gt; QName
-&gt; Bool
-&gt; ConHead
-&gt; Telescope
-&gt; Telescope
-&gt; [Field]
-&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Record.html#checkRecordProjections"><span class="hs-identifier hs-var">checkRecordProjections</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616296"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616180"><span class="hs-identifier hs-var">hasNamedCon</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616222"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616319"><span class="hs-identifier hs-var">tel'</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616110"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span>      </span><span class="hs-comment">-- we define composition here so that the projections are already in the signature.</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">TCMT IO Bool -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><a href="Agda.Utils.Monad.html#whenM"><span class="hs-identifier hs-var">whenM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optCubicalCompatible"><span class="hs-identifier hs-var">optCubicalCompatible</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; TCMT IO PragmaOptions -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616245"><span class="hs-identifier hs-var">npars</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>          </span><span class="annot"><span class="annottext">QName
-&gt; EtaEquality
-&gt; ConHead
-&gt; Telescope
-&gt; [Arg QName]
-&gt; Telescope
-&gt; Type
-&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Record.html#addCompositionForRecord"><span class="hs-identifier hs-var">addCompositionForRecord</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616099"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">EtaEquality
</span><a href="#local-6989586621681616215"><span class="hs-identifier hs-var">haveEta</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616222"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616153"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dom' Term QName -&gt; Arg QName) -&gt; [Dom' Term QName] -&gt; [Arg QName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dom' Term QName -&gt; Arg QName
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom' Term QName]
</span><a href="#local-6989586621681616207"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616158"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616171"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-comment">-- The confluence checker needs to know what symbols match against</span><span>
</span><span id="line-383"></span><span>      </span><span class="hs-comment">-- the constructor.</span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><span class="annottext">(Signature -&gt; Signature) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-var">modifySignature</span></a></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; Signature) -&gt; TCM ())
-&gt; (Signature -&gt; Signature) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616181"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">((Definition -&gt; Definition) -&gt; Signature -&gt; Signature)
-&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681616331"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681616331"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621681616331"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defMatchable"><span class="hs-identifier hs-var">defMatchable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.fromList</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681616207"><span class="hs-identifier hs-type">fs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-comment">-- Andreas, 2020-04-19, issue #4560</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-comment">-- If the user declared the record constructor as @pattern@,</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-comment">-- then switch on pattern matching for no-eta-equality.</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-comment">-- Default is no pattern matching, but definition by copatterns instead.</span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621681616219"><span class="annot"><span class="annottext">patCopat :: PatternOrCopattern
</span><a href="#local-6989586621681616219"><span class="hs-identifier hs-var hs-var">patCopat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
-&gt; (Range -&gt; PatternOrCopattern)
-&gt; Maybe Range
-&gt; PatternOrCopattern
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="Agda.Syntax.Common.html#CopatternMatching"><span class="hs-identifier hs-var">CopatternMatching</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; Range -&gt; PatternOrCopattern
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="Agda.Syntax.Common.html#PatternMatching"><span class="hs-identifier hs-var">PatternMatching</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Range
</span><a href="#local-6989586621681616104"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621681616221"><span class="annot"><span class="annottext">eta :: Maybe HasEta
</span><a href="#local-6989586621681616221"><span class="hs-identifier hs-var hs-var">eta</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="#local-6989586621681616219"><span class="hs-identifier hs-var">patCopat</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; HasEta0 -&gt; HasEta
forall a b. a -&gt; HasEta' b -&gt; HasEta' a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HasEta0 -&gt; HasEta) -&gt; Maybe HasEta0 -&gt; Maybe HasEta
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe HasEta0
</span><a href="#local-6989586621681616103"><span class="hs-identifier hs-var">eta0</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#addCompositionForRecord"><span class="hs-identifier hs-type">addCompositionForRecord</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Datatype name.</span></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#EtaEquality"><span class="hs-identifier hs-type">EtaEquality</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-type">ConHead</span></a></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ @&#915;@ parameters.</span></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Projection names.</span></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ @&#915; &#8866; &#934;@ field types.</span></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ @&#915; &#8866; T@ target type.</span></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span id="addCompositionForRecord"><span class="annot"><span class="annottext">addCompositionForRecord :: QName
-&gt; EtaEquality
-&gt; ConHead
-&gt; Telescope
-&gt; [Arg QName]
-&gt; Telescope
-&gt; Type
-&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Record.html#addCompositionForRecord"><span class="hs-identifier hs-var hs-var">addCompositionForRecord</span></a></span></span><span> </span><span id="local-6989586621681616338"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616338"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681616339"><span class="annot"><span class="annottext">EtaEquality
</span><a href="#local-6989586621681616339"><span class="hs-identifier hs-var">eta</span></a></span></span><span> </span><span id="local-6989586621681616340"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616340"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681616341"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616341"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621681616342"><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616342"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span id="local-6989586621681616343"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616343"><span class="hs-identifier hs-var">ftel</span></a></span></span><span> </span><span id="local-6989586621681616344"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616344"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-406"></span><span>  </span><span id="local-6989586621681616345"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616345"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Telescope
forall (m :: * -&gt; *). (Applicative m, MonadTCEnv m) =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><span class="annottext">TCM () -&gt; TCM ()
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-comment">-- Record has no fields: attach composition data to record constructor</span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Arg QName] -&gt; Bool
forall a. Null a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.Null.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616342"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>      </span><span id="local-6989586621681616346"><span class="annot"><span class="annottext">CompKit
</span><a href="#local-6989586621681616346"><span class="hs-identifier hs-var">kit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ConHead
-&gt; Telescope
-&gt; [QName]
-&gt; Telescope
-&gt; Type
-&gt; Boundary
-&gt; TCM CompKit
</span><a href="Agda.TypeChecking.Rules.Data.html#defineCompData"><span class="hs-identifier hs-var">defineCompData</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616338"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616340"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616345"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616341"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616343"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616344"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><span class="annottext">(Signature -&gt; Signature) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-var">modifySignature</span></a></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; Signature) -&gt; TCM ())
-&gt; (Signature -&gt; Signature) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616340"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Definition -&gt; Definition) -&gt; Signature -&gt; Signature)
-&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; Defn) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateTheDef"><span class="hs-identifier hs-var">updateTheDef</span></a></span><span> </span><span class="annot"><span class="annottext">((Defn -&gt; Defn) -&gt; Definition -&gt; Definition)
-&gt; (Defn -&gt; Defn) -&gt; Definition -&gt; Definition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-413"></span><span>        </span><span id="local-6989586621681616349"><span class="annot"><span class="annottext">r :: Defn
</span><a href="#local-6989586621681616349"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681616349"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conComp"><span class="hs-identifier hs-var">conComp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681616346"><span class="hs-identifier hs-type">kit</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#conProj"><span class="hs-identifier hs-var">conProj</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>  </span><span class="hs-comment">-- no projections</span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Defn
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-comment">-- No-eta record with pattern matching (i.e., withOUT copattern</span><span>
</span><span id="line-417"></span><span>    </span><span class="hs-comment">-- matching): define composition as for a data type, attach it to</span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-comment">-- the record.</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">EtaEquality -&gt; HasEta
</span><a href="Agda.TypeChecking.Monad.Base.html#theEtaEquality"><span class="hs-identifier hs-var">theEtaEquality</span></a></span><span> </span><span class="annot"><span class="annottext">EtaEquality
</span><a href="#local-6989586621681616339"><span class="hs-identifier hs-var">eta</span></a></span><span> </span><span class="annot"><span class="annottext">HasEta -&gt; HasEta -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern -&gt; HasEta
forall a. a -&gt; HasEta' a
</span><a href="Agda.Syntax.Common.html#NoEta"><span class="hs-identifier hs-var">NoEta</span></a></span><span> </span><span class="annot"><span class="annottext">PatternOrCopattern
</span><a href="Agda.Syntax.Common.html#PatternMatching"><span class="hs-identifier hs-var">PatternMatching</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-420"></span><span>      </span><span id="local-6989586621681616350"><span class="annot"><span class="annottext">CompKit
</span><a href="#local-6989586621681616350"><span class="hs-identifier hs-var">kit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ConHead
-&gt; Telescope
-&gt; [QName]
-&gt; Telescope
-&gt; Type
-&gt; Boundary
-&gt; TCM CompKit
</span><a href="Agda.TypeChecking.Rules.Data.html#defineCompData"><span class="hs-identifier hs-var">defineCompData</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616338"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616340"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616345"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616341"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arg QName -&gt; QName
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg QName -&gt; QName) -&gt; [Arg QName] -&gt; [QName]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616342"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616343"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616344"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>      </span><span class="annot"><span class="annottext">(Signature -&gt; Signature) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-var">modifySignature</span></a></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; Signature) -&gt; TCM ())
-&gt; (Signature -&gt; Signature) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616338"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">((Definition -&gt; Definition) -&gt; Signature -&gt; Signature)
-&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; Defn) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateTheDef"><span class="hs-identifier hs-var">updateTheDef</span></a></span><span> </span><span class="annot"><span class="annottext">((Defn -&gt; Defn) -&gt; Definition -&gt; Definition)
-&gt; (Defn -&gt; Defn) -&gt; Definition -&gt; Definition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621681616352"><span class="annot"><span class="annottext">r :: Defn
</span><a href="#local-6989586621681616352"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681616352"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recComp"><span class="hs-identifier hs-var">recComp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681616350"><span class="hs-identifier hs-type">kit</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Defn
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-comment">-- Record has fields: attach composition data to record type</span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-comment">-- If record has irrelevant fields but irrelevant projections are disabled,</span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-comment">-- we cannot generate composition data.</span><span>
</span><span id="line-429"></span><span>      </span><span id="local-6989586621681616353"><span class="annot"><span class="annottext">CompKit
</span><a href="#local-6989586621681616353"><span class="hs-identifier hs-var">kit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Bool -&gt; TCM CompKit -&gt; TCM CompKit -&gt; TCM CompKit
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; TCMT IO Bool
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Arg QName -&gt; Bool) -&gt; [Arg QName] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Arg QName -&gt; Bool
forall a. LensRelevance a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#isIrrelevant"><span class="hs-identifier hs-var">isIrrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616342"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>                  </span><span class="annot"><span class="annottext">TCMT IO Bool -&gt; TCMT IO Bool -&gt; TCMT IO Bool
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><a href="Agda.Utils.Monad.html#and2M"><span class="hs-operator hs-var">`and2M`</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
forall a. Boolean a =&gt; a -&gt; a
</span><a href="Agda.Utils.Boolean.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (PragmaOptions -&gt; Bool) -&gt; PragmaOptions -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">PragmaOptions -&gt; Bool
</span><a href="Agda.Interaction.Options.Base.html#optIrrelevantProjections"><span class="hs-identifier hs-var">optIrrelevantProjections</span></a></span><span> </span><span class="annot"><span class="annottext">(PragmaOptions -&gt; Bool) -&gt; TCMT IO PragmaOptions -&gt; TCMT IO Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO PragmaOptions
forall (m :: * -&gt; *). HasOptions m =&gt; m PragmaOptions
</span><a href="Agda.Interaction.Options.HasOptions.html#pragmaOptions"><span class="hs-identifier hs-var">pragmaOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>        </span><span class="hs-comment">{-then-}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompKit -&gt; TCM CompKit
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">CompKit
</span><a href="Agda.TypeChecking.Monad.Base.html#emptyCompKit"><span class="hs-identifier hs-var">emptyCompKit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>        </span><span class="hs-comment">{-else-}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
-&gt; Telescope -&gt; Telescope -&gt; [Arg QName] -&gt; Type -&gt; TCM CompKit
</span><a href="Agda.TypeChecking.Rules.Record.html#defineCompKitR"><span class="hs-identifier hs-var">defineCompKitR</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616338"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616345"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616341"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616343"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616342"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616344"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><span class="annottext">(Signature -&gt; Signature) -&gt; TCM ()
forall (m :: * -&gt; *).
MonadTCState m =&gt;
(Signature -&gt; Signature) -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.State.html#modifySignature"><span class="hs-identifier hs-var">modifySignature</span></a></span><span> </span><span class="annot"><span class="annottext">((Signature -&gt; Signature) -&gt; TCM ())
-&gt; (Signature -&gt; Signature) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
</span><a href="Agda.TypeChecking.Monad.State.html#updateDefinition"><span class="hs-identifier hs-var">updateDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616338"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">((Definition -&gt; Definition) -&gt; Signature -&gt; Signature)
-&gt; (Definition -&gt; Definition) -&gt; Signature -&gt; Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; Defn) -&gt; Definition -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.State.html#updateTheDef"><span class="hs-identifier hs-var">updateTheDef</span></a></span><span> </span><span class="annot"><span class="annottext">((Defn -&gt; Defn) -&gt; Definition -&gt; Definition)
-&gt; (Defn -&gt; Defn) -&gt; Definition -&gt; Definition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-434"></span><span>        </span><span id="local-6989586621681616361"><span class="annot"><span class="annottext">r :: Defn
</span><a href="#local-6989586621681616361"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621681616361"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#recComp"><span class="hs-identifier hs-var">recComp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681616353"><span class="hs-identifier hs-type">kit</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Defn
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#defineCompKitR"><span class="hs-identifier hs-type">defineCompKitR</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>          </span><span class="annot"><span class="hs-comment">-- ^ some name, e.g. record name</span></span><span>
</span><span id="line-439"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ param types &#916;</span></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ fields' types &#916; &#8866; &#934;</span></span><span>
</span><span id="line-441"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ fields' names</span></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ record type &#916; &#8866; T</span></span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CompKit"><span class="hs-identifier hs-type">CompKit</span></a></span><span>
</span><span id="line-444"></span><span id="defineCompKitR"><span class="annot"><span class="annottext">defineCompKitR :: QName
-&gt; Telescope -&gt; Telescope -&gt; [Arg QName] -&gt; Type -&gt; TCM CompKit
</span><a href="Agda.TypeChecking.Rules.Record.html#defineCompKitR"><span class="hs-identifier hs-var hs-var">defineCompKitR</span></a></span></span><span> </span><span id="local-6989586621681616362"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616362"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681616363"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616363"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681616364"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616364"><span class="hs-identifier hs-var">fsT</span></a></span></span><span> </span><span id="local-6989586621681616365"><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616365"><span class="hs-identifier hs-var">fns</span></a></span></span><span> </span><span id="local-6989586621681616366"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616366"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621681616367"><span class="annot"><span class="annottext">[Maybe Term]
</span><a href="#local-6989586621681616367"><span class="hs-identifier hs-var">required</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(SomeBuiltin -&gt; TCMT IO (Maybe Term))
-&gt; [SomeBuiltin] -&gt; TCMT IO [Maybe Term]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">SomeBuiltin -&gt; TCMT IO (Maybe Term)
forall (m :: * -&gt; *) a.
(HasBuiltins m, IsBuiltin a) =&gt;
a -&gt; m (Maybe Term)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getTerm%27"><span class="hs-identifier hs-var">getTerm'</span></a></span><span>
</span><span id="line-446"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinInterval"><span class="hs-identifier hs-var">builtinInterval</span></a></span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinIZero"><span class="hs-identifier hs-var">builtinIZero</span></a></span><span>
</span><span id="line-448"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinIOne"><span class="hs-identifier hs-var">builtinIOne</span></a></span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimitiveId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="Agda.Syntax.Builtin.html#builtinIMin"><span class="hs-identifier hs-var">builtinIMin</span></a></span><span>
</span><span id="line-450"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimitiveId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="Agda.Syntax.Builtin.html#builtinIMax"><span class="hs-identifier hs-var">builtinIMax</span></a></span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimitiveId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="Agda.Syntax.Builtin.html#builtinINeg"><span class="hs-identifier hs-var">builtinINeg</span></a></span><span>
</span><span id="line-452"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimitiveId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="Agda.Syntax.Builtin.html#builtinPOr"><span class="hs-identifier hs-var">builtinPOr</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; SomeBuiltin
forall a. IsBuiltin a =&gt; a -&gt; SomeBuiltin
</span><a href="Agda.Syntax.Builtin.html#someBuiltin"><span class="hs-identifier hs-var">someBuiltin</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinItIsOne"><span class="hs-identifier hs-var">builtinItIsOne</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.cxt&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616363"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.cxt&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616364"><span class="hs-identifier hs-var">fsT</span></a></span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.cxt&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616366"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
forall a. Boolean a =&gt; a -&gt; a
</span><a href="Agda.Utils.Boolean.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Term -&gt; Bool) -&gt; [Maybe Term] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Maybe Term -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">[Maybe Term]
</span><a href="#local-6989586621681616367"><span class="hs-identifier hs-var">required</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CompKit -&gt; TCM CompKit
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(CompKit -&gt; TCM CompKit) -&gt; CompKit -&gt; TCM CompKit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CompKit
</span><a href="Agda.TypeChecking.Monad.Base.html#emptyCompKit"><span class="hs-identifier hs-var">emptyCompKit</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>    </span><span id="local-6989586621681616382"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681616382"><span class="hs-identifier hs-var">transp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PrimitiveId] -&gt; TCMT IO (Maybe QName) -&gt; TCMT IO (Maybe QName)
forall {m :: * -&gt; *} {t :: * -&gt; *} {a} {a}.
(Traversable t, HasBuiltins m, IsBuiltin a) =&gt;
t a -&gt; m (Maybe a) -&gt; m (Maybe a)
</span><a href="#local-6989586621681616383"><span class="hs-identifier hs-var">whenDefined</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="Agda.Syntax.Builtin.html#builtinTrans"><span class="hs-identifier hs-var">builtinTrans</span></a></span><span class="hs-special">]</span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command
-&gt; QName
-&gt; Telescope
-&gt; Telescope
-&gt; [Arg QName]
-&gt; Type
-&gt; TCMT IO (Maybe QName)
</span><a href="Agda.TypeChecking.Rules.Record.html#defineKanOperationR"><span class="hs-identifier hs-var">defineKanOperationR</span></a></span><span> </span><span class="annot"><span class="annottext">Command
</span><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#DoTransp"><span class="hs-identifier hs-var">DoTransp</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616362"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616363"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616364"><span class="hs-identifier hs-var">fsT</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616365"><span class="hs-identifier hs-var">fns</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616366"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621681616387"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681616387"><span class="hs-identifier hs-var">hcomp</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PrimitiveId] -&gt; TCMT IO (Maybe QName) -&gt; TCMT IO (Maybe QName)
forall {m :: * -&gt; *} {t :: * -&gt; *} {a} {a}.
(Traversable t, HasBuiltins m, IsBuiltin a) =&gt;
t a -&gt; m (Maybe a) -&gt; m (Maybe a)
</span><a href="#local-6989586621681616383"><span class="hs-identifier hs-var">whenDefined</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="Agda.Syntax.Builtin.html#builtinTrans"><span class="hs-identifier hs-var">builtinTrans</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PrimitiveId
</span><a href="Agda.Syntax.Builtin.html#builtinHComp"><span class="hs-identifier hs-var">builtinHComp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Command
-&gt; QName
-&gt; Telescope
-&gt; Telescope
-&gt; [Arg QName]
-&gt; Type
-&gt; TCMT IO (Maybe QName)
</span><a href="Agda.TypeChecking.Rules.Record.html#defineKanOperationR"><span class="hs-identifier hs-var">defineKanOperationR</span></a></span><span> </span><span class="annot"><span class="annottext">Command
</span><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#DoHComp"><span class="hs-identifier hs-var">DoHComp</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616362"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616363"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616364"><span class="hs-identifier hs-var">fsT</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616365"><span class="hs-identifier hs-var">fns</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616366"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">CompKit -&gt; TCM CompKit
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(CompKit -&gt; TCM CompKit) -&gt; CompKit -&gt; TCM CompKit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#CompKit"><span class="hs-identifier hs-type">CompKit</span></a></span><span>
</span><span id="line-462"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">nameOfTransp :: Maybe QName
</span><a href="Agda.TypeChecking.Monad.Base.html#nameOfTransp"><span class="hs-identifier hs-var">nameOfTransp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681616382"><span class="hs-identifier hs-var">transp</span></a></span><span>
</span><span id="line-463"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">nameOfHComp :: Maybe QName
</span><a href="Agda.TypeChecking.Monad.Base.html#nameOfHComp"><span class="hs-identifier hs-var">nameOfHComp</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621681616387"><span class="hs-identifier hs-var">hcomp</span></a></span><span>
</span><span id="line-464"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621681616383"><span class="annot"><span class="annottext">whenDefined :: t a -&gt; m (Maybe a) -&gt; m (Maybe a)
</span><a href="#local-6989586621681616383"><span class="hs-identifier hs-var hs-var">whenDefined</span></a></span></span><span> </span><span id="local-6989586621681616426"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621681616426"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621681616427"><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621681616427"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-467"></span><span>      </span><span id="local-6989586621681616428"><span class="annot"><span class="annottext">t (Maybe Term)
</span><a href="#local-6989586621681616428"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m (Maybe Term)) -&gt; t a -&gt; m (t (Maybe Term))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m (Maybe Term)
forall (m :: * -&gt; *) a.
(HasBuiltins m, IsBuiltin a) =&gt;
a -&gt; m (Maybe Term)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getTerm%27"><span class="hs-identifier hs-var">getTerm'</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621681616426"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Maybe Term -&gt; Bool) -&gt; t (Maybe Term) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Maybe Term -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">t (Maybe Term)
</span><a href="#local-6989586621681616428"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621681616427"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#defineKanOperationR"><span class="hs-identifier hs-type">defineKanOperationR</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ some name, e.g. record name</span></span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ param types &#916;</span></span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ fields' types &#916; &#8866; &#934;</span></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ fields' names</span></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ record type &#916; &#8866; T</span></span><span>
</span><span id="line-478"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span id="defineKanOperationR"><span class="annot"><span class="annottext">defineKanOperationR :: Command
-&gt; QName
-&gt; Telescope
-&gt; Telescope
-&gt; [Arg QName]
-&gt; Type
-&gt; TCMT IO (Maybe QName)
</span><a href="Agda.TypeChecking.Rules.Record.html#defineKanOperationR"><span class="hs-identifier hs-var hs-var">defineKanOperationR</span></a></span></span><span> </span><span id="local-6989586621681616429"><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621681616429"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621681616430"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616430"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681616431"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616431"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681616432"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616432"><span class="hs-identifier hs-var">fsT</span></a></span></span><span> </span><span id="local-6989586621681616433"><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616433"><span class="hs-identifier hs-var">fns</span></a></span></span><span> </span><span id="local-6989586621681616434"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616434"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616436"><span class="annot"><span class="annottext">project :: Term -&gt; QName -&gt; Term
</span><a href="#local-6989586621681616436"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621681616437"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616437"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621681616438"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616438"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616437"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Elims -&gt; Term
forall t. Apply t =&gt; t -&gt; Elims -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#applyE"><span class="hs-operator hs-var">`applyE`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Elim
forall a. ProjOrigin -&gt; QName -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-var">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjSystem"><span class="hs-identifier hs-var">ProjSystem</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616438"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>  </span><span id="local-6989586621681616442"><span class="annot"><span class="annottext">Maybe (QName, Telescope, Type, [Dom Type], [Term])
</span><a href="#local-6989586621681616442"><span class="hs-identifier hs-var">stuff</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(((QName, Telescope, Type, [Dom Type], [Term]), Substitution)
 -&gt; (QName, Telescope, Type, [Dom Type], [Term]))
-&gt; Maybe
     ((QName, Telescope, Type, [Dom Type], [Term]), Substitution)
-&gt; Maybe (QName, Telescope, Type, [Dom Type], [Term])
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">((QName, Telescope, Type, [Dom Type], [Term]), Substitution)
-&gt; (QName, Telescope, Type, [Dom Type], [Term])
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ((QName, Telescope, Type, [Dom Type], [Term]), Substitution)
 -&gt; Maybe (QName, Telescope, Type, [Dom Type], [Term]))
-&gt; TCMT
     IO
     (Maybe
        ((QName, Telescope, Type, [Dom Type], [Term]), Substitution))
-&gt; TCMT IO (Maybe (QName, Telescope, Type, [Dom Type], [Term]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Command
-&gt; Maybe Term
-&gt; (Term -&gt; QName -&gt; Term)
-&gt; QName
-&gt; Telescope
-&gt; Telescope
-&gt; [Arg QName]
-&gt; Type
-&gt; TCMT
     IO
     (Maybe
        ((QName, Telescope, Type, [Dom Type], [Term]), Substitution))
</span><a href="Agda.TypeChecking.Rules.Data.html#defineKanOperationForFields"><span class="hs-identifier hs-var">defineKanOperationForFields</span></a></span><span> </span><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621681616429"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Term
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; QName -&gt; Term
</span><a href="#local-6989586621681616436"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616430"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616431"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616432"><span class="hs-identifier hs-var">fsT</span></a></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616433"><span class="hs-identifier hs-var">fns</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616434"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><span class="annottext">Maybe (QName, Telescope, Type, [Dom Type], [Term])
-&gt; TCMT IO (Maybe QName)
-&gt; ((QName, Telescope, Type, [Dom Type], [Term])
    -&gt; TCMT IO (Maybe QName))
-&gt; TCMT IO (Maybe QName)
forall a b. Maybe a -&gt; b -&gt; (a -&gt; b) -&gt; b
</span><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-var">caseMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Telescope, Type, [Dom Type], [Term])
</span><a href="#local-6989586621681616442"><span class="hs-identifier hs-var">stuff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe QName -&gt; TCMT IO (Maybe QName)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((QName, Telescope, Type, [Dom Type], [Term])
  -&gt; TCMT IO (Maybe QName))
 -&gt; TCMT IO (Maybe QName))
-&gt; ((QName, Telescope, Type, [Dom Type], [Term])
    -&gt; TCMT IO (Maybe QName))
-&gt; TCMT IO (Maybe QName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681616445"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616445"><span class="hs-identifier hs-var">theName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616446"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616447"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616447"><span class="hs-identifier hs-var">rtype</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616448"><span class="annot"><span class="annottext">[Dom Type]
</span><a href="#local-6989586621681616448"><span class="hs-identifier hs-var">clause_types</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616449"><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616449"><span class="hs-identifier hs-var">bodies</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-comment">-- phi = 1 clause</span><span>
</span><span id="line-485"></span><span>  </span><span id="local-6989586621681616450"><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616450"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>           </span><span id="local-6989586621681616451"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616451"><span class="hs-identifier hs-var">io</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primIOne"><span class="hs-identifier hs-var">primIOne</span></a></span><span>
</span><span id="line-487"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621681616453"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616453"><span class="hs-identifier hs-var">io_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BuiltinId -&gt; TCMT IO (Maybe QName)
forall (m :: * -&gt; *). HasBuiltins m =&gt; BuiltinId -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Monad.Builtin.html#getBuiltinName%27"><span class="hs-identifier hs-var">getBuiltinName'</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinId
</span><a href="Agda.Syntax.Builtin.html#builtinIOne"><span class="hs-identifier hs-var">builtinIOne</span></a></span><span>
</span><span id="line-488"></span><span>           </span><span id="local-6989586621681616454"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616454"><span class="hs-identifier hs-var">one</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primItIsOne"><span class="hs-identifier hs-var">primItIsOne</span></a></span><span>
</span><span id="line-489"></span><span>           </span><span id="local-6989586621681616456"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616456"><span class="hs-identifier hs-var">tInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Type
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Type
</span><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#primIntervalType"><span class="hs-identifier hs-var">primIntervalType</span></a></span><span>
</span><span id="line-490"></span><span>           </span><span class="hs-keyword">let</span><span>
</span><span id="line-491"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621681616458"><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616458"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621681616459"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616459"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-492"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621681616429"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-493"></span><span>                  </span><span class="hs-comment">-- TranspRArgs = phi : I, a0 : ..</span><span>
</span><span id="line-494"></span><span>                  </span><span class="hs-comment">-- &#915; = &#916;^I , CompRArgs</span><span>
</span><span id="line-495"></span><span>                  </span><span class="hs-comment">-- pats = ... | phi = i1</span><span>
</span><span id="line-496"></span><span>                  </span><span class="hs-comment">-- body = a0</span><span>
</span><span id="line-497"></span><span>                  </span><span class="annot"><span class="annottext">Command
</span><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#DoTransp"><span class="hs-identifier hs-var">DoTransp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Nat -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>                  </span><span class="hs-comment">-- HCompRArgs = phi : I, u : .., a0 : ..</span><span>
</span><span id="line-499"></span><span>                  </span><span class="hs-comment">-- &#915; = &#916;, CompRArgs</span><span>
</span><span id="line-500"></span><span>                  </span><span class="hs-comment">-- pats = ... | phi = i1</span><span>
</span><span id="line-501"></span><span>                  </span><span class="hs-comment">-- body = u i1 itIsOne</span><span>
</span><span id="line-502"></span><span>                  </span><span class="annot"><span class="annottext">Command
</span><a href="Agda.TypeChecking.Primitive.Cubical.Base.html#DoHComp"><span class="hs-identifier hs-var">DoHComp</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Nat -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Term -&gt; [Arg Term] -&gt; Term
forall t. Apply t =&gt; t -&gt; [Arg Term] -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#apply"><span class="hs-operator hs-var">`apply`</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616451"><span class="hs-identifier hs-var">io</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Relevance -&gt; Arg Term -&gt; Arg Term
forall a. LensRelevance a =&gt; Relevance -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#setRelevance"><span class="hs-identifier hs-var">setRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Irrelevant"><span class="hs-identifier hs-var">Irrelevant</span></a></span><span> </span><span class="annot"><span class="annottext">(Arg Term -&gt; Arg Term) -&gt; Arg Term -&gt; Arg Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Arg Term
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616454"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span>              </span><span id="local-6989586621681616463"><span class="annot"><span class="annottext">p :: Pattern' DBPatVar
</span><a href="#local-6989586621681616463"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConHead
-&gt; ConPatternInfo
-&gt; [NamedArg (Pattern' DBPatVar)]
-&gt; Pattern' DBPatVar
forall x.
ConHead -&gt; ConPatternInfo -&gt; [NamedArg (Pattern' x)] -&gt; Pattern' x
</span><a href="Agda.Syntax.Internal.html#ConP"><span class="hs-identifier hs-var">ConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; DataOrRecord -&gt; Induction -&gt; [Arg QName] -&gt; ConHead
</span><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-var">ConHead</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616453"><span class="hs-identifier hs-var">io_name</span></a></span><span> </span><span class="annot"><span class="annottext">DataOrRecord
forall p. DataOrRecord' p
</span><a href="Agda.Syntax.Internal.html#IsData"><span class="hs-identifier hs-var">IsData</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.Aspect.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConPatternInfo
</span><a href="Agda.Syntax.Internal.html#noConPatternInfo"><span class="hs-identifier hs-var">noConPatternInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#conPType"><span class="hs-identifier hs-var">conPType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-type">Arg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#defaultArgInfo"><span class="hs-identifier hs-type">defaultArgInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681616456"><span class="hs-identifier hs-type">tInterval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#conPFallThrough"><span class="hs-identifier hs-var">conPFallThrough</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>                         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-508"></span><span>
</span><span id="line-509"></span><span>              </span><span class="hs-comment">-- gamma, rtype</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span>              </span><span id="local-6989586621681616470"><span class="annot"><span class="annottext">s :: Substitution' (Pattern' DBPatVar)
</span><a href="#local-6989586621681616470"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Pattern' DBPatVar -&gt; Substitution' (Pattern' DBPatVar)
forall a. DeBruijn a =&gt; Nat -&gt; a -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#singletonS"><span class="hs-identifier hs-var">singletonS</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616458"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' DBPatVar
</span><a href="#local-6989586621681616463"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>              </span><span class="annot"><a href="#local-6989586621681616472"><span class="hs-identifier hs-type">pats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Common.html#NamedArg"><span class="hs-identifier hs-type">NamedArg</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#DeBruijnPattern"><span class="hs-identifier hs-type">DeBruijnPattern</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-514"></span><span>              </span><span id="local-6989586621681616472"><span class="annot"><span class="annottext">pats :: [NamedArg (Pattern' DBPatVar)]
</span><a href="#local-6989586621681616472"><span class="hs-identifier hs-var hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution' (Pattern' DBPatVar)
Substitution' (SubstArg [NamedArg (Pattern' DBPatVar)])
</span><a href="#local-6989586621681616470"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution' (SubstArg [NamedArg (Pattern' DBPatVar)])
-&gt; [NamedArg (Pattern' DBPatVar)] -&gt; [NamedArg (Pattern' DBPatVar)]
forall a. Subst a =&gt; Substitution' (SubstArg a) -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-operator hs-var">`applySubst`</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [NamedArg (Pattern' DBPatVar)]
forall a t. DeBruijn a =&gt; Tele (Dom t) -&gt; [NamedArg a]
</span><a href="Agda.TypeChecking.Telescope.html#teleNamedArgs"><span class="hs-identifier hs-var">teleNamedArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span>              </span><span class="annot"><a href="#local-6989586621681616476"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-517"></span><span>              </span><span id="local-6989586621681616476"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621681616476"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution' (Pattern' DBPatVar)
</span><a href="#local-6989586621681616470"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution' (Pattern' DBPatVar) -&gt; Type -&gt; Type
forall a.
TermSubst a =&gt;
Substitution' (Pattern' DBPatVar) -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.html#applyPatSubst"><span class="hs-operator hs-var">`applyPatSubst`</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616447"><span class="hs-identifier hs-var">rtype</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>              </span><span class="annot"><a href="#local-6989586621681616478"><span class="hs-identifier hs-type">gamma'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span>
</span><span id="line-520"></span><span>              </span><span id="local-6989586621681616478"><span class="annot"><span class="annottext">gamma' :: Telescope
</span><a href="#local-6989586621681616478"><span class="hs-identifier hs-var hs-var">gamma'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Dom Type] -&gt; Telescope
</span><a href="Agda.TypeChecking.Telescope.html#unflattenTel"><span class="hs-identifier hs-var">unflattenTel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681616480"><span class="hs-identifier hs-var">ns0</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [[Char]] -&gt; [[Char]]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681616481"><span class="hs-identifier hs-var">ns1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dom Type] -&gt; Telescope) -&gt; [Dom Type] -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Substitution' (Pattern' DBPatVar)
</span><a href="#local-6989586621681616470"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Substitution' (Pattern' DBPatVar) -&gt; [Dom Type] -&gt; [Dom Type]
forall a.
TermSubst a =&gt;
Substitution' (Pattern' DBPatVar) -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.html#applyPatSubst"><span class="hs-operator hs-var">`applyPatSubst`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dom Type]
</span><a href="#local-6989586621681616482"><span class="hs-identifier hs-var">g0</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom Type] -&gt; [Dom Type] -&gt; [Dom Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Dom Type]
</span><a href="#local-6989586621681616483"><span class="hs-identifier hs-var">g1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>               </span><span class="hs-keyword">where</span><span>
</span><span id="line-522"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621681616482"><span class="annot"><span class="annottext">[Dom Type]
</span><a href="#local-6989586621681616482"><span class="hs-identifier hs-var">g0</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dom Type
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681616483"><span class="annot"><span class="annottext">[Dom Type]
</span><a href="#local-6989586621681616483"><span class="hs-identifier hs-var">g1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [Dom Type] -&gt; ([Dom Type], [Dom Type])
forall a. Nat -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616458"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Dom Type] -&gt; ([Dom Type], [Dom Type]))
-&gt; [Dom Type] -&gt; ([Dom Type], [Dom Type])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [Dom Type]
forall a. TermSubst a =&gt; Tele (Dom a) -&gt; [Dom a]
</span><a href="Agda.TypeChecking.Telescope.html#flattenTel"><span class="hs-identifier hs-var">flattenTel</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span>
</span><span id="line-523"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621681616480"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681616480"><span class="hs-identifier hs-var">ns0</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621681616481"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621681616481"><span class="hs-identifier hs-var">ns1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; [[Char]] -&gt; ([[Char]], [[Char]])
forall a. Nat -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><a href="#local-6989586621681616458"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; ([[Char]], [[Char]]))
-&gt; [[Char]] -&gt; ([[Char]], [[Char]])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [[Char]]
</span><a href="Agda.TypeChecking.Telescope.html#teleNames"><span class="hs-identifier hs-var">teleNames</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span>              </span><span id="local-6989586621681616487"><span class="annot"><span class="annottext">c :: Clause
</span><a href="#local-6989586621681616487"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">clauseFullRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseFullRange"><span class="hs-identifier hs-var">clauseFullRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span>
</span><span id="line-526"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseLHSRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseLHSRange"><span class="hs-identifier hs-var">clauseLHSRange</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span>
</span><span id="line-527"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseTel :: Telescope
</span><a href="Agda.Syntax.Internal.html#clauseTel"><span class="hs-identifier hs-var">clauseTel</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616478"><span class="hs-identifier hs-var">gamma'</span></a></span><span>
</span><span id="line-528"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">namedClausePats :: [NamedArg (Pattern' DBPatVar)]
</span><a href="Agda.Syntax.Internal.html#namedClausePats"><span class="hs-identifier hs-var">namedClausePats</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NamedArg (Pattern' DBPatVar)]
</span><a href="#local-6989586621681616472"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-529"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseBody :: Maybe Term
</span><a href="Agda.Syntax.Internal.html#clauseBody"><span class="hs-identifier hs-var">clauseBody</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Maybe Term
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Maybe Term) -&gt; Term -&gt; Maybe Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616459"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-530"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseType :: Maybe (Arg Type)
</span><a href="Agda.Syntax.Internal.html#clauseType"><span class="hs-identifier hs-var">clauseType</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Maybe (Arg Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Arg Type -&gt; Maybe (Arg Type)) -&gt; Arg Type -&gt; Maybe (Arg Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Arg Type
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616476"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-531"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseCatchall :: Bool
</span><a href="Agda.Syntax.Internal.html#clauseCatchall"><span class="hs-identifier hs-var">clauseCatchall</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-532"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseExact :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseExact"><span class="hs-identifier hs-var">clauseExact</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-533"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseRecursive :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseRecursive"><span class="hs-identifier hs-var">clauseRecursive</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>  </span><span class="hs-comment">-- definitely non-recursive!</span><span>
</span><span id="line-534"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseUnreachable :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseUnreachable"><span class="hs-identifier hs-var">clauseUnreachable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-535"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseEllipsis :: ExpandedEllipsis
</span><a href="Agda.Syntax.Internal.html#clauseEllipsis"><span class="hs-identifier hs-var">clauseEllipsis</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpandedEllipsis
</span><a href="Agda.Syntax.Common.html#NoEllipsis"><span class="hs-identifier hs-var">NoEllipsis</span></a></span><span>
</span><span id="line-536"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseWhereModule :: Maybe ModuleName
</span><a href="Agda.Syntax.Internal.html#clauseWhereModule"><span class="hs-identifier hs-var">clauseWhereModule</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-537"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-538"></span><span>           </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trans.rec.face&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc) -&gt; [Char] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Clause -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616487"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-539"></span><span>           </span><span class="annot"><span class="annottext">Clause -&gt; TCMT IO Clause
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616487"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span id="local-6989586621681616505"><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621681616505"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Arg QName, Dom Type, Term)]
-&gt; ((Arg QName, Dom Type, Term) -&gt; TCMT IO Clause)
-&gt; TCMT IO [Clause]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Arg QName]
-&gt; [Dom Type] -&gt; [Term] -&gt; [(Arg QName, Dom Type, Term)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><span class="hs-identifier hs-var">zip3</span></span><span> </span><span class="annot"><span class="annottext">[Arg QName]
</span><a href="#local-6989586621681616433"><span class="hs-identifier hs-var">fns</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom Type]
</span><a href="#local-6989586621681616448"><span class="hs-identifier hs-var">clause_types</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616449"><span class="hs-identifier hs-var">bodies</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Arg QName, Dom Type, Term) -&gt; TCMT IO Clause)
 -&gt; TCMT IO [Clause])
-&gt; ((Arg QName, Dom Type, Term) -&gt; TCMT IO Clause)
-&gt; TCMT IO [Clause]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681616508"><span class="annot"><span class="annottext">Arg QName
</span><a href="#local-6989586621681616508"><span class="hs-identifier hs-var">fname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616509"><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681616509"><span class="hs-identifier hs-var">clause_ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616510"><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616510"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-541"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-542"></span><span>              </span><span id="local-6989586621681616511"><span class="annot"><span class="annottext">pats :: [NamedArg (Pattern' DBPatVar)]
</span><a href="#local-6989586621681616511"><span class="hs-identifier hs-var hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [NamedArg (Pattern' DBPatVar)]
forall a t. DeBruijn a =&gt; Tele (Dom t) -&gt; [NamedArg a]
</span><a href="Agda.TypeChecking.Telescope.html#teleNamedArgs"><span class="hs-identifier hs-var">teleNamedArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">[NamedArg (Pattern' DBPatVar)]
-&gt; [NamedArg (Pattern' DBPatVar)] -&gt; [NamedArg (Pattern' DBPatVar)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar)
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar))
-&gt; Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Pattern' DBPatVar
forall x. ProjOrigin -&gt; QName -&gt; Pattern' x
</span><a href="Agda.Syntax.Internal.html#ProjP"><span class="hs-identifier hs-var">ProjP</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjSystem"><span class="hs-identifier hs-var">ProjSystem</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Pattern' DBPatVar) -&gt; QName -&gt; Pattern' DBPatVar
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Arg QName -&gt; QName
forall e. Arg e -&gt; e
</span><a href="Agda.Syntax.Common.html#unArg"><span class="hs-identifier hs-var">unArg</span></a></span><span> </span><span class="annot"><span class="annottext">Arg QName
</span><a href="#local-6989586621681616508"><span class="hs-identifier hs-var">fname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-543"></span><span>              </span><span id="local-6989586621681616514"><span class="annot"><span class="annottext">c :: Clause
</span><a href="#local-6989586621681616514"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">clauseFullRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseFullRange"><span class="hs-identifier hs-var">clauseFullRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span>
</span><span id="line-544"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseLHSRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseLHSRange"><span class="hs-identifier hs-var">clauseLHSRange</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
forall a. Range' a
</span><a href="Agda.Syntax.Position.html#noRange"><span class="hs-identifier hs-var">noRange</span></a></span><span>
</span><span id="line-545"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseTel :: Telescope
</span><a href="Agda.Syntax.Internal.html#clauseTel"><span class="hs-identifier hs-var">clauseTel</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span>
</span><span id="line-546"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">namedClausePats :: [NamedArg (Pattern' DBPatVar)]
</span><a href="Agda.Syntax.Internal.html#namedClausePats"><span class="hs-identifier hs-var">namedClausePats</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NamedArg (Pattern' DBPatVar)]
</span><a href="#local-6989586621681616511"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-547"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseBody :: Maybe Term
</span><a href="Agda.Syntax.Internal.html#clauseBody"><span class="hs-identifier hs-var">clauseBody</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Maybe Term
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616510"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-548"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseType :: Maybe (Arg Type)
</span><a href="Agda.Syntax.Internal.html#clauseType"><span class="hs-identifier hs-var">clauseType</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Maybe (Arg Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Arg Type -&gt; Maybe (Arg Type)) -&gt; Arg Type -&gt; Maybe (Arg Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Arg Type
forall e. e -&gt; Arg e
</span><a href="Agda.TypeChecking.Primitive.Base.html#argN"><span class="hs-identifier hs-var">argN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681616509"><span class="hs-identifier hs-var">clause_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseCatchall :: Bool
</span><a href="Agda.Syntax.Internal.html#clauseCatchall"><span class="hs-identifier hs-var">clauseCatchall</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-550"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseExact :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseExact"><span class="hs-identifier hs-var">clauseExact</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-551"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseRecursive :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseRecursive"><span class="hs-identifier hs-var">clauseRecursive</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-552"></span><span>                             </span><span class="hs-comment">-- Andreas 2020-02-06 TODO</span><span>
</span><span id="line-553"></span><span>                             </span><span class="hs-comment">-- Or: Just False;  is it known to be non-recursive?</span><span>
</span><span id="line-554"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseUnreachable :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseUnreachable"><span class="hs-identifier hs-var">clauseUnreachable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-555"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseEllipsis :: ExpandedEllipsis
</span><a href="Agda.Syntax.Internal.html#clauseEllipsis"><span class="hs-identifier hs-var">clauseEllipsis</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpandedEllipsis
</span><a href="Agda.Syntax.Common.html#NoEllipsis"><span class="hs-identifier hs-var">NoEllipsis</span></a></span><span>
</span><span id="line-556"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseWhereModule :: Maybe ModuleName
</span><a href="Agda.Syntax.Internal.html#clauseWhereModule"><span class="hs-identifier hs-var">clauseWhereModule</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-557"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-558"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trans.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">17</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc) -&gt; [Char] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Clause -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616514"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-559"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trans.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;type =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Arg Type) -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Clause -&gt; Maybe (Arg Type)
</span><a href="Agda.Syntax.Internal.html#clauseType"><span class="hs-identifier hs-var">clauseType</span></a></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616514"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trans.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; TCMT IO Doc) -&gt; Type -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Type -&gt; Type
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom Type -&gt; Type
forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681616509"><span class="hs-identifier hs-var">clause_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trans.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;body =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Term -&gt; Term
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616446"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">Term
</span><a href="#local-6989586621681616510"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>          </span><span class="annot"><span class="annottext">Clause -&gt; TCMT IO Clause
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616514"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-563"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; [Clause] -&gt; TCM ()
forall (m :: * -&gt; *).
(MonadConstraint m, MonadTCState m) =&gt;
QName -&gt; [Clause] -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#addClauses"><span class="hs-identifier hs-var">addClauses</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616445"><span class="hs-identifier hs-var">theName</span></a></span><span> </span><span class="annot"><span class="annottext">([Clause] -&gt; TCM ()) -&gt; [Clause] -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616450"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Clause -&gt; [Clause] -&gt; [Clause]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621681616505"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trans.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc) -&gt; [Char] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compiling clauses for &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616445"><span class="hs-identifier hs-var">theName</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621681616516"><span class="annot"><span class="annottext">Maybe SplitTree
</span><a href="#local-6989586621681616516"><span class="hs-identifier hs-var">mst</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616517"><span class="annot"><span class="annottext">CompiledClauses
</span><a href="#local-6989586621681616517"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO (Maybe SplitTree, Bool, CompiledClauses)
-&gt; TCMT IO (Maybe SplitTree, Bool, CompiledClauses)
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (QName, Type)
-&gt; [Clause] -&gt; TCMT IO (Maybe SplitTree, Bool, CompiledClauses)
</span><a href="Agda.TypeChecking.CompiledClause.Compile.html#compileClauses"><span class="hs-identifier hs-var">compileClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621681616505"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>  </span><span class="annot"><span class="annottext">Maybe SplitTree -&gt; (SplitTree -&gt; TCM ()) -&gt; TCM ()
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Agda.Utils.Maybe.html#whenJust"><span class="hs-identifier hs-var">whenJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SplitTree
</span><a href="#local-6989586621681616516"><span class="hs-identifier hs-var">mst</span></a></span><span> </span><span class="annot"><span class="annottext">((SplitTree -&gt; TCM ()) -&gt; TCM ())
-&gt; (SplitTree -&gt; TCM ()) -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; SplitTree -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#setSplitTree"><span class="hs-identifier hs-var">setSplitTree</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616445"><span class="hs-identifier hs-var">theName</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; CompiledClauses -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#setCompiledClauses"><span class="hs-identifier hs-var">setCompiledClauses</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616445"><span class="hs-identifier hs-var">theName</span></a></span><span> </span><span class="annot"><span class="annottext">CompiledClauses
</span><a href="#local-6989586621681616517"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;trans.rec&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">15</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc) -&gt; [Char] -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;compiled&quot;</span></span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><span class="annottext">Maybe QName -&gt; TCMT IO (Maybe QName)
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe QName -&gt; TCMT IO (Maybe QName))
-&gt; Maybe QName -&gt; TCMT IO (Maybe QName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616445"><span class="hs-identifier hs-var">theName</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="annot"><span class="hs-comment">{-| @checkRecordProjections m r q tel ftel fs@.

    [@m@    ]  name of the generated module

    [@r@    ]  name of the record type

    [@con@  ]  name of the record constructor

    [@tel@  ]  parameters (perhaps erased) and record variable r (&quot;self&quot;)

    [@ftel@ ]  telescope of fields

    [@fs@   ]  the fields to be checked
-}</span></span><span>
</span><span id="line-586"></span><span class="annot"><a href="Agda.TypeChecking.Rules.Record.html#checkRecordProjections"><span class="hs-identifier hs-type">checkRecordProjections</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConHead"><span class="hs-identifier hs-type">ConHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span id="checkRecordProjections"><span class="annot"><span class="annottext">checkRecordProjections :: ModuleName
-&gt; QName
-&gt; Bool
-&gt; ConHead
-&gt; Telescope
-&gt; Telescope
-&gt; [Field]
-&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Record.html#checkRecordProjections"><span class="hs-identifier hs-var hs-var">checkRecordProjections</span></a></span></span><span> </span><span id="local-6989586621681616522"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616522"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621681616523"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616523"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681616524"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616524"><span class="hs-identifier hs-var">hasNamedCon</span></a></span></span><span> </span><span id="local-6989586621681616525"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616525"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621681616526"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616526"><span class="hs-identifier hs-var">tel</span></a></span></span><span> </span><span id="local-6989586621681616527"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616527"><span class="hs-identifier hs-var">ftel</span></a></span></span><span> </span><span id="local-6989586621681616528"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616528"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Field] -&gt; TCM ()
</span><a href="#local-6989586621681616529"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
forall a. Tele a
</span><a href="Agda.Syntax.Internal.html#EmptyTel"><span class="hs-identifier hs-var">EmptyTel</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616527"><span class="hs-identifier hs-var">ftel</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616528"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><a href="#local-6989586621681616529"><span class="hs-identifier hs-type">checkProjs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Telescope"><span class="hs-identifier hs-type">Telescope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Internal.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Declaration"><span class="hs-identifier hs-type">A.Declaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>    </span><span id="local-6989586621681616529"><span class="annot"><span class="annottext">checkProjs :: Telescope -&gt; Telescope -&gt; [Term] -&gt; [Field] -&gt; TCM ()
</span><a href="#local-6989586621681616529"><span class="hs-identifier hs-var hs-var">checkProjs</span></a></span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall a. a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><a href="#local-6989586621681616529"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span id="local-6989586621681616531"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616531"><span class="hs-identifier hs-var">ftel1</span></a></span></span><span> </span><span id="local-6989586621681616532"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616532"><span class="hs-identifier hs-var">ftel2</span></a></span></span><span> </span><span id="local-6989586621681616533"><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616533"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#ScopedDecl"><span class="hs-identifier hs-type">A.ScopedDecl</span></a></span><span> </span><span id="local-6989586621681616534"><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681616534"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span id="local-6989586621681616535"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616535"><span class="hs-identifier hs-var">fs'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681616536"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616536"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><span class="annottext">ScopeInfo -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.State.html#setScope"><span class="hs-identifier hs-var">setScope</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeInfo
</span><a href="#local-6989586621681616534"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">TCM () -&gt; TCM () -&gt; TCM ()
forall a b. TCMT IO a -&gt; TCMT IO b -&gt; TCMT IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Field] -&gt; TCM ()
</span><a href="#local-6989586621681616529"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616531"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616532"><span class="hs-identifier hs-var">ftel2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616533"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616535"><span class="hs-identifier hs-var">fs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Field] -&gt; [Field] -&gt; [Field]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616536"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-comment">-- Case: projection.</span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><a href="#local-6989586621681616529"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span id="local-6989586621681616538"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.html#ExtendTel"><span class="hs-identifier hs-type">ExtendTel</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681616540"><span class="annot"><span class="annottext">dom :: Dom Type
</span><a href="#local-6989586621681616540"><span class="hs-identifier hs-var">dom</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Internal.html#Dom"><span class="hs-identifier hs-type">Dom</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">domInfo :: forall t e. Dom' t e -&gt; ArgInfo
</span><a href="Agda.Syntax.Internal.html#domInfo"><span class="hs-identifier hs-var">domInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681616543"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">unDom :: forall t e. Dom' t e -&gt; e
</span><a href="Agda.Syntax.Internal.html#unDom"><span class="hs-identifier hs-var">unDom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621681616544"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616544"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621681616545"><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621681616545"><span class="hs-identifier hs-var">ftel2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621681616546"><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616546"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Abstract.html#Field"><span class="hs-identifier hs-type">A.Field</span></a></span><span> </span><span id="local-6989586621681616547"><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616547"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621681616548"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616548"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Arg Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681616549"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616549"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><span class="annottext">Call -&gt; TCM () -&gt; TCM ()
forall a. Call -&gt; TCMT IO a -&gt; TCMT IO a
forall (m :: * -&gt; *) a. MonadTrace m =&gt; Call -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#traceCall"><span class="hs-identifier hs-var">traceCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; QName -&gt; Type -&gt; Call
</span><a href="Agda.TypeChecking.Monad.Base.html#CheckProjection"><span class="hs-identifier hs-var">CheckProjection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616547"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616548"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616544"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-comment">-- Andreas, 2012-06-07:</span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-comment">-- Issue 387: It is wrong to just type check field types again</span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-comment">-- because then meta variables are created again.</span><span>
</span><span id="line-606"></span><span>      </span><span class="hs-comment">-- Instead, we take the field type t from the field telescope.</span><span>
</span><span id="line-607"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-608"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;checking projection&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616548"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-609"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-610"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;top   =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc)
-&gt; (Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Doc) -&gt; TCMT IO Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Telescope
forall (m :: * -&gt; *). (Applicative m, MonadTCEnv m) =&gt; m Telescope
</span><a href="Agda.TypeChecking.Monad.Context.html#getContextTelescope"><span class="hs-identifier hs-var">getContextTelescope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;tel   =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc)
-&gt; (Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; TCMT IO Doc) -&gt; Telescope -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616526"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-613"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-614"></span><span>      </span><span class="hs-comment">-- Andreas, 2021-05-11, issue #5378</span><span>
</span><span id="line-615"></span><span>      </span><span class="hs-comment">-- The impossible is sometimes possible, so splitting out this part...</span><span>
</span><span id="line-616"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-617"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel1 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;t     =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616544"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel2 =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type
-&gt; Abs Telescope -&gt; (Telescope -&gt; TCMT IO Doc) -&gt; TCMT IO Doc
forall a (m :: * -&gt; *) b.
(Subst a, MonadAddContext m) =&gt;
Dom Type -&gt; Abs a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.TypeChecking.Monad.Context.html#underAbstraction"><span class="hs-identifier hs-var">underAbstraction</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681616540"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621681616545"><span class="hs-identifier hs-var">ftel2</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Telescope -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-621"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">55</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-622"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel1 (raw) =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span><span>
</span><span id="line-623"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;t     (raw) =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616544"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-624"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;ftel2 (raw) =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621681616545"><span class="hs-identifier hs-var">ftel2</span></a></span><span>
</span><span id="line-625"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-626"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-627"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;vs    =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Semigroup (m Doc), Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyList_"><span class="hs-identifier hs-var">prettyList_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Term -&gt; TCMT IO Doc) -&gt; [Term] -&gt; [TCMT IO Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Term -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616546"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;abstr =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc)
-&gt; (IsAbstract -&gt; [Char]) -&gt; IsAbstract -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IsAbstract -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DefInfo -&gt; IsAbstract
forall t. DefInfo' t -&gt; IsAbstract
</span><a href="Agda.Syntax.Info.html#defAbstract"><span class="hs-identifier hs-var">Info.defAbstract</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616547"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;quant =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc)
-&gt; (Quantity -&gt; [Char]) -&gt; Quantity -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Quantity -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Quantity
forall a. LensQuantity a =&gt; a -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#getQuantity"><span class="hs-identifier hs-var">getQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;coh   =&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCMT IO Doc)
-&gt; (Cohesion -&gt; [Char]) -&gt; Cohesion -&gt; TCMT IO Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>      </span><span class="hs-comment">-- Cohesion check:</span><span>
</span><span id="line-634"></span><span>      </span><span class="hs-comment">-- For a field `@c &#960; : A` we would create a projection `&#960; : .., (@(c^-1) r : R as) -&gt; A`</span><span>
</span><span id="line-635"></span><span>      </span><span class="hs-comment">-- So we want to check that `@.., (c^-1 . c) x : A |- x : A` is allowed by the modalities.</span><span>
</span><span id="line-636"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-637"></span><span>      </span><span class="hs-comment">-- Alternatively we could create a projection `.. |- &#960; r :c A`</span><span>
</span><span id="line-638"></span><span>      </span><span class="hs-comment">-- but that would require support for a `t :c A` judgment.</span><span>
</span><span id="line-639"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UnderComposition Cohesion -&gt; Bool
forall a. LeftClosedPOMonoid a =&gt; a -&gt; Bool
</span><a href="Agda.Utils.POMonoid.html#hasLeftAdjoint"><span class="hs-identifier hs-var">hasLeftAdjoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cohesion -&gt; UnderComposition Cohesion
forall t. t -&gt; UnderComposition t
</span><a href="Agda.Syntax.Common.html#UnderComposition"><span class="hs-identifier hs-var">UnderComposition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TCM () -&gt; TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; Cohesion -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Cohesion
</span><a href="Agda.Syntax.Common.html#Continuous"><span class="hs-identifier hs-var">Continuous</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>                    </span><span class="hs-comment">-- Andrea TODO: properly update the context/type of the projection when we add Sharp</span><span>
</span><span id="line-642"></span><span>                    </span><span class="annot"><span class="annottext">TCM ()
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-643"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCM ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
[Char] -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#genericError"><span class="hs-identifier hs-var">genericError</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TCM ()) -&gt; [Char] -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Cannot have record fields with modality &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Cohesion -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; Cohesion
forall a. LensCohesion a =&gt; a -&gt; Cohesion
</span><a href="Agda.Syntax.Common.html#getCohesion"><span class="hs-identifier hs-var">getCohesion</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>      </span><span class="hs-comment">-- The telescope tel includes the variable of record type as last one</span><span>
</span><span id="line-646"></span><span>      </span><span class="hs-comment">-- e.g. for cartesion product it is</span><span>
</span><span id="line-647"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-648"></span><span>      </span><span class="hs-comment">--   tel = {A' : Set} {B' : Set} (r : Prod A' B')</span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span>      </span><span class="hs-comment">-- create the projection functions (instantiate the type with the values</span><span>
</span><span id="line-651"></span><span>      </span><span class="hs-comment">-- of the previous fields)</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span>      </span><span class="hs-comment">-- The type of the projection function should be</span><span>
</span><span id="line-654"></span><span>      </span><span class="hs-comment">--  {&#916;} -&gt; (r : R &#916;) -&gt; t</span><span>
</span><span id="line-655"></span><span>      </span><span class="hs-comment">-- where &#916; are the parameters of R</span><span>
</span><span id="line-656"></span><span>
</span><span id="line-657"></span><span>      </span><span class="hs-comment">{- what are the contexts?

          &#916; , ftel&#8321;              &#8866; t
          &#916; , (r : R &#916;)          &#8866; parallelS vs : ftel&#8321;
          &#916; , (r : R &#916;) , ftel&#8321;  &#8866; t' = raiseFrom (size ftel&#8321;) 1 t
          &#916; , (r : R &#916;)          &#8866; t'' = applySubst (parallelS vs) t'
                                 &#8866; finalt = telePi tel t''
      -}</span><span>
</span><span id="line-665"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616560"><span class="annot"><span class="annottext">t' :: Type
</span><a href="#local-6989586621681616560"><span class="hs-identifier hs-var hs-var">t'</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Type -&gt; Type
forall a. Subst a =&gt; Nat -&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raiseFrom"><span class="hs-identifier hs-var">raiseFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616544"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-666"></span><span>          </span><span id="local-6989586621681616562"><span class="annot"><span class="annottext">t'' :: Type
</span><a href="#local-6989586621681616562"><span class="hs-identifier hs-var hs-var">t''</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Substitution' (SubstArg Type) -&gt; Type -&gt; Type
forall a. Subst a =&gt; Substitution' (SubstArg a) -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Term] -&gt; Substitution
forall a. DeBruijn a =&gt; [a] -&gt; Substitution' a
</span><a href="Agda.TypeChecking.Substitute.Class.html#parallelS"><span class="hs-identifier hs-var">parallelS</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616546"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616560"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-667"></span><span>          </span><span id="local-6989586621681616564"><span class="annot"><span class="annottext">finalt :: Type
</span><a href="#local-6989586621681616564"><span class="hs-identifier hs-var hs-var">finalt</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Type -&gt; Type
</span><a href="Agda.TypeChecking.Substitute.html#telePi"><span class="hs-identifier hs-var">telePi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Telescope -&gt; Telescope
forall a. [Char] -&gt; Tele a -&gt; Tele a
</span><a href="Agda.Syntax.Internal.html#replaceEmptyName"><span class="hs-identifier hs-var">replaceEmptyName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;r&quot;</span></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616526"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616562"><span class="hs-identifier hs-var">t''</span></a></span><span>
</span><span id="line-668"></span><span>          </span><span id="local-6989586621681616567"><span class="annot"><span class="annottext">projname :: QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var hs-var">projname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#qualify"><span class="hs-identifier hs-var">qualify</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621681616522"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616548"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-669"></span><span>          </span><span id="local-6989586621681616568"><span class="annot"><span class="annottext">projcall :: ProjOrigin -&gt; Term
</span><a href="#local-6989586621681616568"><span class="hs-identifier hs-var hs-var">projcall</span></a></span></span><span> </span><span id="local-6989586621681616569"><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621681616569"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Elims -&gt; Term
</span><a href="Agda.Syntax.Internal.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ProjOrigin -&gt; QName -&gt; Elim
forall a. ProjOrigin -&gt; QName -&gt; Elim' a
</span><a href="Agda.Syntax.Internal.Elim.html#Proj"><span class="hs-identifier hs-var">Proj</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="#local-6989586621681616569"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-670"></span><span>          </span><span id="local-6989586621681616570"><span class="annot"><span class="annottext">rel :: Relevance
</span><a href="#local-6989586621681616570"><span class="hs-identifier hs-var hs-var">rel</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Relevance
forall a. LensRelevance a =&gt; a -&gt; Relevance
</span><a href="Agda.Syntax.Common.html#getRelevance"><span class="hs-identifier hs-var">getRelevance</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span>
</span><span id="line-671"></span><span>          </span><span class="hs-comment">-- the recursive call</span><span>
</span><span id="line-672"></span><span>          </span><span id="local-6989586621681616571"><span class="annot"><span class="annottext">recurse :: TCM ()
</span><a href="#local-6989586621681616571"><span class="hs-identifier hs-var hs-var">recurse</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Field] -&gt; TCM ()
</span><a href="#local-6989586621681616529"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-identifier hs-var">abstract</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">(Telescope -&gt; Telescope) -&gt; Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Abs Telescope -&gt; Telescope
forall a. a -&gt; Abs (Tele a) -&gt; Tele a
</span><a href="Agda.Syntax.Internal.html#ExtendTel"><span class="hs-identifier hs-var">ExtendTel</span></a></span><span> </span><span class="annot"><span class="annottext">Dom Type
</span><a href="#local-6989586621681616540"><span class="hs-identifier hs-var">dom</span></a></span><span>
</span><span id="line-673"></span><span>                                 </span><span class="annot"><span class="annottext">(Abs Telescope -&gt; Telescope) -&gt; Abs Telescope -&gt; Telescope
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Telescope -&gt; Abs Telescope
forall a. [Char] -&gt; a -&gt; Abs a
</span><a href="Agda.Syntax.Internal.html#Abs"><span class="hs-identifier hs-var">Abs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Char]
</span><a href="Agda.Syntax.Abstract.Name.html#nameToArgName"><span class="hs-identifier hs-var">nameToArgName</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; [Char]) -&gt; Name -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Telescope
forall a. Tele a
</span><a href="Agda.Syntax.Internal.html#EmptyTel"><span class="hs-identifier hs-var">EmptyTel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Telescope -&gt; Telescope
forall a. Subst a =&gt; Abs a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#absBody"><span class="hs-identifier hs-var">absBody</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621681616545"><span class="hs-identifier hs-var">ftel2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProjOrigin -&gt; Term
</span><a href="#local-6989586621681616568"><span class="hs-identifier hs-var">projcall</span></a></span><span> </span><span class="annot"><span class="annottext">ProjOrigin
</span><a href="Agda.Syntax.Common.html#ProjSystem"><span class="hs-identifier hs-var">ProjSystem</span></a></span><span> </span><span class="annot"><span class="annottext">Term -&gt; [Term] -&gt; [Term]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616546"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616549"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span>      </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">25</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;finalt=&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-677"></span><span>        </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616564"><span class="hs-identifier hs-var">finalt</span></a></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-comment">-- -- Andreas, 2012-02-20 do not add irrelevant projections if</span><span>
</span><span id="line-680"></span><span>      </span><span class="hs-comment">-- -- disabled by --no-irrelevant-projections</span><span>
</span><span id="line-681"></span><span>      </span><span class="hs-comment">-- ifM (return (rel == Irrelevant) `and2M` do not . optIrrelevantProjections &lt;$&gt; pragmaOptions) recurse $ do</span><span>
</span><span id="line-682"></span><span>      </span><span class="hs-comment">-- Andreas, 2018-06-09 issue #2170</span><span>
</span><span id="line-683"></span><span>      </span><span class="hs-comment">-- Always create irrelevant projections (because the scope checker accepts irrelevant fields).</span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-comment">-- If --no-irrelevant-projections, then their use should be disallowed by the type checker for expressions.</span><span>
</span><span id="line-685"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-687"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;adding projection&quot;</span></span><span>
</span><span id="line-688"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc
forall (tcm :: * -&gt; *) a.
(MonadTCEnv tcm, ReadTCState tcm) =&gt;
tcm a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Context.html#inTopContext"><span class="hs-identifier hs-var">inTopContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; Type -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616564"><span class="hs-identifier hs-var">finalt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span>        </span><span class="hs-comment">-- The body should be</span><span>
</span><span id="line-692"></span><span>        </span><span class="hs-comment">--  P.xi {tel} (r _ .. x .. _) = x</span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-comment">-- Ulf, 2011-08-22: actually we're dropping the parameters from the</span><span>
</span><span id="line-694"></span><span>        </span><span class="hs-comment">-- projection functions so the body is now</span><span>
</span><span id="line-695"></span><span>        </span><span class="hs-comment">--  P.xi (r _ .. x .. _) = x</span><span>
</span><span id="line-696"></span><span>        </span><span class="hs-comment">-- Andreas, 2012-01-12: irrelevant projections get translated to</span><span>
</span><span id="line-697"></span><span>        </span><span class="hs-comment">--  P.xi (r _ .. x .. _) = irrAxiom {level of t} {t} x</span><span>
</span><span id="line-698"></span><span>        </span><span class="hs-comment">-- PROBLEM: because of dropped parameters, cannot refer to t</span><span>
</span><span id="line-699"></span><span>        </span><span class="hs-comment">-- 2012-04-02: DontCare instead of irrAxiom</span><span>
</span><span id="line-700"></span><span>
</span><span id="line-701"></span><span>        </span><span class="hs-comment">-- compute body modification for irrelevant projections</span><span>
</span><span id="line-702"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616574"><span class="annot"><span class="annottext">bodyMod :: Term -&gt; Term
</span><a href="#local-6989586621681616574"><span class="hs-identifier hs-var hs-var">bodyMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Relevance
</span><a href="#local-6989586621681616570"><span class="hs-identifier hs-var">rel</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-703"></span><span>              </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Relevant"><span class="hs-identifier hs-var">Relevant</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-704"></span><span>              </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#NonStrict"><span class="hs-identifier hs-var">NonStrict</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-705"></span><span>              </span><span class="annot"><span class="annottext">Relevance
</span><a href="Agda.Syntax.Common.html#Irrelevant"><span class="hs-identifier hs-var">Irrelevant</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="Agda.Syntax.Internal.html#dontCare"><span class="hs-identifier hs-var">dontCare</span></a></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Andreas, 2010-09-09: comment for existing code</span><span>
</span><span id="line-708"></span><span>            </span><span class="hs-comment">-- split the telescope into parameters (ptel) and the type or the record</span><span>
</span><span id="line-709"></span><span>            </span><span class="hs-comment">-- (rt) which should be  R ptel</span><span>
</span><span id="line-710"></span><span>            </span><span id="local-6989586621681616577"><span class="annot"><span class="annottext">telList :: [Dom ([Char], Type)]
</span><a href="#local-6989586621681616577"><span class="hs-identifier hs-var hs-var">telList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [Dom ([Char], Type)]
forall t. Tele (Dom t) -&gt; [Dom ([Char], t)]
</span><a href="Agda.Syntax.Internal.html#telToList"><span class="hs-identifier hs-var">telToList</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616526"><span class="hs-identifier hs-var">tel</span></a></span><span>
</span><span id="line-711"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621681616578"><span class="annot"><span class="annottext">[Dom ([Char], Type)]
</span><a href="#local-6989586621681616578"><span class="hs-identifier hs-var">ptelList</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621681616579"><span class="annot"><span class="annottext">Dom ([Char], Type)
</span><a href="#local-6989586621681616579"><span class="hs-identifier hs-var">rt</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Nat
-&gt; [Dom ([Char], Type)]
-&gt; ([Dom ([Char], Type)], [Dom ([Char], Type)])
forall a. Nat -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616526"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dom ([Char], Type)]
</span><a href="#local-6989586621681616577"><span class="hs-identifier hs-var">telList</span></a></span><span>
</span><span id="line-712"></span><span>            </span><span id="local-6989586621681616580"><span class="annot"><span class="annottext">ptel :: Telescope
</span><a href="#local-6989586621681616580"><span class="hs-identifier hs-var hs-var">ptel</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dom ([Char], Type)] -&gt; Telescope
</span><a href="Agda.Syntax.Internal.html#telFromList"><span class="hs-identifier hs-var">telFromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Dom ([Char], Type)]
</span><a href="#local-6989586621681616578"><span class="hs-identifier hs-var">ptelList</span></a></span><span>
</span><span id="line-713"></span><span>            </span><span id="local-6989586621681616582"><span class="annot"><span class="annottext">cpo :: PatOrigin
</span><a href="#local-6989586621681616582"><span class="hs-identifier hs-var hs-var">cpo</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681616524"><span class="hs-identifier hs-var">hasNamedCon</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PatOrigin
</span><a href="Agda.Syntax.Internal.html#PatOCon"><span class="hs-identifier hs-var">PatOCon</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PatOrigin
</span><a href="Agda.Syntax.Internal.html#PatORec"><span class="hs-identifier hs-var">PatORec</span></a></span><span>
</span><span id="line-714"></span><span>            </span><span id="local-6989586621681616585"><span class="annot"><span class="annottext">cpi :: ConPatternInfo
</span><a href="#local-6989586621681616585"><span class="hs-identifier hs-var hs-var">cpi</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#ConPatternInfo"><span class="hs-identifier hs-type">ConPatternInfo</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">conPInfo :: PatternInfo
</span><a href="Agda.Syntax.Internal.html#conPInfo"><span class="hs-identifier hs-var">conPInfo</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatOrigin -&gt; [Name] -&gt; PatternInfo
</span><a href="Agda.Syntax.Internal.html#PatternInfo"><span class="hs-identifier hs-var">PatternInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PatOrigin
</span><a href="#local-6989586621681616582"><span class="hs-identifier hs-var">cpo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-715"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPRecord :: Bool
</span><a href="Agda.Syntax.Internal.html#conPRecord"><span class="hs-identifier hs-var">conPRecord</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-716"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPFallThrough :: Bool
</span><a href="Agda.Syntax.Internal.html#conPFallThrough"><span class="hs-identifier hs-var">conPFallThrough</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-717"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPType :: Maybe (Arg Type)
</span><a href="Agda.Syntax.Internal.html#conPType"><span class="hs-identifier hs-var">conPType</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Maybe (Arg Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Arg Type -&gt; Maybe (Arg Type)) -&gt; Arg Type -&gt; Maybe (Arg Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dom Type -&gt; Arg Type
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom Type -&gt; Arg Type) -&gt; Dom Type -&gt; Arg Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(([Char], Type) -&gt; Type) -&gt; Dom ([Char], Type) -&gt; Dom Type
forall a b. (a -&gt; b) -&gt; Dom' Term a -&gt; Dom' Term b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([Char], Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Dom ([Char], Type)
</span><a href="#local-6989586621681616579"><span class="hs-identifier hs-var">rt</span></a></span><span>
</span><span id="line-718"></span><span>                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conPLazy :: Bool
</span><a href="Agda.Syntax.Internal.html#conPLazy"><span class="hs-identifier hs-var">conPLazy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-719"></span><span>            </span><span id="local-6989586621681616592"><span class="annot"><span class="annottext">conp :: NamedArg (Pattern' DBPatVar)
</span><a href="#local-6989586621681616592"><span class="hs-identifier hs-var hs-var">conp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar)
forall a. a -&gt; NamedArg a
</span><a href="Agda.Syntax.Common.html#defaultNamedArg"><span class="hs-identifier hs-var">defaultNamedArg</span></a></span><span> </span><span class="annot"><span class="annottext">(Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar))
-&gt; Pattern' DBPatVar -&gt; NamedArg (Pattern' DBPatVar)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConHead
-&gt; ConPatternInfo
-&gt; [NamedArg (Pattern' DBPatVar)]
-&gt; Pattern' DBPatVar
forall x.
ConHead -&gt; ConPatternInfo -&gt; [NamedArg (Pattern' x)] -&gt; Pattern' x
</span><a href="Agda.Syntax.Internal.html#ConP"><span class="hs-identifier hs-var">ConP</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621681616525"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">ConPatternInfo
</span><a href="#local-6989586621681616585"><span class="hs-identifier hs-var">cpi</span></a></span><span> </span><span class="annot"><span class="annottext">([NamedArg (Pattern' DBPatVar)] -&gt; Pattern' DBPatVar)
-&gt; [NamedArg (Pattern' DBPatVar)] -&gt; Pattern' DBPatVar
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; [NamedArg (Pattern' DBPatVar)]
forall a t. DeBruijn a =&gt; Tele (Dom t) -&gt; [NamedArg a]
</span><a href="Agda.TypeChecking.Telescope.html#teleNamedArgs"><span class="hs-identifier hs-var">teleNamedArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616527"><span class="hs-identifier hs-var">ftel</span></a></span><span>
</span><span id="line-720"></span><span>            </span><span id="local-6989586621681616593"><span class="annot"><span class="annottext">body :: Maybe Term
</span><a href="#local-6989586621681616593"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Term -&gt; Maybe Term
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Maybe Term) -&gt; Term -&gt; Maybe Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Term -&gt; Term
</span><a href="#local-6989586621681616574"><span class="hs-identifier hs-var">bodyMod</span></a></span><span> </span><span class="annot"><span class="annottext">(Term -&gt; Term) -&gt; Term -&gt; Term
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Term
</span><a href="Agda.Syntax.Internal.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Abs Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621681616545"><span class="hs-identifier hs-var">ftel2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>            </span><span id="local-6989586621681616595"><span class="annot"><span class="annottext">cltel :: Telescope
</span><a href="#local-6989586621681616595"><span class="hs-identifier hs-var hs-var">cltel</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616580"><span class="hs-identifier hs-var">ptel</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; Telescope
forall t. Abstract t =&gt; Telescope -&gt; t -&gt; t
</span><a href="Agda.TypeChecking.Substitute.Class.html#abstract"><span class="hs-operator hs-var">`abstract`</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616527"><span class="hs-identifier hs-var">ftel</span></a></span><span>
</span><span id="line-722"></span><span>            </span><span id="local-6989586621681616596"><span class="annot"><span class="annottext">cltype :: Maybe (Arg Type)
</span><a href="#local-6989586621681616596"><span class="hs-identifier hs-var hs-var">cltype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Arg Type -&gt; Maybe (Arg Type)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Arg Type -&gt; Maybe (Arg Type)) -&gt; Arg Type -&gt; Maybe (Arg Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Type -&gt; Arg Type
forall e. ArgInfo -&gt; e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#Arg"><span class="hs-identifier hs-var">Arg</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Arg Type) -&gt; Type -&gt; Arg Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Type -&gt; Type
forall a. Subst a =&gt; Nat -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Nat
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Abs Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Abs Telescope
</span><a href="#local-6989586621681616545"><span class="hs-identifier hs-var">ftel2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616544"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-723"></span><span>            </span><span id="local-6989586621681616598"><span class="annot"><span class="annottext">clause :: Clause
</span><a href="#local-6989586621681616598"><span class="hs-identifier hs-var hs-var">clause</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">clauseLHSRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseLHSRange"><span class="hs-identifier hs-var">clauseLHSRange</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616547"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-724"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseFullRange :: Range
</span><a href="Agda.Syntax.Internal.html#clauseFullRange"><span class="hs-identifier hs-var">clauseFullRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; Range
forall a. HasRange a =&gt; a -&gt; Range
</span><a href="Agda.Syntax.Position.html#getRange"><span class="hs-identifier hs-var">getRange</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616547"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-725"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseTel :: Telescope
</span><a href="Agda.Syntax.Internal.html#clauseTel"><span class="hs-identifier hs-var">clauseTel</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616595"><span class="hs-identifier hs-var">cltel</span></a></span><span>
</span><span id="line-726"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">namedClausePats :: [NamedArg (Pattern' DBPatVar)]
</span><a href="Agda.Syntax.Internal.html#namedClausePats"><span class="hs-identifier hs-var">namedClausePats</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NamedArg (Pattern' DBPatVar)
</span><a href="#local-6989586621681616592"><span class="hs-identifier hs-var">conp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-727"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseBody :: Maybe Term
</span><a href="Agda.Syntax.Internal.html#clauseBody"><span class="hs-identifier hs-var">clauseBody</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Term
</span><a href="#local-6989586621681616593"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-728"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseType :: Maybe (Arg Type)
</span><a href="Agda.Syntax.Internal.html#clauseType"><span class="hs-identifier hs-var">clauseType</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Arg Type)
</span><a href="#local-6989586621681616596"><span class="hs-identifier hs-var">cltype</span></a></span><span>
</span><span id="line-729"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseCatchall :: Bool
</span><a href="Agda.Syntax.Internal.html#clauseCatchall"><span class="hs-identifier hs-var">clauseCatchall</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-730"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseExact :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseExact"><span class="hs-identifier hs-var">clauseExact</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-731"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseRecursive :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseRecursive"><span class="hs-identifier hs-var">clauseRecursive</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-732"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseUnreachable :: Maybe Bool
</span><a href="Agda.Syntax.Internal.html#clauseUnreachable"><span class="hs-identifier hs-var">clauseUnreachable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-733"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseEllipsis :: ExpandedEllipsis
</span><a href="Agda.Syntax.Internal.html#clauseEllipsis"><span class="hs-identifier hs-var">clauseEllipsis</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExpandedEllipsis
</span><a href="Agda.Syntax.Common.html#NoEllipsis"><span class="hs-identifier hs-var">NoEllipsis</span></a></span><span>
</span><span id="line-734"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">clauseWhereModule :: Maybe ModuleName
</span><a href="Agda.Syntax.Internal.html#clauseWhereModule"><span class="hs-identifier hs-var">clauseWhereModule</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-735"></span><span>                            </span><span class="hs-special">}</span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681616599"><span class="annot"><span class="annottext">projection :: Projection
</span><a href="#local-6989586621681616599"><span class="hs-identifier hs-var hs-var">projection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span>
</span><span id="line-738"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projProper :: Maybe QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projProper"><span class="hs-identifier hs-var">projProper</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616523"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-739"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projOrig :: QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projOrig"><span class="hs-identifier hs-var">projOrig</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span>
</span><span id="line-740"></span><span>              </span><span class="hs-comment">-- name of the record type:</span><span>
</span><span id="line-741"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projFromType :: Arg QName
</span><a href="Agda.TypeChecking.Monad.Base.html#projFromType"><span class="hs-identifier hs-var">projFromType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Arg QName
forall e. e -&gt; Arg e
</span><a href="Agda.Syntax.Common.html#defaultArg"><span class="hs-identifier hs-var">defaultArg</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616523"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-742"></span><span>              </span><span class="hs-comment">-- index of the record argument (in the type),</span><span>
</span><span id="line-743"></span><span>              </span><span class="hs-comment">-- start counting with 1:</span><span>
</span><span id="line-744"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projIndex :: Nat
</span><a href="Agda.TypeChecking.Monad.Base.html#projIndex"><span class="hs-identifier hs-var">projIndex</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616526"><span class="hs-identifier hs-var">tel</span></a></span><span> </span><span class="hs-comment">-- which is @size ptel + 1@</span><span>
</span><span id="line-745"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">projLams :: ProjLams
</span><a href="Agda.TypeChecking.Monad.Base.html#projLams"><span class="hs-identifier hs-var">projLams</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Arg [Char]] -&gt; ProjLams
</span><a href="Agda.TypeChecking.Monad.Base.html#ProjLams"><span class="hs-identifier hs-var">ProjLams</span></a></span><span> </span><span class="annot"><span class="annottext">([Arg [Char]] -&gt; ProjLams) -&gt; [Arg [Char]] -&gt; ProjLams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Dom ([Char], Type) -&gt; Arg [Char])
-&gt; [Dom ([Char], Type)] -&gt; [Arg [Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dom' Term [Char] -&gt; Arg [Char]
forall t a. Dom' t a -&gt; Arg a
</span><a href="Agda.Syntax.Internal.html#argFromDom"><span class="hs-identifier hs-var">argFromDom</span></a></span><span> </span><span class="annot"><span class="annottext">(Dom' Term [Char] -&gt; Arg [Char])
-&gt; (Dom ([Char], Type) -&gt; Dom' Term [Char])
-&gt; Dom ([Char], Type)
-&gt; Arg [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(([Char], Type) -&gt; [Char])
-&gt; Dom ([Char], Type) -&gt; Dom' Term [Char]
forall a b. (a -&gt; b) -&gt; Dom' Term a -&gt; Dom' Term b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">([Char], Type) -&gt; [Char]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dom ([Char], Type)]
</span><a href="#local-6989586621681616577"><span class="hs-identifier hs-var">telList</span></a></span><span>
</span><span id="line-746"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">70</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-749"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;adding projection&quot;</span></span><span>
</span><span id="line-750"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Clause -&gt; TCMT IO Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616598"><span class="hs-identifier hs-var">clause</span></a></span><span>
</span><span id="line-751"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-752"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.rec.proj&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span>
</span><span id="line-753"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;adding projection&quot;</span></span><span>
</span><span id="line-754"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QNamed Clause -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QNamed Clause -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Clause -&gt; QNamed Clause
forall a. QName -&gt; a -&gt; QNamed a
</span><a href="Agda.Syntax.Abstract.Name.html#QNamed"><span class="hs-identifier hs-var">QNamed</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span> </span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616598"><span class="hs-identifier hs-var">clause</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-755"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span>              </span><span class="hs-comment">-- Record patterns should /not/ be translated when the</span><span>
</span><span id="line-758"></span><span>              </span><span class="hs-comment">-- projection functions are defined. Record pattern</span><span>
</span><span id="line-759"></span><span>              </span><span class="hs-comment">-- translation is defined in terms of projection</span><span>
</span><span id="line-760"></span><span>              </span><span class="hs-comment">-- functions.</span><span>
</span><span id="line-761"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681616609"><span class="annot"><span class="annottext">Maybe SplitTree
</span><a href="#local-6989586621681616609"><span class="hs-identifier hs-var">mst</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681616610"><span class="annot"><span class="annottext">CompiledClauses
</span><a href="#local-6989586621681616610"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Type)
-&gt; [Clause] -&gt; TCMT IO (Maybe SplitTree, Bool, CompiledClauses)
</span><a href="Agda.TypeChecking.CompiledClause.Compile.html#compileClauses"><span class="hs-identifier hs-var">compileClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (QName, Type)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Clause
</span><a href="#local-6989586621681616598"><span class="hs-identifier hs-var">clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
[Char] -&gt; Nat -&gt; TCMT IO Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tc.cc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">60</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCM ()) -&gt; TCMT IO Doc -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-764"></span><span>          </span><span class="annot"><span class="annottext">[TCMT IO Doc] -&gt; TCMT IO Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#sep"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc
</span><span class="hs-string">&quot;compiled clauses of &quot;</span></span><span> </span><span class="annot"><span class="annottext">TCMT IO Doc -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
forall (m :: * -&gt; *). MonadPretty m =&gt; QName -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span>
</span><span id="line-765"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Functor m =&gt; Nat -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCMT IO Doc -&gt; TCMT IO Doc) -&gt; TCMT IO Doc -&gt; TCMT IO Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TCMT IO Doc
forall (m :: * -&gt; *). Applicative m =&gt; [Char] -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompiledClauses -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">CompiledClauses
</span><a href="#local-6989586621681616610"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-767"></span><span>
</span><span id="line-768"></span><span>        </span><span class="annot"><span class="annottext">Impossible -&gt; Nat -&gt; TCM () -&gt; TCM ()
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Impossible -&gt; Nat -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#escapeContext"><span class="hs-identifier hs-var">escapeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Impossible
HasCallStack =&gt; Impossible
</span><a href="Agda.Utils.Impossible.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Telescope -&gt; Nat
forall a. Sized a =&gt; a -&gt; Nat
</span><a href="Agda.Utils.Size.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616526"><span class="hs-identifier hs-var">tel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; TCM ()) -&gt; TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-769"></span><span>          </span><span id="local-6989586621681616611"><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621681616611"><span class="hs-identifier hs-var">lang</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Language
forall (m :: * -&gt; *). HasOptions m =&gt; m Language
</span><a href="Agda.TypeChecking.Monad.Options.html#getLanguage"><span class="hs-identifier hs-var">getLanguage</span></a></span><span>
</span><span id="line-770"></span><span>          </span><span id="local-6989586621681616613"><span class="annot"><span class="annottext">FunctionData
</span><a href="#local-6989586621681616613"><span class="hs-identifier hs-var">fun</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO FunctionData
forall (m :: * -&gt; *). HasOptions m =&gt; m FunctionData
</span><a href="Agda.TypeChecking.Monad.Base.html#emptyFunctionData"><span class="hs-identifier hs-var">emptyFunctionData</span></a></span><span>
</span><span id="line-771"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- It should be fine to mark a field with @&#969; in an</span><span>
</span><span id="line-772"></span><span>              </span><span class="hs-comment">-- erased record type: the field will be non-erased, but</span><span>
</span><span id="line-773"></span><span>              </span><span class="hs-comment">-- the projection will be erased. The following code</span><span>
</span><span id="line-774"></span><span>              </span><span class="hs-comment">-- ensures that the use of addConstant does not trigger</span><span>
</span><span id="line-775"></span><span>              </span><span class="hs-comment">-- a PlentyInHardCompileTimeMode warning.</span><span>
</span><span id="line-776"></span><span>              </span><span id="local-6989586621681616615"><span class="annot"><span class="annottext">ai' :: ArgInfo
</span><a href="#local-6989586621681616615"><span class="hs-identifier hs-var hs-var">ai'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Quantity -&gt; Quantity) -&gt; ArgInfo -&gt; ArgInfo)
-&gt; ArgInfo -&gt; (Quantity -&gt; Quantity) -&gt; ArgInfo
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Quantity -&gt; Quantity) -&gt; ArgInfo -&gt; ArgInfo
forall a. LensQuantity a =&gt; (Quantity -&gt; Quantity) -&gt; a -&gt; a
</span><a href="Agda.Syntax.Common.html#mapQuantity"><span class="hs-identifier hs-var">mapQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616543"><span class="hs-identifier hs-var">ai</span></a></span><span> </span><span class="annot"><span class="annottext">((Quantity -&gt; Quantity) -&gt; ArgInfo)
-&gt; (Quantity -&gt; Quantity) -&gt; ArgInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-777"></span><span>                      </span><span class="annot"><a href="Agda.Syntax.Common.html#Quantity%3C9"><span class="hs-identifier hs-type">Quantity&#969;</span></a></span><span> </span><span class="annot"><span class="annottext">Q&#969;Origin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q&#969;Origin -&gt; Quantity
</span><a href="Agda.Syntax.Common.html#Quantity%3C9"><span class="hs-identifier hs-var">Quantity&#969;</span></a></span><span> </span><span class="annot"><span class="annottext">Q&#969;Origin
</span><a href="Agda.Syntax.Common.html#Q%3C9Inferred"><span class="hs-identifier hs-var">Q&#969;Inferred</span></a></span><span>
</span><span id="line-778"></span><span>                      </span><span id="local-6989586621681616620"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681616620"><span class="hs-identifier hs-var">q</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621681616620"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-779"></span><span>          </span><span class="annot"><span class="annottext">QName -&gt; Definition -&gt; TCM ()
</span><a href="Agda.TypeChecking.Monad.Signature.html#addConstant"><span class="hs-identifier hs-var">addConstant</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; TCM ()) -&gt; Definition -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-780"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArgInfo -&gt; QName -&gt; Type -&gt; Language -&gt; Defn -&gt; Definition
</span><a href="Agda.TypeChecking.Monad.Base.html#defaultDefn"><span class="hs-identifier hs-var">defaultDefn</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621681616615"><span class="hs-identifier hs-var">ai'</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
forall a. KillRange a =&gt; KillRangeT a
</span><a href="Agda.Syntax.Position.html#killRange"><span class="hs-identifier hs-var">killRange</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616564"><span class="hs-identifier hs-var">finalt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621681616611"><span class="hs-identifier hs-var">lang</span></a></span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; Definition) -&gt; Defn -&gt; Definition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FunctionData -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#FunctionDefn"><span class="hs-identifier hs-var">FunctionDefn</span></a></span><span>
</span><span id="line-781"></span><span>              </span><span class="annot"><span class="annottext">FunctionData
</span><a href="#local-6989586621681616613"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-782"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funClauses"><span class="hs-identifier hs-var">_funClauses</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681616598"><span class="hs-identifier hs-type">clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-783"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funCompiled"><span class="hs-identifier hs-var">_funCompiled</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621681616610"><span class="hs-identifier hs-type">cc</span></a></span><span>
</span><span id="line-784"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funSplitTree"><span class="hs-identifier hs-var">_funSplitTree</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621681616609"><span class="hs-identifier hs-type">mst</span></a></span><span>
</span><span id="line-785"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funProjection"><span class="hs-identifier hs-var">_funProjection</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621681616599"><span class="hs-identifier hs-type">projection</span></a></span><span>
</span><span id="line-786"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funMutual"><span class="hs-identifier hs-var">_funMutual</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Projections are not mutually recursive with anything</span><span>
</span><span id="line-787"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#_funTerminates"><span class="hs-identifier hs-var">_funTerminates</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-788"></span><span>                </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-789"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defArgOccurrences"><span class="hs-identifier hs-var">defArgOccurrences</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Positivity.Occurrence.html#StrictPos"><span class="hs-identifier hs-type">StrictPos</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-790"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#defCopatternLHS"><span class="hs-identifier hs-var">defCopatternLHS</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.TypeChecking.CompiledClause.html#hasProjectionPatterns"><span class="hs-identifier hs-type">hasProjectionPatterns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681616610"><span class="hs-identifier hs-type">cc</span></a></span><span>
</span><span id="line-791"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-792"></span><span>          </span><span class="annot"><span class="annottext">[QName] -&gt; TCM ()
forall (m :: * -&gt; *).
(HasOptions m, HasConstInfo m, HasBuiltins m, MonadTCEnv m,
 MonadTCState m, MonadReduce m, MonadAddContext m, MonadTCError m,
 MonadDebug m, MonadPretty m) =&gt;
[QName] -&gt; m ()
</span><a href="Agda.TypeChecking.Polarity.html#computePolarity"><span class="hs-identifier hs-var">computePolarity</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span>        </span><span class="annot"><span class="annottext">Telescope -&gt; TCM () -&gt; TCM ()
forall b (m :: * -&gt; *) a.
(AddContext b, MonadAddContext m) =&gt;
b -&gt; m a -&gt; m a
forall (m :: * -&gt; *) a.
MonadAddContext m =&gt;
Telescope -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Context.html#addContext"><span class="hs-identifier hs-var">addContext</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616538"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DefInfo -&gt; IsInstance
forall t. DefInfo' t -&gt; IsInstance
</span><a href="Agda.Syntax.Info.html#defInstance"><span class="hs-identifier hs-var">Info.defInstance</span></a></span><span> </span><span class="annot"><span class="annottext">DefInfo
</span><a href="#local-6989586621681616547"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-795"></span><span>          </span><span class="hs-comment">-- Instance projections have to be added with their types &quot;qua</span><span>
</span><span id="line-796"></span><span>          </span><span class="hs-comment">-- local variable&quot; (i.e. the type you'd get were you to open</span><span>
</span><span id="line-797"></span><span>          </span><span class="hs-comment">-- the record module), but this type has to be treated in the</span><span>
</span><span id="line-798"></span><span>          </span><span class="hs-comment">-- context ftel1 otherwise it's nonsense</span><span>
</span><span id="line-799"></span><span>          </span><span class="annot"><a href="Agda.Syntax.Common.html#InstanceDef"><span class="hs-identifier hs-type">InstanceDef</span></a></span><span> </span><span id="local-6989586621681616634"><span class="annot"><span class="annottext">KwRange
</span><a href="#local-6989586621681616634"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Type -&gt; TCM ()
</span><a href="Agda.TypeChecking.InstanceArguments.html#addTypedInstance"><span class="hs-identifier hs-var">addTypedInstance</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621681616567"><span class="hs-identifier hs-var">projname</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621681616544"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-800"></span><span>          </span><span class="annot"><span class="annottext">IsInstance
</span><a href="Agda.Syntax.Common.html#NotInstanceDef"><span class="hs-identifier hs-var">NotInstanceDef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; TCM ()
forall a. a -&gt; TCMT IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span>        </span><span class="annot"><span class="annottext">TCM ()
</span><a href="#local-6989586621681616571"><span class="hs-identifier hs-var">recurse</span></a></span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span>    </span><span class="hs-comment">-- Case: definition.</span><span>
</span><span id="line-805"></span><span>    </span><span class="annot"><a href="#local-6989586621681616529"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span id="local-6989586621681616635"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616635"><span class="hs-identifier hs-var">ftel1</span></a></span></span><span> </span><span id="local-6989586621681616636"><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616636"><span class="hs-identifier hs-var">ftel2</span></a></span></span><span> </span><span id="local-6989586621681616637"><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616637"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681616638"><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621681616638"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621681616639"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616639"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-806"></span><span>      </span><span class="annot"><span class="annottext">Field -&gt; TCM ()
</span><a href="Agda.TypeChecking.Rules.Decl.html#checkDecl"><span class="hs-identifier hs-var">checkDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621681616638"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-807"></span><span>      </span><span class="annot"><span class="annottext">Telescope -&gt; Telescope -&gt; [Term] -&gt; [Field] -&gt; TCM ()
</span><a href="#local-6989586621681616529"><span class="hs-identifier hs-var">checkProjs</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616635"><span class="hs-identifier hs-var">ftel1</span></a></span><span> </span><span class="annot"><span class="annottext">Telescope
</span><a href="#local-6989586621681616636"><span class="hs-identifier hs-var">ftel2</span></a></span><span> </span><span class="annot"><span class="annottext">[Term]
</span><a href="#local-6989586621681616637"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621681616639"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-808"></span></pre></body></html>